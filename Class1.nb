(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    307417,       8607]
NotebookOptionsPosition[    292070,       8389]
NotebookOutlinePosition[    292504,       8406]
CellTagsIndexPosition[    292461,       8403]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
In this file, we provide the details of YM and GR computation for soft limit \
of Mellin-Momentum amplitude

Convenition: 
k[s] is the soft momentum s[s] and s[soft] are the soft mellin variable. 
k[h] is the hard momentum and s[h] and s[hard] are the hard mellin variable.
ks[s,h] and   ksh are the momentum in the propagator.
Capital A is the YM amplitude and Capital M is the GR amplitude\
\>", "Text",
 CellChangeTimes->{{3.928053016206361*^9, 3.9280531826777096`*^9}, 
   3.9280571355624933`*^9, 3.930225973894405*^9, {3.9302283973133154`*^9, 
   3.9302284128514404`*^9}, {3.930228478814495*^9, 3.9302284921703453`*^9}, {
   3.9302285241699905`*^9, 3.930228576432085*^9}, 3.9302287878202705`*^9, {
   3.9302359073000765`*^9, 
   3.9302359091985226`*^9}},ExpressionUUID->"1bce962c-1a6d-4704-9c89-\
9b87b07f819e"],

Cell[CellGroupData[{

Cell["SetUp (just run)", "Chapter",
 CellChangeTimes->{{3.9090377425018826`*^9, 3.909037745703765*^9}, {
  3.930226042853797*^9, 
  3.930226046797617*^9}},ExpressionUUID->"850048d3-ce84-4e35-91fa-\
b4b9021efad7"],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.8064425428182154`*^9, 
  3.8064425447462206`*^9}},ExpressionUUID->"6b0e9a96-1fb0-4668-9e15-\
a3d7d7ec8d64"],

Cell[CellGroupData[{

Cell["derivatives and contractions", "Subsection",
 CellChangeTimes->{{3.76751846412012*^9, 3.7675184702456675`*^9}, {
  3.767519123524742*^9, 
  3.767519126221491*^9}},ExpressionUUID->"3f2c54dd-aa65-46a6-9c60-\
4b65231d0484"],

Cell[BoxData[
 RowBox[{"Clear", "@", "contract"}]], "Input",
 CellChangeTimes->{{3.9278296610890427`*^9, 3.9278296657546077`*^9}},
 CellLabel->
  "In[571]:=",ExpressionUUID->"5864dca5-d9f9-4862-96a6-1fe33efa16bb"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"the", " ", "notation", " ", 
     RowBox[{"is", ":", " ", 
      RowBox[{"sc", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}], "=", 
    RowBox[{"a", "\[CenterDot]", "b"}]}], ",", " ", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{"a", ",", 
      RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], "=", 
    SubscriptBox["a", "\[Mu]i"]}], ",", " ", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"\[Mu]", "[", "i", "]"}], ",", 
      RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "=", 
    SubscriptBox["\[Delta]", "\[Mu]i\[Mu]j"]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.7675184748714037`*^9, 3.767518550062851*^9}},
 CellLabel->
  "In[572]:=",ExpressionUUID->"ffa412a7-5344-4670-984b-43d6f5683f34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "@", "sc"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";", 
  RowBox[{
   RowBox[{"Attributes", "@", "Ht"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";", 
  RowBox[{
   RowBox[{"Attributes", "@", "ks"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sortEp", "=", 
    RowBox[{"{", 
     RowBox[{"i_Ep", "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Signature", "[", "i", "]"}], 
       RowBox[{"Sort", "[", "i", "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"derivative", " ", 
    RowBox[{"d", "/", 
     SubscriptBox["dvar", "\[Mu]i"]}], " ", "or", " ", 
    RowBox[{"a", "\[CenterDot]", 
     RowBox[{"d", "/", "dvar"}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"diff", "[", 
    RowBox[{"indexordota_", ",", "var_"}], "]"}], "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"expr", ",", "var"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["sc", 
         TagBox[
          RowBox[{"(", "i___", ")"}],
          Derivative],
         MultilineFunction->None], "[", "j___", "]"}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"sc", "[", "j", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", "1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Rule]", 
         "indexordota"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Ep", 
         TagBox[
          RowBox[{"(", "i___", ")"}],
          Derivative],
         MultilineFunction->None], "[", "j___", "]"}], ")"}], 
      "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{
          RowBox[{"Ep", "[", "j", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", "1"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Rule]", 
           "indexordota"}]}], "]"}], "/.", "sortEp"}], ")"}]}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diffcr", "[", 
    RowBox[{"indexordota_", ",", "var_", ",", "mvar_"}], "]"}], "[", "expr_", 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"expr", ",", "var"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["sc", 
           TagBox[
            RowBox[{"(", "i___", ")"}],
            Derivative],
           MultilineFunction->None], "[", "j___", "]"}], ")"}], 
        "\[RuleDelayed]", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{
          RowBox[{"sc", "[", "j", "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", "1"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Rule]", 
           "indexordota"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Ep", 
           TagBox[
            RowBox[{"(", "i___", ")"}],
            Derivative],
           MultilineFunction->None], "[", "j___", "]"}], ")"}], 
        "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{
            RowBox[{"Ep", "[", "j", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"{", "i", "}"}], ",", "1"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Rule]", 
             "indexordota"}]}], "]"}], "/.", "sortEp"}], ")"}]}]}], "}"}]}], 
    ")"}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"sc", "[", 
      RowBox[{"var", ",", "indexordota"}], "]"}], "mvar"], 
    RowBox[{"D", "[", 
     RowBox[{"expr", ",", "mvar"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gram", "[", 
    RowBox[{"lis1_", ",", "lis2_"}], "]"}], ":=", 
   RowBox[{"Det", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"i1", ",", "j1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i1", ",", "lis1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j1", ",", "lis2"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"contract", " ", "index"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contractrule", "[", "dim_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], " ", "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"y_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}], "^", "2"}], 
      "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "dim"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "j_", "]"}]}], " ", "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"y_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "j_", "]"}]}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "j_", "]"}]}], " ", "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"y_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", "y_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{"z_", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}]}], ":>", " ", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}]}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{"y_", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}]}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}]}], "]"}], "^", "2"}], 
      "\[RuleDelayed]", 
      RowBox[{"sc", "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Nu]", "[", "i_", "]"}], ",", 
        RowBox[{"\[Nu]", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "dim"}],
      ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Ep", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", "y___"}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", "z_"}], "]"}]}], 
      "\[RuleDelayed]", 
      RowBox[{"Ep", "[", 
       RowBox[{"x", ",", "z", ",", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Ep", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}], ",", "y___"}], "]"}], 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"\[Nu]", "[", "i_", "]"}], ",", "z_"}], "]"}]}], 
      "\[RuleDelayed]", 
      RowBox[{"Ep", "[", 
       RowBox[{"x", ",", "z", ",", "y"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Ep", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", "y___"}], "]"}], 
       RowBox[{"Ep", "[", 
        RowBox[{"z___", ",", 
         RowBox[{"\[Mu]", "[", "i_", "]"}], ",", "k___"}], "]"}]}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"Length", "@", 
           RowBox[{"{", "x", "}"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"Length", "@", 
          RowBox[{"{", "z", "}"}]}], ")"}]}], 
       RowBox[{"gram", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "k"}], "}"}]}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Ep", "[", 
        RowBox[{"x___", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}], ",", "y___"}], "]"}], 
       RowBox[{"Ep", "[", 
        RowBox[{"z___", ",", 
         RowBox[{"\[Nu]", "[", "i_", "]"}], ",", "k___"}], "]"}]}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"Length", "@", 
           RowBox[{"{", "x", "}"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"Length", "@", 
          RowBox[{"{", "z", "}"}]}], ")"}]}], 
       RowBox[{"gram", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "k"}], "}"}]}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Ep", "[", 
       RowBox[{"i_", ",", "_", ",", "i_"}], "]"}], "\[RuleDelayed]", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"Ep", "[", 
       RowBox[{"i_", ",", "i_", ",", "_"}], "]"}], "\[RuleDelayed]", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"Ep", "[", 
       RowBox[{"_", ",", "i_", ",", "i_"}], "]"}], "\[RuleDelayed]", "0"}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Ep", " ", "part", " ", "only", " ", "works", " ", "for", " ", "dim"}], 
      "=", "4"}], "*)"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contract", "[", 
    RowBox[{"expr_", ",", "dim_"}], "]"}], ":=", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Expand", "[", "#", "]"}], "//.", 
        RowBox[{"contractrule", "[", "dim", "]"}]}], ")"}], "&"}], ",", 
     "expr", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"simpEp", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Ep", "[", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], 
        RowBox[{"Ep", "[", 
         RowBox[{"k_", ",", "l_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
       RowBox[{"gram", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "l", ",", "m"}], "}"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Ep", "[", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "^", "2"}], 
       "\[RuleDelayed]", 
       RowBox[{"gram", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"this", " ", "only", " ", "works", " ", "for", " ", "dim"}], "=",
      "3"}], "*)"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"why", " ", 
    RowBox[{"3", "?"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "fanscinating", " ", "optimaized", " ", "code", " ", "from", " ", "Simon", 
    " ", "to", " ", "deal", " ", "with", " ", "contracting", " ", "two", " ", 
    "derivatives", " ", 
    RowBox[{
     RowBox[{"d", "/", "var1"}], "\[CenterDot]", 
     RowBox[{"d", "/", "var2"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"diff2", "[", 
      RowBox[{"var1_", ",", "var2_", ",", "dim_", ",", 
       RowBox[{"index_", ":", 
        RowBox[{"\[Mu]", "[", "whatever", "]"}]}]}], "]"}], "[", "expr_", 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"exprim", "=", 
        RowBox[{
         RowBox[{"diff", "[", 
          RowBox[{"index", ",", "var2"}], "]"}], "[", "expr", "]"}]}], "}"}], 
      ",", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"contract", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"diff", "[", 
              RowBox[{"index", ",", "var1"}], "]"}], "[", "withindex", "]"}], 
            ",", "dim"}], "]"}], 
          RowBox[{"Coefficient", "[", 
           RowBox[{"exprim", ",", "withindex"}], "]"}]}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"diff", "[", 
             RowBox[{"index", ",", "var1"}], "]"}], "[", 
            RowBox[{"Coefficient", "[", 
             RowBox[{"exprim", ",", "withindex"}], "]"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"i_sc", "/;", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"i", ",", "index"}], "]"}]}]}], "\[RuleDelayed]", 
            RowBox[{"contract", "[", 
             RowBox[{
              RowBox[{"i", " ", "withindex"}], ",", "dim"}], "]"}]}]}], 
          ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"withindex", ",", 
          RowBox[{"listwhat", "[", 
           RowBox[{"exprim", ",", 
            RowBox[{"i_sc", "/;", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"i", ",", "index"}], "]"}]}]}]}], "]"}]}], "}"}]}], 
       "]"}]}], "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diff2", "[", 
    RowBox[{"var1_", ",", "var2_", ",", "dim_", ",", 
     RowBox[{"index_", ":", 
      RowBox[{"\[Mu]", "[", "whatever", "]"}]}]}], "]"}], "[", "expr_", "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exprim", "=", 
      RowBox[{
       RowBox[{"diff", "[", 
        RowBox[{"index", ",", "var2"}], "]"}], "[", "expr", "]"}]}], "}"}], 
    ",", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"contract", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"diff", "[", 
            RowBox[{"index", ",", "var1"}], "]"}], "[", "withindex", "]"}], 
          ",", "dim"}], "]"}], 
        RowBox[{"Coefficient", "[", 
         RowBox[{"exprim", ",", "withindex"}], "]"}]}], "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"diff", "[", 
           RowBox[{"index", ",", "var1"}], "]"}], "[", 
          RowBox[{"Coefficient", "[", 
           RowBox[{"exprim", ",", "withindex"}], "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"i_sc", "/;", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"i", ",", "index"}], "]"}]}]}], "\[RuleDelayed]", 
            RowBox[{"contract", "[", 
             RowBox[{
              RowBox[{"i", " ", "withindex"}], ",", "dim"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"i_Ep", "/;", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"i", ",", "index"}], "]"}]}]}], "\[RuleDelayed]", 
            RowBox[{"contract", "[", 
             RowBox[{
              RowBox[{"i", " ", "withindex"}], ",", "dim"}], "]"}]}]}], 
          "}"}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"withindex", ",", 
        RowBox[{
         RowBox[{"listwhat", "[", 
          RowBox[{"exprim", ",", 
           RowBox[{"i_sc", "/;", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"i", ",", "index"}], "]"}]}]}]}], "]"}], "~", "Join", 
         "~", 
         RowBox[{"listwhat", "[", 
          RowBox[{"exprim", ",", 
           RowBox[{"i_Ep", "/;", 
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"i", ",", "index"}], "]"}]}]}]}], "]"}]}]}], "}"}]}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.767518556924008*^9, 3.7675185683453827`*^9}, {
   3.7675205991129756`*^9, 3.7675206070618887`*^9}, 3.767520761545313*^9, {
   3.767521367249151*^9, 3.7675213695356655`*^9}, {3.7675214978893433`*^9, 
   3.7675215466972017`*^9}, {3.76752158970475*^9, 3.767521770139882*^9}, {
   3.7675218026015005`*^9, 3.7675218046668377`*^9}, {3.7675219145232763`*^9, 
   3.7675219160311155`*^9}, {3.7675219690032825`*^9, 3.767521973560029*^9}, {
   3.7675282689747286`*^9, 3.7675282772752733`*^9}, {3.7675285676248055`*^9, 
   3.7675285688142204`*^9}, {3.7675290371808186`*^9, 
   3.7675290425544453`*^9}, {3.7675634022904778`*^9, 3.767563416852054*^9}, {
   3.769043849546838*^9, 3.7690438579282327`*^9}, {3.770244203600931*^9, 
   3.7702442175406404`*^9}, {3.7702445437970233`*^9, 3.770244582453597*^9}, 
   3.770244748033746*^9, {3.7702449270838614`*^9, 3.7702449317363806`*^9}, {
   3.770244980938799*^9, 3.770244991380848*^9}, {3.7702450326205697`*^9, 
   3.7702450495682583`*^9}, {3.7702451615616627`*^9, 3.770245165259818*^9}, {
   3.7724903090408*^9, 3.7724903095720224`*^9}, {3.7724914768505416`*^9, 
   3.77249153409016*^9}, {3.7724917533931684`*^9, 3.772491757345337*^9}, {
   3.773883455033391*^9, 3.7738834754388647`*^9}, {3.783206213228001*^9, 
   3.783206219215963*^9}, 3.7862321608818283`*^9, {3.7862331302703967`*^9, 
   3.786233130770372*^9}, {3.7880785049123526`*^9, 3.788078505131052*^9}, {
   3.790325454211709*^9, 3.790325455039502*^9}, {3.790752420062786*^9, 
   3.790752421984342*^9}, {3.790753670992031*^9, 3.7907536743660755`*^9}, {
   3.7931446234551554`*^9, 3.793144624033158*^9}, {3.8147797048889112`*^9, 
   3.814779712330363*^9}, {3.814779825048314*^9, 3.8147798319265213`*^9}, 
   3.814779976199803*^9, {3.8259072967049665`*^9, 3.8259073087269106`*^9}, 
   3.8287497911747055`*^9, {3.8290288127911224`*^9, 3.8290288143584957`*^9}, {
   3.829787232487622*^9, 3.8297872514563704`*^9}, {3.8482308937879877`*^9, 
   3.8482309005393867`*^9}, {3.8482309362147818`*^9, 3.848230949460332*^9}, {
   3.862306127113882*^9, 3.862306177321944*^9}, {3.8628526838007765`*^9, 
   3.8628526851545024`*^9}, {3.8628544756880584`*^9, 3.862854519448631*^9}, {
   3.862854615905598*^9, 3.8628546214333267`*^9}, {3.8629126355240393`*^9, 
   3.862912744654106*^9}, {3.863074347693452*^9, 3.863074347894659*^9}, {
   3.86437068062414*^9, 3.864370688399922*^9}, {3.864370862075238*^9, 
   3.864370866512465*^9}, {3.864370896685823*^9, 3.864370915573331*^9}, 
   3.864371055224194*^9, {3.8643712078524837`*^9, 3.8643712144002666`*^9}, {
   3.864371283333741*^9, 3.8643713482145042`*^9}, {3.8643747103727493`*^9, 
   3.864374730812961*^9}, {3.864374836930976*^9, 3.864374837080694*^9}, {
   3.9128489433568883`*^9, 3.912848955131884*^9}},
 CellLabel->
  "In[573]:=",ExpressionUUID->"1d4120f4-cde8-4694-a1e6-4d94cf71753f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"noeiei", "[", "lp_", "]"}], ":=", 
  RowBox[{"lp", "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}], 
    "]"}]}]}]], "Input",
 CellLabel->
  "In[582]:=",ExpressionUUID->"efaea690-c9de-4fed-8768-fef19337c7b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sToK", "[", 
   RowBox[{"pl_", ",", "del_"}], "]"}], ":=", 
  RowBox[{"pl", "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"s", "[", "x_", "]"}], "2"], "\[Rule]", 
      RowBox[{
       FractionBox["1", "16"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["d", "2"], "-", 
         RowBox[{"4", " ", "d", " ", "del"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["del", "2"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox[
           RowBox[{"k", "[", "x", "]"}], "2"], " ", 
          SuperscriptBox["z1", "2"]}]}], ")"}]}]}], "}"}], "]"}]}]}]], "Input",
 CellLabel->
  "In[583]:=",ExpressionUUID->"09461c7d-5649-4504-9d0a-e84b3adaf203"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Polarization sum", "Subsection",
 CellChangeTimes->{{3.9088671413971186`*^9, 
  3.9088671439140143`*^9}},ExpressionUUID->"81641fa0-280d-40ea-bbf8-\
421e905d9502"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"projection", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Pi]", "[", 
       RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "i", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "-", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["k", "2"]], 
        RowBox[{"(", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "L", "]"}], ",", 
           RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "R", "]"}], ",", 
           RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], ")"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Pi]2", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "e_", ",", "k_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"a", ",", "c", ",", "k"}], "]"}], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"b", ",", "e", ",", "k"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"a", ",", "e", ",", "k"}], "]"}], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"b", ",", "c", ",", "k"}], "]"}]}], "-", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"d", "-", "1"}]], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"a", ",", "b", ",", "k"}], "]"}], 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"c", ",", "e", ",", "k"}], "]"}]}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EoMOP", "[", 
     RowBox[{"k_", ",", "del_"}], "]"}], "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "2"], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"expr", ",", "z"}], "]"}], ",", "z"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "z", " ", 
        RowBox[{"D", "[", 
         RowBox[{"expr", ",", "z"}], "]"}]}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "^", "2"}], " ", 
        RowBox[{"k", "^", "2"}]}], "+", 
       RowBox[{
        RowBox[{"(", "del", ")"}], 
        RowBox[{"(", 
         RowBox[{"del", "-", "d"}], ")"}]}]}], ")"}], "expr"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fOP", "[", 
     RowBox[{"k_", ",", "del_"}], "]"}], "[", "expr_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "2"], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"expr", ",", "z"}], "]"}], ",", "z"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "d"}], ")"}], "z", " ", 
        RowBox[{"D", "[", 
         RowBox[{"expr", ",", "z"}], "]"}]}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", "del", ")"}], 
       RowBox[{"(", 
        RowBox[{"del", "-", "d"}], ")"}]}], ")"}], "expr"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"OPELimits", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"d", "-", "1"}], ",", "s12_"}], "]"}], ":>", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "d"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "d"}], ")"}], " ", "s12"}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["s12", "2"]}]}]}], ",", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"d", ",", "s12_"}], "]"}], ":>", 
     RowBox[{
      RowBox[{
       RowBox[{"+", "2"}], " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "s12"}], ")"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "s12"}], ")"}], "2"]}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Onshellc", "[", 
   RowBox[{"del_", ",", 
    RowBox[{"k", "[", "a_", "]"}], ",", "z_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"k", "[", "a", "]"}], "2"], ":>", 
    FractionBox[
     RowBox[{
      RowBox[{"4", 
       SuperscriptBox[
        RowBox[{"s", "[", "a", "]"}], "2"]}], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["d", "2"], "-", "del"}], ")"}], "2"]}], 
     SuperscriptBox["z", "2"]]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mellindelta", "[", 
   RowBox[{"n_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", 
        RowBox[{"s", "[", "i", "]"}]}], "-", 
       RowBox[{"d", "/", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "+", "d", "-", 
    "b"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mellindelta", "[", 
   RowBox[{"n_", ",", "b_", ",", "a_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"2", 
           RowBox[{"s", "[", "i", "]"}]}], "-", 
          RowBox[{"d", "/", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "+", "d", "-", 
       "b"}], "\[Equal]", "0"}], ",", "a"}], "]"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "i", "]"}], ",", 
           RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
       SuperscriptBox[
        RowBox[{"k", "[", "i", "]"}], "2"]}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ksq", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "i", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}]}]}]}], "}"}]}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AdS5pt", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ksq", "[", 
         RowBox[{"1", ",", "5"}], "]"}], ",", 
        RowBox[{"ksq", "[", 
         RowBox[{"2", ",", "5"}], "]"}], ",", 
        RowBox[{"ksq", "[", 
         RowBox[{"3", ",", "4"}], "]"}], ",", 
        RowBox[{"ksq", "[", 
         RowBox[{"3", ",", "5"}], "]"}], ",", 
        RowBox[{"ksq", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}]}], "]"}], "/.", 
    RowBox[{
     RowBox[{"ksq", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
     SuperscriptBox[
      RowBox[{"ks", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "2"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9088671908637342`*^9, 3.9088671942797785`*^9}, {
   3.9088673554431367`*^9, 3.9088673557104635`*^9}, 3.908867498240724*^9, 
   3.9088675344063826`*^9, {3.908973021708854*^9, 3.9089730464084225`*^9}, {
   3.910438229287901*^9, 3.9104382389841413`*^9}, {3.9104390655729113`*^9, 
   3.9104390698479176`*^9}, {3.9104395935901933`*^9, 3.9104396120094*^9}, {
   3.9105079721809187`*^9, 3.9105080002554884`*^9}, {3.9105080904023576`*^9, 
   3.9105081059226136`*^9}, 3.910508225995676*^9, {3.91050835730404*^9, 
   3.9105084137829103`*^9}, {3.910508503214944*^9, 3.910508571926526*^9}, {
   3.910508606712528*^9, 3.9105086876382837`*^9}, 3.910508726814303*^9, {
   3.910508807732024*^9, 3.9105088233229136`*^9}, {3.910509412371628*^9, 
   3.9105094191985817`*^9}, {3.9105095128965073`*^9, 
   3.9105095486134224`*^9}, {3.9105112339140034`*^9, 
   3.9105112562946634`*^9}, {3.9105113279354324`*^9, 
   3.9105113317181745`*^9}, {3.9105118748310595`*^9, 
   3.9105118773596416`*^9}, {3.9110282458851805`*^9, 
   3.9110282523347073`*^9}, {3.9110282838676376`*^9, 3.911028344234401*^9}, {
   3.9110283769742136`*^9, 3.9110284151796875`*^9}, {3.911463011996993*^9, 
   3.911463012533325*^9}},
 CellLabel->
  "In[584]:=",ExpressionUUID->"2062d7df-c65a-450b-af45-290cc4a7303c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "1", "]"}], ",", 
         RowBox[{"k", "[", "i", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "1", "]"}], ",", 
          RowBox[{"k", "[", "2", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ks", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "1", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "3", "]"}], ",", 
          RowBox[{"k", "[", "4", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ks", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "4", "]"}], ",", 
             RowBox[{"k", "[", "4", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "1", "]"}], ",", 
          RowBox[{"k", "[", "4", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kt", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "1", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "4", "]"}], ",", 
             RowBox[{"k", "[", "4", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "2", "]"}], ",", 
          RowBox[{"k", "[", "3", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"kt", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "3", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "1", "]"}], ",", 
          RowBox[{"k", "[", "3", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ku", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "1", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "2", "]"}], ",", 
          RowBox[{"k", "[", "4", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ku", "^", "2"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "2", "]"}]}], "]"}], "-", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "4", "]"}], ",", 
             RowBox[{"k", "[", "4", "]"}]}], "]"}]}], ")"}]}]}]}], "}"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "i_", "]"}], ",", 
       RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", 
     SuperscriptBox[
      RowBox[{"k", "[", "i", "]"}], "2"]}]}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"momconser4pt", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"%", "/.", 
         RowBox[{
          SuperscriptBox["ku", "2"], "->", "a"}]}], ")"}], "==", "0"}], ",", 
      "a"}], "]"}], "/.", 
    RowBox[{"a", "->", 
     SuperscriptBox["ku", "2"]}]}], "//", "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.9110326086311436`*^9, 3.9110326397171564`*^9}, {
  3.911032671792165*^9, 3.9110327524350595`*^9}},
 CellLabel->
  "In[593]:=",ExpressionUUID->"405273af-662c-4e26-b258-1098b466321e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["ku", "2"], "\[Rule]", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["ks", "2"]}], "-", 
    SuperscriptBox["kt", "2"], "+", 
    SuperscriptBox[
     RowBox[{"k", "[", "1", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"k", "[", "2", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"k", "[", "3", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"k", "[", "4", "]"}], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.911032626679288*^9, 3.9110326400020323`*^9}, {
   3.9110327196906357`*^9, 3.911032752713896*^9}, 3.9111158753598022`*^9, 
   3.912774884208253*^9, 3.912837078031054*^9, 3.913016838605894*^9, {
   3.91309479231768*^9, 3.9130948041199665`*^9}, 3.9131059706796803`*^9, 
   3.9131072503962207`*^9, 3.913236415639683*^9, 3.9133712069936123`*^9, 
   3.91338528751973*^9, 3.91346580357368*^9, 3.915040719738508*^9, 
   3.916513109986064*^9, 3.9174193746123753`*^9, 3.9187247601617775`*^9, 
   3.919182020600351*^9, 3.9193326679329543`*^9, 3.9199663254617677`*^9, 
   3.920048116992036*^9, 3.92203533255719*^9, 3.9266701309081063`*^9, 
   3.927829672354625*^9, 3.9278771686533585`*^9, 3.928057281616462*^9, 
   3.9280574031068954`*^9, {3.930226724122751*^9, 3.9302267309036226`*^9}},
 CellLabel->
  "Out[594]=",ExpressionUUID->"085498a4-22a2-4d35-9c4b-48b6677c651b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i", "]"}], ",", 
          RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ")"}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"a_", ",", "a_"}], "]"}], "\[RuleDelayed]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momconservationflat", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{"%", "==", "0"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9104578261337175`*^9, {3.910457965183443*^9, 3.9104579675581064`*^9}, {
   3.910460828984873*^9, 3.9104608456309605`*^9}, {3.9106814724727507`*^9, 
   3.910681535203182*^9}, {3.9106815725604873`*^9, 3.9106815806853952`*^9}},
 CellLabel->
  "In[595]:=",ExpressionUUID->"1165b411-161b-420b-981c-4cce743b43cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["display", "Subsection",
 CellChangeTimes->{{3.911384976691202*^9, 
  3.91138497797867*^9}},ExpressionUUID->"6232f008-78e0-4917-abf2-\
39d697740080"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getridofallplusminussc", "[", "pl_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pl", "//.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], ":>", 
       RowBox[{"Distribute", "[", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "Plus"}], "]"}]}]}], "//.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"a_.", "x_"}], ",", 
        RowBox[{"b_.", "y_"}]}], "]"}], ":>", 
      RowBox[{"a", " ", "b", " ", 
       RowBox[{"sc", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    SuperscriptBox[
     RowBox[{"k", "[", "i", "]"}], "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.91309902143433*^9, 3.913099067867524*^9}},
 CellLabel->
  "In[597]:=",ExpressionUUID->"6d388d04-8271-418b-9ecb-a00eca430acc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Onshellcykk", "[", 
   RowBox[{"del_", ",", 
    RowBox[{"kk", "[", "a_", "]"}], ",", "z_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"kk", "[", "a", "]"}], "2"], "\[RuleDelayed]", 
   FractionBox[
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"s", "[", "a", "]"}], "2"]}], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        FractionBox["d", "2"], "-", "del"}], ")"}], "2"]}], 
    SuperscriptBox["z", "2"]]}]}]], "Input",
 CellLabel->
  "In[598]:=",ExpressionUUID->"6bb63036-a6aa-4117-be47-1f5263d6b3a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "i", "]"}], ",", 
           RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
       SuperscriptBox[
        RowBox[{"k", "[", "i", "]"}], "2"]}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ksq", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "i", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}]}]}]}], "}"}]}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AdS5ptmy", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"%", "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ksq", "[", 
          RowBox[{"1", ",", "3"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"1", ",", "4"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"2", ",", "4"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"3", ",", "5"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"2", ",", "5"}], "]"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"ksq", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "2"]}]}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AdS5ptmyad", "=", 
   RowBox[{"%", "//", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"x_", ",", "y_"}], "]"}], "->", 
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"x", "^", "2"}], ",", 
          RowBox[{"y", "^", "2"}]}], "]"}]}]}], "]"}], "&"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9120714960782585`*^9, 3.9120714964194603`*^9}},
 CellLabel->
  "In[599]:=",ExpressionUUID->"06713275-1dc0-4e8d-a2a7-74ece3116a4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getsc", "[", "x_", "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{"x", ",", 
    RowBox[{"sc", "[", 
     RowBox[{"_", ",", "_"}], "]"}], ",", "Infinity"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9118032211160965`*^9, 3.9118032313082705`*^9}},
 CellLabel->
  "In[602]:=",ExpressionUUID->"4e0078b5-da5d-4cb4-b33f-ed9ad88ddcb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getsckk", "[", "x_", "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{"x", ",", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "_", "]"}], ",", 
      RowBox[{"k", "[", "_", "]"}]}], "]"}], ",", "Infinity"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9118033402041063`*^9, 3.9118033466921883`*^9}},
 CellLabel->
  "In[603]:=",ExpressionUUID->"2429ca2b-a2de-4163-b35c-5c8c22fcf87f"],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{
   RowBox[{"{", "scs", "}"}], ",", 
   RowBox[{"{", "Orderless", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8838695095750723`*^9, {3.9098396326352215`*^9, 3.90983963419488*^9}, {
   3.909839726735963*^9, 3.909839734292127*^9}, {3.9098476667977057`*^9, 
   3.9098476728824415`*^9}, 3.909847715203187*^9, {3.9108860639361525`*^9, 
   3.9108860641235833`*^9}, {3.9112518208376203`*^9, 
   3.9112518210598793`*^9}, {3.9115803754415083`*^9, 3.9115803771479573`*^9}},
 CellLabel->
  "In[604]:=",ExpressionUUID->"f4577528-9497-45a9-aed6-98eb8950a2fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllOnshellinv", "[", 
   RowBox[{"we_", ",", "x3_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"we", "/.", "\[VeryThinSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["c_.", 
       SuperscriptBox[
        RowBox[{"k", "[", "i_", "]"}], "2"]], "/;", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "x3", "}"}], ",", "i"}], "]"}]}], ":>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["z", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"c", "/.", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", "ii_", "]"}], "/;", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "x3", "}"}], ",", "ii"}], "]"}]}], "->", 
          RowBox[{
           RowBox[{"s", "[", "ii", "]"}], "-", "1"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], "-", "1"}], ")"}], "2"]}], "-", 
       FractionBox[
        SuperscriptBox["d", "2"], "4"]}]]}], "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.905958416950892*^9, {3.911544942531663*^9, 3.9115449659073744`*^9}, 
   3.9115573233420897`*^9, {3.9115573647751412`*^9, 3.911557365747381*^9}, {
   3.9115574259907346`*^9, 3.911557450664091*^9}, 3.9115574874782095`*^9, {
   3.9115575686624165`*^9, 3.911557614827813*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"2c0734d4-a21c-4689-a469-d8fc1628df0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllOnshellinvlist", "[", 
   RowBox[{"we_", ",", "x3_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"we", "//", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AllOnshellinv", "[", 
        RowBox[{"#", ",", "x3", ",", "z"}], "]"}], "&"}], ",", "#"}], "]"}], 
    "&"}]}]}]], "Input",
 CellChangeTimes->{{3.911557638813741*^9, 3.911557689950366*^9}},
 CellLabel->
  "In[606]:=",ExpressionUUID->"ac1da244-cf33-419e-a811-a97ec150abcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk1grav", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["ks", "2"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox["ks", "4"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "4"]}], ",", 
        RowBox[{
         SuperscriptBox["ks", 
          RowBox[{"-", "2"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], 
          RowBox[{"-", "2"}]]}], ",", 
        RowBox[{
         SuperscriptBox["ks", 
          RowBox[{"-", "4"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], 
          RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["kt", "2"], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], "2"]}], ",", 
       RowBox[{
        SuperscriptBox["kt", "4"], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], "4"]}], ",", 
       RowBox[{
        SuperscriptBox["kt", 
         RowBox[{"-", "2"}]], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], 
         RowBox[{"-", "2"}]]}], ",", 
       RowBox[{
        SuperscriptBox["kt", 
         RowBox[{"-", "4"}]], "->", 
        SuperscriptBox[
         RowBox[{"k", "[", "4", "]"}], 
         RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "1", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "1", "]"}], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9115765093422437`*^9, 3.9115765165642004`*^9}},
 CellLabel->
  "In[607]:=",ExpressionUUID->"63e3c8b2-da4c-401b-9e62-d7ee40429c26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk1", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["ks", "2"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "2"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", "4"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], "4"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "2"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], 
           RowBox[{"-", "2"}]]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "4"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "2", "]"}], 
           RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["kt", "2"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", "4"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], "4"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "2"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], 
          RowBox[{"-", "2"}]]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "4"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "4", "]"}], 
          RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "1", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "1", "]"}], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.911543650231041*^9, 3.9115436621513553`*^9}, 
   3.9115585061172996`*^9, 3.911561981543016*^9},
 CellLabel->
  "In[608]:=",ExpressionUUID->"8498928d-dd6d-4242-9997-cbaca93c09c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk2", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["ks", "2"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], "2"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", "4"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], "4"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "2"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], 
           RowBox[{"-", "2"}]]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "4"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "1", "]"}], 
           RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["kt", "2"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "3", "]"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", "4"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "3", "]"}], "4"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "2"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "3", "]"}], 
          RowBox[{"-", "2"}]]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "4"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "3", "]"}], 
          RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "2", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "2", "]"}], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9115583231665883`*^9, 3.911558344991724*^9}, 
   3.911558509162371*^9, 3.911561986893423*^9},
 CellLabel->
  "In[609]:=",ExpressionUUID->"4142b55a-5089-4fa9-9ef8-a63912ee2561"],

Cell[BoxData[
 RowBox[{
  RowBox[{"softk3", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["ks", "2"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], "2"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", "4"], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], "4"]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "2"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], 
           RowBox[{"-", "2"}]]}], ",", 
         RowBox[{
          SuperscriptBox["ks", 
           RowBox[{"-", "4"}]], "->", 
          SuperscriptBox[
           RowBox[{"k", "[", "4", "]"}], 
           RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["kt", "2"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "2"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", "4"], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], "4"]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "2"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], 
          RowBox[{"-", "2"}]]}], ",", 
        RowBox[{
         SuperscriptBox["kt", 
          RowBox[{"-", "4"}]], "->", 
         SuperscriptBox[
          RowBox[{"k", "[", "2", "]"}], 
          RowBox[{"-", "4"}]]}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"k", "[", "3", "]"}], ",", "_"}], "]"}], "->", "0"}]}], "/.", 
   RowBox[{
    RowBox[{"k", "[", "3", "]"}], "->", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.912013992203238*^9, 3.912014037864622*^9}},
 CellLabel->
  "In[610]:=",ExpressionUUID->"e6c222c4-1476-463d-b67d-11ca7ece3652"],

Cell[BoxData[
 RowBox[{
  RowBox[{"whatis", "[", 
   RowBox[{"wq_", ",", "si_", ",", "del_"}], "]"}], ":=", 
  RowBox[{"wq", "/.", 
   RowBox[{"si", "->", 
    RowBox[{
     FractionBox["del", "2"], "-", 
     FractionBox["d", "4"]}]}]}]}]], "Input",
 CellChangeTimes->{{3.9115443455628433`*^9, 3.9115443654601593`*^9}},
 CellLabel->
  "In[611]:=",ExpressionUUID->"c42cdcfe-3c2d-4825-9a25-6243526af206"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"k", "[", "1", "]"}], "->", "k1"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "->", "s1"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], "->", "e1"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "2", "]"}], "->", "k2"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "2", "]"}], "->", "s2"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "2", "]"}], "->", "e2"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "3", "]"}], "->", "k3"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "3", "]"}], "->", "s3"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], "->", "e3"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "4", "]"}], "->", "k4"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "4", "]"}], "->", "s4"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "4", "]"}], "->", "e4"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "5", "]"}], "->", "k5"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "5", "]"}], "->", "s5"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "5", "]"}], "->", "e5"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.9119956524162574`*^9},
 CellLabel->
  "In[612]:=",ExpressionUUID->"c65cb7d6-5081-47d0-8d8b-f0ca6eacc153"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindelta", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "//", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"#", ",", "z1"}], "]"}], "==", 
         RowBox[{"-", "2"}]}], ",", 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Mellindeltamy", "[", 
           RowBox[{"4", ",", 
            RowBox[{"-", "2"}], ",", 
            RowBox[{"s", "[", "4", "]"}]}], "]"}]}], "]"}], ",", "#"}], "]"}],
       "&"}]}], "//", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"#", ",", "z1"}], "]"}], "==", "0"}], ",", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Mellindeltamy", "[", 
          RowBox[{"4", ",", "0", ",", 
           RowBox[{"s", "[", "4", "]"}]}], "]"}]}], "]"}], ",", "#"}], "]"}], 
     "&"}]}], "//", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"#", ",", "z1"}], "]"}], "==", 
       RowBox[{"-", "4"}]}], ",", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Mellindeltamy", "[", 
         RowBox[{"4", ",", 
          RowBox[{"-", "4"}], ",", 
          RowBox[{"s", "[", "4", "]"}]}], "]"}]}], "]"}], ",", "#"}], "]"}], 
    "&"}]}]}]], "Input",
 CellChangeTimes->{{3.911540869211958*^9, 3.9115409383371787`*^9}, {
  3.9115410667317457`*^9, 3.9115410724129252`*^9}, {3.911541497773828*^9, 
  3.9115415043953753`*^9}},
 CellLabel->
  "In[613]:=",ExpressionUUID->"fcebd0a1-7a0f-4f53-9385-c9036ce09386"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindeltalist", "[", "x_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"scanMelindelta", ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.911541082299884*^9, 3.911541095391325*^9}},
 CellLabel->
  "In[614]:=",ExpressionUUID->"61a90691-aa70-436c-93f7-f413bd2fb937"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindeltavar", "[", 
   RowBox[{"x_", ",", "si_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"x", "//", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{"#", ",", "z1"}], "]"}], "==", 
           RowBox[{"-", "2"}]}], ",", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Mellindeltamy", "[", 
             RowBox[{"4", ",", 
              RowBox[{"-", "2"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
         "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"#", ",", "z1"}], "]"}], "==", "0"}], ",", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Mellindeltamy", "[", 
            RowBox[{"4", ",", "0", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
        "]"}], "&"}]}], "//", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"#", ",", "z1"}], "]"}], "==", 
         RowBox[{"-", "4"}]}], ",", 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Mellindeltamy", "[", 
           RowBox[{"4", ",", 
            RowBox[{"-", "4"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
       "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"#", ",", "z1"}], "]"}], "==", "2"}], ",", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Mellindeltamy", "[", 
          RowBox[{"4", ",", "2", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
      "]"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"#", ",", "z1"}], "]"}], "==", "4"}], ",", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Mellindeltamy", "[", 
         RowBox[{"4", ",", "4", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
     "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.9115411563899508`*^9, 3.9115411722624655`*^9}, {
  3.911541541496923*^9, 3.9115415492203083`*^9}, {3.9117557274147344`*^9, 
  3.911755745059069*^9}, {3.9119322972712755`*^9, 3.9119323058969483`*^9}},
 CellLabel->
  "In[615]:=",ExpressionUUID->"a00896fd-b3e8-4c00-a7da-473acf89523f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindeltavar5", "[", 
   RowBox[{"x_", ",", "si_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "//", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "z1"}], "]"}], "==", 
                    RowBox[{"-", "2"}]}], ",", 
                    RowBox[{"ReplaceAll", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", 
                    RowBox[{"-", "2"}], ",", "si"}], "]"}]}], "]"}], ",", 
                    "#"}], "]"}], "&"}]}], "//", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "z1"}], "]"}], "==", "0"}], ",", 
                    RowBox[{"ReplaceAll", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", "0", ",", "si"}], "]"}]}], "]"}], ",", 
                    "#"}], "]"}], "&"}]}], "//", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "z1"}], "]"}], "==", 
                    RowBox[{"-", "4"}]}], ",", 
                    RowBox[{"ReplaceAll", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", 
                    RowBox[{"-", "4"}], ",", "si"}], "]"}]}], "]"}], ",", 
                    "#"}], "]"}], "&"}]}], "//", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "z1"}], "]"}], "==", "2"}], ",", 
                   RowBox[{"ReplaceAll", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", "2", ",", "si"}], "]"}]}], "]"}], ",", 
                   "#"}], "]"}], "&"}]}], "//", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Exponent", "[", 
                    RowBox[{"#", ",", "z1"}], "]"}], "==", "4"}], ",", 
                  RowBox[{"ReplaceAll", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", "4", ",", "si"}], "]"}]}], "]"}], ",", 
                  "#"}], "]"}], "&"}]}], "//", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Exponent", "[", 
                   RowBox[{"#", ",", "z1"}], "]"}], "==", "6"}], ",", 
                 RowBox[{"ReplaceAll", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Mellindeltamy", "[", 
                    RowBox[{"5", ",", "6", ",", "si"}], "]"}]}], "]"}], ",", 
                 "#"}], "]"}], "&"}]}], "//", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exponent", "[", 
                  RowBox[{"#", ",", "z1"}], "]"}], "==", 
                 RowBox[{"-", "6"}]}], ",", 
                RowBox[{"ReplaceAll", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Mellindeltamy", "[", 
                   RowBox[{"5", ",", 
                    RowBox[{"-", "6"}], ",", "si"}], "]"}]}], "]"}], ",", 
                "#"}], "]"}], "&"}]}], "//", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"#", ",", "z1"}], "]"}], "==", 
                RowBox[{"-", "8"}]}], ",", 
               RowBox[{"ReplaceAll", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Mellindeltamy", "[", 
                  RowBox[{"5", ",", 
                   RowBox[{"-", "8"}], ",", "si"}], "]"}]}], "]"}], ",", 
               "#"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exponent", "[", 
                RowBox[{"#", ",", "z1"}], "]"}], "==", "8"}], ",", 
              RowBox[{"ReplaceAll", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Mellindeltamy", "[", 
                 RowBox[{"5", ",", "8", ",", "si"}], "]"}]}], "]"}], ",", 
              "#"}], "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exponent", "[", 
               RowBox[{"#", ",", "z1"}], "]"}], "==", 
              RowBox[{"-", "7"}]}], ",", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Mellindeltamy", "[", 
                RowBox[{"5", ",", 
                 RowBox[{"-", "7"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
            "]"}], "&"}]}], "//", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exponent", "[", 
              RowBox[{"#", ",", "z1"}], "]"}], "==", "7"}], ",", 
            RowBox[{"ReplaceAll", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Mellindeltamy", "[", 
               RowBox[{"5", ",", "7", ",", "si"}], "]"}]}], "]"}], ",", "#"}],
            "]"}], "&"}]}], "//", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Exponent", "[", 
             RowBox[{"#", ",", "z1"}], "]"}], "==", 
            RowBox[{"-", "5"}]}], ",", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Mellindeltamy", "[", 
              RowBox[{"5", ",", 
               RowBox[{"-", "5"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
          "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Exponent", "[", 
            RowBox[{"#", ",", "z1"}], "]"}], "==", "5"}], ",", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Mellindeltamy", "[", 
             RowBox[{"5", ",", "5", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
         "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exponent", "[", 
           RowBox[{"#", ",", "z1"}], "]"}], "==", 
          RowBox[{"-", "3"}]}], ",", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Mellindeltamy", "[", 
            RowBox[{"5", ",", 
             RowBox[{"-", "3"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
        "]"}], "&"}]}], "//", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"#", ",", "z1"}], "]"}], "==", "3"}], ",", 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Mellindeltamy", "[", 
           RowBox[{"5", ",", "3", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
       "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exponent", "[", 
         RowBox[{"#", ",", "z1"}], "]"}], "==", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Mellindeltamy", "[", 
          RowBox[{"5", ",", 
           RowBox[{"-", "1"}], ",", "si"}], "]"}]}], "]"}], ",", "#"}], "]"}],
      "&"}]}], "//", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Exponent", "[", 
        RowBox[{"#", ",", "z1"}], "]"}], "==", "1"}], ",", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Mellindeltamy", "[", 
         RowBox[{"5", ",", "1", ",", "si"}], "]"}]}], "]"}], ",", "#"}], 
     "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.9119323306525764`*^9, 3.9119323851440964`*^9}, {
  3.9120952789306*^9, 3.912095293582445*^9}, {3.912858967570516*^9, 
  3.912858994191464*^9}},
 CellLabel->
  "In[616]:=",ExpressionUUID->"560cbbac-cf8b-4cb9-9e03-f2f91f1ce0de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindeltalistvar5", "[", 
   RowBox[{"x_", ",", "si_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"scanMelindeltavar5", "[", 
      RowBox[{"#", ",", "si"}], "]"}], "&"}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.911932394369542*^9, 3.9119323952558784`*^9}},
 CellLabel->
  "In[617]:=",ExpressionUUID->"f1ddeda1-0745-4b96-90e5-e62b55c5b5bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanMelindeltalistvar", "[", 
   RowBox[{"x_", ",", "si_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"scanMelindeltavar", "[", 
      RowBox[{"#", ",", "si"}], "]"}], "&"}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9115411782006636`*^9, 3.911541179999627*^9}, {
  3.9115412161354094`*^9, 3.9115412517941337`*^9}},
 CellLabel->
  "In[618]:=",ExpressionUUID->"a85d1317-de05-419e-8ce9-03a606683da1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshell", "[", 
   RowBox[{"p_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "[", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"p", ",", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"k", "[", "i", "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"p", "/.", 
       RowBox[{
        RowBox[{"s", "[", "i", "]"}], "->", 
        RowBox[{
         RowBox[{"s", "[", "i", "]"}], "+", "1"}]}]}], ",", 
      RowBox[{"Onshellcy", "[", 
       RowBox[{"d", ",", 
        RowBox[{"k", "[", "i", "]"}], ",", "z1"}], "]"}]}], "]"}], ",", "p"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.911401498263362*^9, 3.911401529936572*^9}, {
  3.9114015667255025`*^9, 3.9114016637008767`*^9}},
 CellLabel->
  "In[619]:=",ExpressionUUID->"2839e788-e246-4a94-af95-5e6d876b914f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshelllist", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "//", 
       RowBox[{
        RowBox[{"scanK2sOnshell", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"scanK2sOnshell", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "//", 
     RowBox[{
      RowBox[{"scanK2sOnshell", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"scanK2sOnshell", "[", 
      RowBox[{"#", ",", "4"}], "]"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"scanK2sOnshell", "[", 
     RowBox[{"#", ",", "5"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.91140174603898*^9, 3.911401797054324*^9}, {
  3.9114018378165264`*^9, 3.9114018511659355`*^9}, {3.911924226609928*^9, 
  3.9119242282888126`*^9}},
 CellLabel->
  "In[620]:=",ExpressionUUID->"80ed2482-062a-4720-81e3-f2e2bafc2e4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshelllistmap", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "//", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"scanK2sOnshelllist", ",", "#"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.9114036693173323`*^9, 3.9114036757702*^9}},
 CellLabel->
  "In[621]:=",ExpressionUUID->"f092f1e1-c000-42b8-8f55-e37e9ec8a614"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rulesinv", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "->", 
      RowBox[{"k", "[", "1", "]"}]}], ",", 
     RowBox[{"s1", "->", 
      RowBox[{"s", "[", "1", "]"}]}], ",", 
     RowBox[{"e1", "->", 
      RowBox[{"e", "[", "1", "]"}]}], ",", 
     RowBox[{"k2", "->", 
      RowBox[{"k", "[", "2", "]"}]}], ",", 
     RowBox[{"s2", "->", 
      RowBox[{"s", "[", "2", "]"}]}], ",", 
     RowBox[{"e2", "->", 
      RowBox[{"e", "[", "2", "]"}]}], ",", 
     RowBox[{"k3", "->", 
      RowBox[{"k", "[", "3", "]"}]}], ",", 
     RowBox[{"s3", "->", 
      RowBox[{"s", "[", "3", "]"}]}], ",", 
     RowBox[{"e3", "->", 
      RowBox[{"e", "[", "3", "]"}]}], ",", 
     RowBox[{"k4", "->", 
      RowBox[{"k", "[", "4", "]"}]}], ",", 
     RowBox[{"s4", "->", 
      RowBox[{"s", "[", "4", "]"}]}], ",", 
     RowBox[{"e4", "->", 
      RowBox[{"e", "[", "4", "]"}]}], ",", 
     RowBox[{"k5", "->", 
      RowBox[{"k", "[", "5", "]"}]}], ",", 
     RowBox[{"s5", "->", 
      RowBox[{"s", "[", "5", "]"}]}], ",", 
     RowBox[{"e5", "->", 
      RowBox[{"e", "[", "5", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9114999392307577`*^9, 3.9114999424796515`*^9}, {
  3.911500015554905*^9, 3.911500017942329*^9}, {3.9117146138178663`*^9, 
  3.9117146368223886`*^9}},
 CellLabel->
  "In[622]:=",ExpressionUUID->"062219e3-7924-4698-bc8a-d810266db85c"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Mellindeltamy", "[", 
    RowBox[{"n_", ",", "b_", ",", "a_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"2", 
             RowBox[{"s", "[", "i", "]"}]}], "-", 
            RowBox[{"d", "/", "2"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "+", "d", "-", 
         "b"}], "\[Equal]", "0"}], ",", "a"}], "]"}], "}"}], "//", 
    "Flatten"}]}]}]], "Input",
 CellChangeTimes->{{3.9114039521715155`*^9, 3.9114039522255793`*^9}, {
   3.9114039841508985`*^9, 3.911403985331539*^9}, 3.911543205818709*^9},
 CellLabel->
  "In[623]:=",ExpressionUUID->"1d95a980-5a9b-4916-b895-5658ef3b427e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getExponent", "[", "ppow_", "]"}], ":=", 
  RowBox[{"ppow", "//", 
   RowBox[{
    RowBox[{"Exponent", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"k", "[", "1", "]"}], ",", 
        RowBox[{"k", "[", "2", "]"}], ",", 
        RowBox[{"k", "[", "3", "]"}], ",", 
        RowBox[{"k", "[", "4", "]"}], ",", 
        RowBox[{"k", "[", "5", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}], ",", 
        RowBox[{"kk", "[", "2", "]"}], ",", 
        RowBox[{"kk", "[", "3", "]"}], ",", 
        RowBox[{"kk", "[", "4", "]"}], ",", 
        RowBox[{"kk", "[", "5", "]"}], ",", 
        RowBox[{"kkk", "[", "1", "]"}], ",", 
        RowBox[{"kkk", "[", "2", "]"}], ",", 
        RowBox[{"kkk", "[", "3", "]"}], ",", 
        RowBox[{"kkk", "[", "4", "]"}], ",", 
        RowBox[{"kkk", "[", "5", "]"}], ",", 
        RowBox[{"kkkk", "[", "1", "]"}], ",", 
        RowBox[{"kkkk", "[", "2", "]"}], ",", 
        RowBox[{"kkkk", "[", "3", "]"}], ",", 
        RowBox[{"kkkk", "[", "4", "]"}], ",", 
        RowBox[{"kkkk", "[", "5", "]"}], ",", 
        RowBox[{"s", "[", "1", "]"}], ",", 
        RowBox[{"s", "[", "2", "]"}], ",", 
        RowBox[{"s", "[", "3", "]"}], ",", 
        RowBox[{"s", "[", "4", "]"}], ",", 
        RowBox[{"s", "[", "5", "]"}]}], "}"}]}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.912094541089758*^9, 3.912094545593626*^9}, {
  3.912094782248851*^9, 3.9120948079205585`*^9}},
 CellLabel->
  "In[624]:=",ExpressionUUID->"6a9a7db8-f03f-405b-8c5b-c6c3d9470989"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3k2rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "[", "1", "]"}], "==", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "d", "-", 
          RowBox[{"2", " ", 
           RowBox[{"s", "[", "2", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"s", "[", "3", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}]}], "}"}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"s", "[", "3", "]"}], "}"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[625]:=",ExpressionUUID->"e99ab9fc-e454-4878-b9e7-8b42f58a3790"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Onshellcy", "[", 
   RowBox[{"del_", ",", 
    RowBox[{"k", "[", "a_", "]"}], ",", "z_"}], "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"k", "[", "a", "]"}], "2"], ":>", 
   FractionBox[
    RowBox[{
     RowBox[{"4", 
      SuperscriptBox[
       RowBox[{"s", "[", "a", "]"}], "2"]}], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        FractionBox["d", "2"], "-", "del"}], ")"}], "2"]}], 
    SuperscriptBox["z", "2"]]}]}]], "Input",
 CellChangeTimes->{{3.9113863747189236`*^9, 3.9113863859231634`*^9}},
 CellLabel->
  "In[626]:=",ExpressionUUID->"718c81a0-1ab5-43e7-94ed-bd80556b0321"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Onshell", "[", "pqw_", "]"}], ":=", 
  RowBox[{"pqw", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Onshellcy", "[", 
      RowBox[{"d", ",", 
       RowBox[{"k", "[", "1", "]"}], ",", "z1"}], "]"}], ",", 
     RowBox[{"Onshellcy", "[", 
      RowBox[{"d", ",", 
       RowBox[{"k", "[", "2", "]"}], ",", "z1"}], "]"}], ",", 
     RowBox[{"Onshellcy", "[", 
      RowBox[{"d", ",", 
       RowBox[{"k", "[", "3", "]"}], ",", "z1"}], "]"}], ",", 
     RowBox[{"Onshellcy", "[", 
      RowBox[{"d", ",", 
       RowBox[{"k", "[", "4", "]"}], ",", "z1"}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9113863598692675`*^9, 3.9113864182356234`*^9}},
 CellLabel->
  "In[627]:=",ExpressionUUID->"212c3ba0-eb26-4f44-a89c-d400cf87ebfe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1k0rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "1", "]"}], "+", 
       RowBox[{"s", "[", "2", "]"}], "+", 
       RowBox[{"s", "[", "3", "]"}], "+", 
       RowBox[{"s", "[", "4", "]"}]}], "==", 
      FractionBox["d", "2"]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "1", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s4k0rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "1", "]"}], "+", 
       RowBox[{"s", "[", "2", "]"}], "+", 
       RowBox[{"s", "[", "3", "]"}], "+", 
       RowBox[{"s", "[", "4", "]"}]}], "==", 
      FractionBox["d", "2"]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "4", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[628]:=",ExpressionUUID->"06b838eb-2a0c-4ed0-b3c5-fe94f76a6550"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3k0rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "==", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"d", "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "2", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "3", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "3", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[630]:=",ExpressionUUID->"0d1cb39e-2a32-433d-940f-5ef483a91207"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s3km2rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "==", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "d", "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "2", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "3", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"s", "[", "4", "]"}]}]}], ")"}]}]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "3", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{3.911386002813303*^9},
 CellLabel->
  "In[631]:=",ExpressionUUID->"43de5ca0-42ae-41ca-80d8-29e36fcc5ab7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1km2rl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"d", "+", "2"}], "\[Equal]", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s", "[", "1", "]"}], "+", 
         RowBox[{"s", "[", "2", "]"}], "+", 
         RowBox[{"s", "[", "3", "]"}], "+", 
         RowBox[{"s", "[", "4", "]"}]}], ")"}]}]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "1", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[632]:=",ExpressionUUID->"376b4117-3bec-4dc4-8846-77b5a42841a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToShortestHelicityBasis4", "[", "o_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"o", "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "x4_", "]"}], ",", 
         RowBox[{"k", "[", "x2_", "]"}]}], "]"}], "+", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "x4_", "]"}], ",", 
         RowBox[{"k", "[", "x3_", "]"}]}], "]"}]}], ":>", 
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "x4", "]"}], ",", 
         RowBox[{"k", "[", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", "4", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x2", ",", "x3"}], "}"}]}], "]"}], "]"}]}], "]"}]}]}]}], 
    "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "x4_", "]"}], ",", 
       RowBox[{"k", "[", "l_List", "]"}]}], "]"}], "->", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "x4", "]"}], ",", 
         RowBox[{"k", "[", "i", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "l"}], "}"}]}], "]"}]}]}], "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.911388559510954*^9, 3.9113886278817253`*^9}, {
   3.9113887229122057`*^9, 3.9113887946341333`*^9}, {3.911389125466278*^9, 
   3.9113891278219557`*^9}, {3.911389179033951*^9, 3.911389208827175*^9}, {
   3.911651475791501*^9, 3.9116514829390297`*^9}, 3.9116517035678773`*^9, {
   3.911667585666851*^9, 3.9116675866991587`*^9}},
 CellLabel->
  "In[633]:=",ExpressionUUID->"f2d967fa-40a3-47d6-a874-925e45eb2832"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nok4e4", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9113888151405153`*^9, 3.9113888249630356`*^9}, {
  3.9116516137805495`*^9, 3.911651616862626*^9}, {3.9116675938583*^9, 
  3.911667595203745*^9}},
 CellLabel->
  "In[634]:=",ExpressionUUID->"acdb6301-9d7a-4e31-aa79-e6f7b23826dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1k2rl", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"s", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "==", 
      RowBox[{"d", "-", "2"}]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "1", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s4k2rl", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"s", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "==", 
      RowBox[{"d", "-", "2"}]}], "//", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "4", "]"}]}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.911400754351497*^9, 3.9114007552420063`*^9}},
 CellLabel->
  "In[635]:=",ExpressionUUID->"717100b0-8bbc-4e93-ba2e-a7650e165515"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], ",", 
        RowBox[{"\[Mu]", "[", 
         RowBox[{"e", "[", "j_", "]"}], "]"}]}], "]"}], ",", "StandardForm"}],
      "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"k", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"\[Mu]", "[", 
          RowBox[{"e", "[", "j", "]"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
       "]"}], ",", "StandardForm"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", 
         RowBox[{"e", "[", "i_", "]"}], "]"}], ",", 
        RowBox[{"\[Mu]", "[", 
         RowBox[{"e", "[", "j_", "]"}], "]"}]}], "]"}], ",", "StandardForm"}],
      "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "i_"], ",", "StandardForm"}], "]"}], 
         ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"\[Mu]", "[", 
          RowBox[{"e", "[", "i", "]"}], "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"\[Mu]", "[", 
          RowBox[{"e", "[", "j", "]"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
       "]"}], ",", "StandardForm"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], ",", 
        RowBox[{"k", "[", "j_", "]"}]}], "]"}], ",", "StandardForm"}], "]"}], 
    ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "j"], ",", "StandardForm"}], "]"}]}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "j_"], ",", "StandardForm"}], "]"}]}], "}"}], 
       "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"k", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"k", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
      "StandardForm"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "j_", "]"}]}], "]"}], ",", "StandardForm"}], 
     "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"MakeBoxes", "[", 
       RowBox[{"Subsuperscript", "[", 
        RowBox[{"k", ",", "i", ",", "j"}], "]"}], "]"}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"MakeBoxes", "[", 
         RowBox[{"Subsuperscript", "[", 
          RowBox[{"k", ",", "i_", ",", "j_"}], "]"}], "]"}], "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"k", "[", "i", "]"}], ",", "\"\<,\[Mu][\>\"", ",", "j", ",", 
         "\"\<]\>\""}], "}"}], "]"}], ",", "StandardForm"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", " ", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
        RowBox[{"\[Mu]", "[", 
         RowBox[{"e", "[", "j_", "]"}], "]"}]}], "]"}], ",", "StandardForm"}],
      "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"MakeBoxes", "[", 
       RowBox[{"Subsuperscript", "[", 
        RowBox[{"\[Epsilon]", ",", "j", ",", "i"}], "]"}], "]"}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"MakeBoxes", "[", 
         RowBox[{"Subsuperscript", "[", 
          RowBox[{"\[Epsilon]", ",", "j_", ",", "i_"}], "]"}], "]"}], "}"}], 
       "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"\[Mu]", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"\[Mu]", "[", 
          RowBox[{"e", "[", "j", "]"}], "]"}], ",", "\"\<]\>\""}], "}"}], 
       "]"}], ",", "StandardForm"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.9099065825303125`*^9, {3.909906757121278*^9, 3.90990692325452*^9}, {
   3.9099070318984594`*^9, 3.9099070705249567`*^9}, {3.9103670753061733`*^9, 
   3.910367100158693*^9}, {3.9103671509495716`*^9, 3.910367195426556*^9}, {
   3.9103672471932325`*^9, 3.9103673881680536`*^9}, {3.911464136504984*^9, 
   3.9114641587984686`*^9}},
 CellLabel->
  "In[637]:=",ExpressionUUID->"098171d5-a4c4-40c6-a50a-752f2d515274"],

Cell[BoxData[{
 RowBox[{"scs", "/:", 
  RowBox[{"MakeBoxes", "[", " ", 
   RowBox[{
    RowBox[{"scs", "[", 
     RowBox[{
      RowBox[{"e", "[", "j_", "]"}], ",", 
      RowBox[{"\[Mu]", "[", "i_", "]"}]}], "]"}], ",", "StandardForm"}], 
   "]"}], ":=", 
  RowBox[{"RowBox", "[", 
   RowBox[{"{", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{"Subsuperscript", "[", 
      RowBox[{"\[Epsilon]", ",", "j", ",", "i"}], "]"}], "]"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"scs", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"scs", "[", 
     RowBox[{
      RowBox[{"e", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "j_", "]"}]}], "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"RowBox", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "i"], ",", "StandardForm"}], "]"}], ",", 
     RowBox[{"MakeBoxes", "[", 
      RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], "}"}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeExpression", "[", 
   RowBox[{"(*", "assa", "*)"}], 
   RowBox[{
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "i_"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}], 
    RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"MakeExpression", "[", 
   RowBox[{
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
       RowBox[{"e", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
       RowBox[{"e", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
    "StandardForm"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.911385873851326*^9, 3.9113858839041257`*^9}, {
  3.9114641595825324`*^9, 3.911464162646982*^9}, {3.9280444966501455`*^9, 
  3.9280445292522297`*^9}},
 CellLabel->
  "In[647]:=",ExpressionUUID->"12381d4a-89e1-47f6-8d51-412f7f51a597"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"k", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "j_", "]"}]}], "]"}], ",", "StandardForm"}], "]"}], 
    ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"k", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"e", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
      "StandardForm"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9113871263053465`*^9, 3.9113871303995695`*^9}, {
  3.9114641635763035`*^9, 3.9114641654090877`*^9}, {3.911580308431387*^9, 
  3.911580314008539*^9}},
 CellLabel->
  "In[650]:=",ExpressionUUID->"daed8503-d6a5-4590-b249-078cf42134c3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scs", "[", 
       RowBox[{
        RowBox[{"e", "[", "j_", "]"}], ",", 
        RowBox[{"k", "[", "i_", "]"}]}], "]"}], ",", "StandardForm"}], "]"}], 
    ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scs\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"k", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"e", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
      "StandardForm"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"ksqs", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"ksqs", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "j"], ",", "StandardForm"}], "]"}]}], "}"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "j_"], ",", "StandardForm"}], "]"}]}], "}"}], 
       "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ksqs\>\"", ",", "\"\<[\>\"", ",", "i", ",", "\"\<,\>\"", ",", 
         "j", ",", "\"\<]\>\""}], "}"}], "]"}], ",", "StandardForm"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9115803244525957`*^9, 3.911580329434168*^9}, {
  3.9118045233139944`*^9, 3.9118045555108185`*^9}},
 CellLabel->
  "In[652]:=",ExpressionUUID->"72b34efb-91d3-441f-b747-044ed98afc57"],

Cell[BoxData[{
 RowBox[{"ksD", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"ksD", "[", "i_", "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"RowBox", "[", 
   RowBox[{"{", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeExpression", "[", 
   RowBox[{"(*", "assa", "*)"}], 
   RowBox[{
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"MakeBoxes", "[", 
       RowBox[{
        SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], "}"}], "]"}], 
    RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"MakeExpression", "[", 
   RowBox[{
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<ksD\>\"", ",", "\"\<[\>\"", ",", "i", ",", "\"\<]\>\""}], 
      "}"}], "]"}], ",", "StandardForm"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.918726247727139*^9, 3.918726276079137*^9}},
 CellLabel->
  "In[656]:=",ExpressionUUID->"945498aa-696b-42cf-848d-1117f0c3f718"],

Cell[BoxData[{
 RowBox[{"SsD", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"SsD", "[", "i_", "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"RowBox", "[", 
   RowBox[{"{", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      SubscriptBox["s", "i"], ",", "StandardForm"}], "]"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeExpression", "[", 
   RowBox[{"(*", "assa", "*)"}], 
   RowBox[{
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"MakeBoxes", "[", 
       RowBox[{
        SubscriptBox["s", "i_"], ",", "StandardForm"}], "]"}], "}"}], "]"}], 
    RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"MakeExpression", "[", 
   RowBox[{
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<SsD\>\"", ",", "\"\<[\>\"", ",", "i", ",", "\"\<]\>\""}], 
      "}"}], "]"}], ",", "StandardForm"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.918726286619239*^9, 3.9187263023349295`*^9}},
 CellLabel->
  "In[658]:=",ExpressionUUID->"82f225ed-7d63-4173-be33-25d1057e5111"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scsS", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scsS", "[", 
       RowBox[{
        RowBox[{"e", "[", "j_", "]"}], ",", 
        RowBox[{"ksD", "[", "i_", "]"}]}], "]"}], ",", "StandardForm"}], 
     "]"}], ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["k", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["k", "i_"], ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scsS\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"ksD", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"e", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
      "StandardForm"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.918726417312349*^9, 3.9187264443203244`*^9}},
 CellLabel->
  "In[660]:=",ExpressionUUID->"dd63add0-5d27-4b32-a59e-292ad44f422b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scsS", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scsS", "[", 
       RowBox[{
        RowBox[{"e", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "j_", "]"}]}], "]"}], ",", "StandardForm"}], "]"}], 
    ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "i"], ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "j"], ",", "StandardForm"}], "]"}]}], 
      "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "i_"], ",", "StandardForm"}], "]"}], 
         ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"\"\<\[CenterDot]\>\"", ",", "StandardForm"}], "]"}], ",", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{
           SubscriptBox["\[Epsilon]", "j_"], ",", "StandardForm"}], "]"}]}], 
        "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scsS\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"e", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"e", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
      "StandardForm"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.918727090387278*^9, 3.9187270930849905`*^9}},
 CellLabel->
  "In[662]:=",ExpressionUUID->"9892d2d4-75bb-4a9d-97e7-57cc797b5f32"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"scsSe", "/:", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"scsSe", "[", 
       RowBox[{
        RowBox[{"e", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "j_", "]"}]}], "]"}], ",", "StandardForm"}], "]"}], 
    ":=", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"MakeBoxes", "[", 
       RowBox[{
        SubscriptBox["\[Epsilon]", 
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j"}], "}"}], "]"}]], ",", "StandardForm"}], 
       "]"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakeExpression", "[", 
     RowBox[{"(*", "assa", "*)"}], 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"MakeBoxes", "[", 
         RowBox[{
          SubscriptBox["\[Epsilon]", 
           RowBox[{"MakeBoxes", "[", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}], "]"}]], ",", "StandardForm"}], 
         "]"}], "}"}], "]"}], 
      RowBox[{"(*", ".", "*)"}], ",", "StandardForm"}], "]"}], ":=", 
    RowBox[{"MakeExpression", "[", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<scsSe\>\"", ",", "\"\<[\>\"", ",", 
         RowBox[{"e", "[", "i", "]"}], ",", "\"\<,\>\"", ",", 
         RowBox[{"e", "[", "j", "]"}], ",", "\"\<]\>\""}], "}"}], "]"}], ",", 
      "StandardForm"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9187291163079767`*^9, 3.9187291614674034`*^9}, {
  3.9187292781380258`*^9, 3.9187292930918655`*^9}},
 CellLabel->
  "In[664]:=",ExpressionUUID->"0de652b1-c6d9-429e-98a6-76ebd46e5daa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToDisplay", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"x", "/.", 
    RowBox[{"sc", "->", "scs"}]}], "/.", 
   RowBox[{"ksq", "->", "ksqs"}]}]}]], "Input",
 CellChangeTimes->{{3.911464170268661*^9, 3.9114641802507124`*^9}, {
  3.9118045591801243`*^9, 3.9118045630658555`*^9}},
 CellLabel->
  "In[666]:=",ExpressionUUID->"9719d923-8f8a-4bd4-a2bd-7fe18df965cc"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Clear", "@", "sc"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9113860464219103`*^9, 3.911386048729699*^9}, 
   3.911387124167036*^9, 3.911390488563719*^9, 3.9113992879475193`*^9},
 CellLabel->
  "In[667]:=",ExpressionUUID->"2c0c2b66-4082-45ef-a34d-f26f358f8b83"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllOnshellinv", "[", 
   RowBox[{"we_", ",", "x3_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"we", "/.", "\[VeryThinSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["c_.", 
       SuperscriptBox[
        RowBox[{"k", "[", "i_", "]"}], "2"]], "/;", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "x3", "}"}], ",", "i"}], "]"}]}], ":>", 
     FractionBox[
      RowBox[{
       SuperscriptBox["z", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"c", "/.", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "[", "ii_", "]"}], "/;", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "x3", "}"}], ",", "ii"}], "]"}]}], "->", 
          RowBox[{
           RowBox[{"s", "[", "ii", "]"}], "-", "1"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], "-", "1"}], ")"}], "2"]}], "-", 
       FractionBox[
        SuperscriptBox["d", "2"], "4"]}]]}], "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.905958416950892*^9, {3.911544942531663*^9, 3.9115449659073744`*^9}, 
   3.9115573233420897`*^9, {3.9115573647751412`*^9, 3.911557365747381*^9}, {
   3.9115574259907346`*^9, 3.911557450664091*^9}, 3.9115574874782095`*^9, {
   3.9115575686624165`*^9, 3.911557614827813*^9}},
 CellLabel->
  "In[668]:=",ExpressionUUID->"b2b5b8ae-9c51-41cf-b396-061ec54d1f86"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myFunction", "[", "resope_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ress", ",", "resf", ",", "ressf"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ress", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"resope", "/.", " ", "AdS5ptmy"}], "/.", " ", 
                RowBox[{
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i_", "]"}], ",", 
                   RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.",
                " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"k", "[", "i_", "]"}], ",", 
                  RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"k", "[", "i", "]"}], "^", "2"}]}]}], "/.", " ", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "->", 
               RowBox[{
                RowBox[{"1", "/", "2"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ks", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "i", "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "j", "]"}], "^", "2"}]}], ")"}]}]}]}], "/.",
              " ", "kijrl"}], "/.", " ", "AdS5ptmy"}], "/.", " ", 
           RowBox[{
            RowBox[{"s", "[", "i_", "]"}], ":>", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z1", " ", 
               RowBox[{"k", "[", "i", "]"}]}], ")"}], "/", "2"}]}]}], "/.", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"k", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"kk", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", " ", 
         RowBox[{
          RowBox[{"k", "[", "3", "]"}], "->", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"k", "[", "1", "]"}]}], "-", 
           RowBox[{"k", "[", "2", "]"}], "-", 
           RowBox[{"k", "[", "5", "]"}], "-", 
           RowBox[{"k", "[", "4", "]"}]}]}]}], "/.", " ", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"D", ",", 
           RowBox[{"ks", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}]}], "]"}], "->", 
         RowBox[{
          RowBox[{"z1", "^", "2"}], " ", 
          RowBox[{"S", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resf", "=", 
       RowBox[{"ress", "//", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"z1", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], 
         "&"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ressf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"resf", "/.", " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.",
               " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"e", "[", "i", "]"}], ",", 
                    RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
             " ", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"kk", "[", "i_", "]"}], ",", 
                RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
            " ", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}], ":>", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", " ", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"kk", "[", "i_", "]"}], ",", 
              RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
          "Normal"}], "//", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"x1_", ",", "x2_"}], "]"}], "->", 
           RowBox[{
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], "^", "2"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"k", "[", "x1", "]"}], "^", "2"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"k", "[", "x1", "]"}], " ", 
               RowBox[{"k", "[", "x2", "]"}]}], "+", 
              RowBox[{
               RowBox[{"k", "[", "x2", "]"}], "^", "2"}]}], ")"}]}]}], 
          "]"}]}], "//", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"k", "[", "3", "]"}], "->", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "5", "]"}], "-", 
             RowBox[{"k", "[", "4", "]"}]}]}]}], "]"}], "&"}]}]}], ";", 
      RowBox[{"Return", "[", "ressf", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9130474291728506`*^9, 3.913047449466036*^9}, {
  3.9130479131508384`*^9, 3.9130479368870506`*^9}},
 CellLabel->
  "In[669]:=",ExpressionUUID->"7da78e5a-d6c2-40c8-b47c-747136ba7ac9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatSpaceMinimalEandK", "[", 
   RowBox[{"px_", ",", "kk_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"px", "/.", "\[VeryThinSpace]", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[Rule]", "0"}]}], "/.", 
      "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
     "\[VeryThinSpace]", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"kk", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}], "/.",
     "\[VeryThinSpace]", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"kk", "[", "3", "]"}]}], "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", 
   "\[VeryThinSpace]", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"kk", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    "0"}]}]}]], "Input",
 CellLabel->
  "In[670]:=",ExpressionUUID->"aa58fa2e-423a-4ddb-add2-6cd1d2857a9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nosckiki", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    SuperscriptBox[
     RowBox[{"k", "[", "i", "]"}], "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.913131316474275*^9, 3.9131313217983847`*^9}},
 CellLabel->
  "In[671]:=",ExpressionUUID->"6e424ead-97ec-4e14-8880-4a60a132226d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AdSksMinimalVar", "[", "xp_", "]"}], ":=", 
  RowBox[{
   RowBox[{"xp", "//", 
    RowBox[{"ReplaceAll", "[", "AdS5ptmy", "]"}]}], "//", 
   RowBox[{"ReplaceAll", "[", "AdS5ptmyad", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9131316734666433`*^9, 3.9131316827277446`*^9}},
 CellLabel->
  "In[672]:=",ExpressionUUID->"0a2ff80f-ceb9-4eec-924f-e4ab5231f5a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MinimalVarAdSks", "[", "xp_", "]"}], ":=", 
  RowBox[{
   RowBox[{"xp", "//", 
    RowBox[{"ReplaceAll", "[", "AdS5ptmy", "]"}]}], "//", 
   RowBox[{"ReplaceAll", "[", "AdS5ptmyad", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9131477711474338`*^9, 3.9131477722427506`*^9}},
 CellLabel->
  "In[673]:=",ExpressionUUID->"9a03fa6f-bead-4a27-9372-4c4d13372a4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToMinimalPolarizationVariable", "[", 
   RowBox[{
   "qqw_", ",", "x4_", ",", "x1_", ",", "x2_", ",", "x3_", ",", "x5_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"qqw", "/.", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"k", "[", "x4", "]"}]}], "]"}], ":>", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"k", "[", "x2", "]"}]}], "]"}]}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"k", "[", "x3", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"k", "[", "x1", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"k", "[", "x5", "]"}]}], "]"}]}]}]}], "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9131319854853554`*^9, 3.9131320431204276`*^9}},
 CellLabel->
  "In[674]:=",ExpressionUUID->"7d08506d-f53b-45ea-a5bc-12741718cb71"]
}, Open  ]],

Cell[CellGroupData[{

Cell["rules on flatspace limit", "Subsection",
 CellChangeTimes->{{3.912837379633031*^9, 3.9128373892138453`*^9}, {
  3.9278771403214755`*^9, 
  3.9278771433053217`*^9}},ExpressionUUID->"ca38edb1-5b68-4cca-a67e-\
015eca7c93ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"to4momentummod", "[", "pl_", "]"}], ":=", 
  RowBox[{"pl", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"x1_", ",", "x2_"}], "]"}], "2"], "\[Rule]", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], "+", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"k", "[", "x1", "]"}], "2"], "+", 
         RowBox[{"2", " ", 
          RowBox[{"k", "[", "x1", "]"}], " ", 
          RowBox[{"k", "[", "x2", "]"}]}], "+", 
         SuperscriptBox[
          RowBox[{"k", "[", "x2", "]"}], "2"]}], ")"}]}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"x1_", ",", "x2_"}], "]"}], "4"], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}], "+", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "x1", "]"}], "2"], "+", 
           RowBox[{"2", " ", 
            RowBox[{"k", "[", "x1", "]"}], " ", 
            RowBox[{"k", "[", "x2", "]"}]}], "+", 
           SuperscriptBox[
            RowBox[{"k", "[", "x2", "]"}], "2"]}], ")"}]}], ")"}], "2"]}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.9132725176461897`*^9, 3.913272544211648*^9}},
 CellLabel->
  "In[675]:=",ExpressionUUID->"491a3bb8-623e-4d85-8588-c02c8a706799"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"k", "[", "1", "]"}], "->", "k1"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "->", "s1"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], "->", "e1"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "2", "]"}], "->", "k2"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "2", "]"}], "->", "s2"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "2", "]"}], "->", "e2"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "3", "]"}], "->", "k3"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "3", "]"}], "->", "s3"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "3", "]"}], "->", "e3"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "4", "]"}], "->", "k4"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "4", "]"}], "->", "s4"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "4", "]"}], "->", "e4"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "5", "]"}], "->", "k5"}], ",", 
     RowBox[{
      RowBox[{"s", "[", "5", "]"}], "->", "s5"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "5", "]"}], "->", "e5"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[676]:=",ExpressionUUID->"8d64735a-9ef3-4278-9866-234ad9afd77f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rulesinv", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "->", 
      RowBox[{"k", "[", "1", "]"}]}], ",", 
     RowBox[{"s1", "->", 
      RowBox[{"s", "[", "1", "]"}]}], ",", 
     RowBox[{"e1", "->", 
      RowBox[{"e", "[", "1", "]"}]}], ",", 
     RowBox[{"k2", "->", 
      RowBox[{"k", "[", "2", "]"}]}], ",", 
     RowBox[{"s2", "->", 
      RowBox[{"s", "[", "2", "]"}]}], ",", 
     RowBox[{"e2", "->", 
      RowBox[{"e", "[", "2", "]"}]}], ",", 
     RowBox[{"k3", "->", 
      RowBox[{"k", "[", "3", "]"}]}], ",", 
     RowBox[{"s3", "->", 
      RowBox[{"s", "[", "3", "]"}]}], ",", 
     RowBox[{"e3", "->", 
      RowBox[{"e", "[", "3", "]"}]}], ",", 
     RowBox[{"k4", "->", 
      RowBox[{"k", "[", "4", "]"}]}], ",", 
     RowBox[{"s4", "->", 
      RowBox[{"s", "[", "4", "]"}]}], ",", 
     RowBox[{"e4", "->", 
      RowBox[{"e", "[", "4", "]"}]}], ",", 
     RowBox[{"k5", "->", 
      RowBox[{"k", "[", "5", "]"}]}], ",", 
     RowBox[{"s5", "->", 
      RowBox[{"s", "[", "5", "]"}]}], ",", 
     RowBox[{"e5", "->", 
      RowBox[{"e", "[", "5", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[677]:=",ExpressionUUID->"f00ce5fa-144c-449d-8f6a-d502559bf152"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ksij", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"externalLegs", "=", 
    RowBox[{"Range", "[", "5", "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"Assuming", " ", "5", " ", "external", " ", "legs"}], "*)"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "<", "j"}], ",", 
       RowBox[{"\"\<ks\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}]}], ",", "Nothing"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "externalLegs"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "externalLegs"}], "}"}]}], "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ksijTerms", "=", 
   RowBox[{
    RowBox[{"%", "//", 
     RowBox[{
      RowBox[{"DeleteCases", "[", 
       RowBox[{"#", ",", "Null"}], "]"}], "&"}]}], "//", "ToExpression"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kijrl", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "//", "ToString"}], "//", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], "//", 
         "ToExpression"}], "//", 
        RowBox[{
         RowBox[{"ks", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "&"}]}]}], "]"}], "&"}], 
    "/@", "ksijTerms"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.9128374241029835`*^9},
 CellLabel->
  "In[678]:=",ExpressionUUID->"b90b06e3-094b-45a9-a4dd-c440f3e2b2c6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ksij", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"externalLegs", "=", 
    RowBox[{"Range", "[", "5", "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"Assuming", " ", "5", " ", "external", " ", "legs"}], "*)"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "<", "j"}], ",", 
       RowBox[{"\"\<ks\>\"", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", 
        RowBox[{"ToString", "[", "j", "]"}]}], ",", "Nothing"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "externalLegs"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "externalLegs"}], "}"}]}], "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ksijTerms", "=", 
   RowBox[{
    RowBox[{"%", "//", 
     RowBox[{
      RowBox[{"DeleteCases", "[", 
       RowBox[{"#", ",", "Null"}], "]"}], "&"}]}], "//", "ToExpression"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kijrlinv", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "//", "ToString"}], "//", 
          RowBox[{
           RowBox[{"StringSplit", "[", 
            RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], "//", 
         "ToExpression"}], "//", 
        RowBox[{
         RowBox[{"ks", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "&"}]}], ",", "#"}], 
      "]"}], "&"}], "/@", "ksijTerms"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.912788407476832*^9, 3.9127884335317*^9}, {
  3.912837463754615*^9, 3.9128374647550697`*^9}},
 CellLabel->
  "In[683]:=",ExpressionUUID->"e6397fad-e084-4f77-80c4-66d374a55b1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshellgluon", "[", 
   RowBox[{"p_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "[", 
     RowBox[{"FreeQ", "[", 
      RowBox[{"p", ",", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"k", "[", "i", "]"}], ",", "2"}], "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"p", "/.", 
       RowBox[{
        RowBox[{"s", "[", "i", "]"}], "->", 
        RowBox[{
         RowBox[{"s", "[", "i", "]"}], "+", "1"}]}]}], ",", 
      RowBox[{"Onshellcy", "[", 
       RowBox[{
        RowBox[{"d", "-", "1"}], ",", 
        RowBox[{"k", "[", "i", "]"}], ",", "z1"}], "]"}]}], "]"}], ",", "p"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.9126989355409093`*^9, 3.9126989356511803`*^9}, {
  3.9126990125069475`*^9, 3.912699013226174*^9}},
 CellLabel->
  "In[688]:=",ExpressionUUID->"72553a81-3bd1-4dd5-b668-88e69bfd4055"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshelllistgluon", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"p", "//", 
       RowBox[{
        RowBox[{"scanK2sOnshellgluon", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
      RowBox[{
       RowBox[{"scanK2sOnshellgluon", "[", 
        RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "//", 
     RowBox[{
      RowBox[{"scanK2sOnshellgluon", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"scanK2sOnshellgluon", "[", 
      RowBox[{"#", ",", "4"}], "]"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"scanK2sOnshellgluon", "[", 
     RowBox[{"#", ",", "5"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.912699018173874*^9, 3.9126990285968485`*^9}},
 CellLabel->
  "In[689]:=",ExpressionUUID->"2098c7a4-1249-4f7d-ba69-3df59b883477"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshelllistmapgluon", "[", "p_", "]"}], ":=", 
  RowBox[{"p", "//", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"scanK2sOnshelllistgluon", ",", "#"}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.912699029755474*^9, 3.912699031562392*^9}},
 CellLabel->
  "In[690]:=",ExpressionUUID->"a8b0874a-daef-4aca-b4ca-87885cd3e3bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "i", "]"}], ",", 
           RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
       SuperscriptBox[
        RowBox[{"k", "[", "i", "]"}], "2"]}], ",", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "i_", "]"}], ",", 
         RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ksq", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "i", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}]}]}]}], "}"}]}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AdS4ptmy", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"%", "\[Equal]", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ksq", "[", 
          RowBox[{"1", ",", "3"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"1", ",", "4"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"2", ",", "4"}], "]"}], ",", 
         RowBox[{"ksq", "[", 
          RowBox[{"3", ",", "4"}], "]"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"ksq", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
      SuperscriptBox[
       RowBox[{"ks", "[", 
        RowBox[{"i", ",", "j"}], "]"}], "2"]}]}], "//", "Flatten"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9120714960782585`*^9, 3.9120714964194603`*^9}, {
   3.912697810853263*^9, 3.912697895041503*^9}, 3.91309763027353*^9},
 CellLabel->
  "In[691]:=",ExpressionUUID->"b84dc5fd-2111-4487-9a1a-300053ad5b66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToNoIndex", "[", "po_", "]"}], ":=", 
  RowBox[{
   RowBox[{"po", "//", 
    RowBox[{"ReplaceAll", "[", "rules", "]"}]}], "//", 
   RowBox[{"ReplaceAll", "[", "kijrlinv", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9131006172805443`*^9, 3.913100633957263*^9}},
 CellLabel->
  "In[693]:=",ExpressionUUID->"300a240c-23ea-407e-92e9-44fc46639d72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scToks", "[", "pl_", "]"}], ":=", 
  RowBox[{"pl", "/.", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "i_", "]"}], ",", 
      RowBox[{"k", "[", "j_", "]"}]}], "]"}], "->", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"ks", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"k", "[", "i", "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"k", "[", "j", "]"}], "2"]}], ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.9128579271878033`*^9, {3.9131040204371967`*^9, 3.913104028066124*^9}},
 CellLabel->
  "In[694]:=",ExpressionUUID->"3787e209-c88c-44c4-bd32-743a86b9d001"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "@", "S"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913048520554029*^9, 3.9130485509092216`*^9}},
 CellLabel->
  "In[695]:=",ExpressionUUID->"21fc8534-c453-4f65-94aa-cedd9db9be6f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i", "]"}], ",", 
          RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], "\[RuleDelayed]", "0"}]}], ")"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momconservationS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"%", "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "3", "]"}], ",", 
             RowBox[{"k", "[", "5", "]"}]}], "]"}], ",", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "4", "]"}]}], "]"}], ",", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "5", "]"}]}], "]"}], ",", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "2", "]"}], ",", 
             RowBox[{"k", "[", "4", "]"}]}], "]"}], ",", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "1", "]"}], ",", 
             RowBox[{"k", "[", "3", "]"}]}], "]"}]}], "}"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"k", "[", "1", "]"}], "->", "k1"}], ",", 
         RowBox[{
          RowBox[{"k", "[", "2", "]"}], "->", "k2"}], ",", 
         RowBox[{
          RowBox[{"k", "[", "3", "]"}], "->", "k3"}], ",", 
         RowBox[{
          RowBox[{"k", "[", "4", "]"}], "->", "k4"}], ",", 
         RowBox[{
          RowBox[{"k", "[", "5", "]"}], "->", "k5"}]}], "}"}]}], "/.", 
      "rulesinv"}], "//", "Flatten"}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"k", "[", "x_", "]"}], ",", 
        RowBox[{"k", "[", "y_", "]"}]}], "]"}], ":>", 
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"k", "[", "x", "]"}], ",", 
        RowBox[{"k", "[", "y", "]"}]}], "]"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9130483911386347`*^9, {3.913048440075839*^9, 3.913048516838315*^9}, {
   3.9130485681466827`*^9, 3.913048589951713*^9}, 3.913048620162613*^9, {
   3.9130487712354355`*^9, 3.9130487732031345`*^9}, 3.9131049093865557`*^9},
 CellLabel->
  "In[696]:=",ExpressionUUID->"524cafff-06bc-4429-b1da-614b69ce855b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myFunction", "[", "resope_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ress", ",", "resf", ",", "ressf"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ress", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"resope", "/.", " ", "AdS5ptmy"}], "/.", " ", 
                RowBox[{
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i_", "]"}], ",", 
                   RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.",
                " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"k", "[", "i_", "]"}], ",", 
                  RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"k", "[", "i", "]"}], "^", "2"}]}]}], "/.", " ", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "->", 
               RowBox[{
                RowBox[{"1", "/", "2"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ks", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "i", "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "j", "]"}], "^", "2"}]}], ")"}]}]}]}], "/.",
              " ", "kijrl"}], "/.", " ", "AdS5ptmy"}], "/.", " ", 
           RowBox[{
            RowBox[{"s", "[", "i_", "]"}], ":>", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z1", " ", 
               RowBox[{"k", "[", "i", "]"}]}], ")"}], "/", "2"}]}]}], "/.", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"k", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"kk", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", " ", 
         RowBox[{
          RowBox[{"k", "[", "3", "]"}], "->", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"k", "[", "1", "]"}]}], "-", 
           RowBox[{"k", "[", "2", "]"}], "-", 
           RowBox[{"k", "[", "5", "]"}], "-", 
           RowBox[{"k", "[", "4", "]"}]}]}]}], "/.", " ", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"D", ",", 
           RowBox[{"ks", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}]}], "]"}], "->", 
         RowBox[{
          RowBox[{"z1", "^", "2"}], " ", 
          RowBox[{"S", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resf", "=", 
       RowBox[{"ress", "//", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"z1", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], 
         "&"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ressf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"resf", "/.", " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.",
               " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"e", "[", "i", "]"}], ",", 
                    RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
             " ", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"kk", "[", "i_", "]"}], ",", 
                RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
            " ", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}], ":>", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", " ", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"kk", "[", "i_", "]"}], ",", 
              RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
          "Normal"}], "//", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"x1_", ",", "x2_"}], "]"}], "->", 
           RowBox[{
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], "^", "2"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"k", "[", "x1", "]"}], "^", "2"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"k", "[", "x1", "]"}], " ", 
               RowBox[{"k", "[", "x2", "]"}]}], "+", 
              RowBox[{
               RowBox[{"k", "[", "x2", "]"}], "^", "2"}]}], ")"}]}]}], 
          "]"}]}], "//", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"k", "[", "3", "]"}], "->", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "5", "]"}], "-", 
             RowBox[{"k", "[", "4", "]"}]}]}]}], "]"}], "&"}]}]}], ";", 
      RowBox[{"Return", "[", "ressf", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9130474291728506`*^9, 3.913047449466036*^9}, {
  3.9130479131508384`*^9, 3.9130479368870506`*^9}},
 CellLabel->
  "In[698]:=",ExpressionUUID->"1bbf3096-cb05-4596-b8f8-b41101fef78e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"YMAmpAdSToFlat", "[", "resope_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ress", ",", "resf", ",", "ressf"}], "}"}], ",", 
     RowBox[{
      RowBox[{"ress", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"resope", "/.", " ", "AdS5ptmy"}], "/.", " ", 
                RowBox[{
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i_", "]"}], ",", 
                   RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.",
                " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"k", "[", "i_", "]"}], ",", 
                  RowBox[{"k", "[", "i_", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"k", "[", "i", "]"}], "^", "2"}]}]}], "/.", " ", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"k", "[", "i_", "]"}], ",", 
                 RowBox[{"k", "[", "j_", "]"}]}], "]"}], "->", 
               RowBox[{
                RowBox[{"1", "/", "2"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ks", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "i", "]"}], "^", "2"}], "-", 
                  RowBox[{
                   RowBox[{"k", "[", "j", "]"}], "^", "2"}]}], ")"}]}]}]}], "/.",
              " ", "kijrl"}], "/.", " ", "AdS5ptmy"}], "/.", " ", 
           RowBox[{
            RowBox[{"s", "[", "i_", "]"}], ":>", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z1", " ", 
               RowBox[{"k", "[", "i", "]"}]}], ")"}], "/", "2"}]}]}], "/.", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"k", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"kk", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"k", "[", "j_", "]"}]}], "]"}], ":>", 
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i", "]"}], ",", 
               RowBox[{"kk", "[", "j", "]"}]}], "]"}]}]}], "}"}]}], "/.", " ", 
         RowBox[{
          RowBox[{"k", "[", "3", "]"}], "->", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"k", "[", "1", "]"}]}], "-", 
           RowBox[{"k", "[", "2", "]"}], "-", 
           RowBox[{"k", "[", "5", "]"}], "-", 
           RowBox[{"k", "[", "4", "]"}]}]}]}], "/.", " ", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"D", ",", 
           RowBox[{"ks", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}]}], "]"}], "->", 
         RowBox[{
          RowBox[{"z1", "^", "2"}], " ", 
          RowBox[{"S", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resf", "=", 
       RowBox[{"ress", "//", 
        RowBox[{
         RowBox[{"Series", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"z1", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], 
         "&"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ressf", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"resf", "/.", " ", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.",
               " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"e", "[", "i_", "]"}], ",", 
                  RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"sc", "[", 
                   RowBox[{
                    RowBox[{"e", "[", "i", "]"}], ",", 
                    RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
                 RowBox[{"sc", "[", 
                  RowBox[{
                   RowBox[{"e", "[", "i", "]"}], ",", 
                   RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
             " ", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"kk", "[", "i_", "]"}], ",", 
                RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
            " ", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"kk", "[", "3", "]"}]}], "]"}], ":>", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"sc", "[", 
                RowBox[{
                 RowBox[{"e", "[", "i", "]"}], ",", 
                 RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"e", "[", "i", "]"}], ",", 
                RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", " ", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"kk", "[", "i_", "]"}], ",", 
              RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
          "Normal"}], "//", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"x1_", ",", "x2_"}], "]"}], "->", 
           RowBox[{
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"x1", ",", "x2"}], "]"}], "^", "2"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"k", "[", "x1", "]"}], "^", "2"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"k", "[", "x1", "]"}], " ", 
               RowBox[{"k", "[", "x2", "]"}]}], "+", 
              RowBox[{
               RowBox[{"k", "[", "x2", "]"}], "^", "2"}]}], ")"}]}]}], 
          "]"}]}], "//", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"k", "[", "3", "]"}], "->", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"k", "[", "1", "]"}]}], "-", 
             RowBox[{"k", "[", "2", "]"}], "-", 
             RowBox[{"k", "[", "5", "]"}], "-", 
             RowBox[{"k", "[", "4", "]"}]}]}]}], "]"}], "&"}]}]}], ";", 
      RowBox[{"Return", "[", "ressf", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913105519083804*^9, 3.9131055313411026`*^9}},
 CellLabel->
  "In[699]:=",ExpressionUUID->"92f5140a-9784-447f-95a3-6a3324981632"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "@", "S"}], "=", 
   RowBox[{"{", "Orderless", "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[700]:=",ExpressionUUID->"f163b7e4-bca9-4adf-8479-619222ee897f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatSpaceMinimalEandK", "[", 
   RowBox[{"px_", ",", "kk_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"px", "/.", "\[VeryThinSpace]", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[Rule]", "0"}]}], "/.", 
      "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
     "\[VeryThinSpace]", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"kk", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", "0"}]}], "/.",
     "\[VeryThinSpace]", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"kk", "[", "3", "]"}]}], "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", 
   "\[VeryThinSpace]", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"kk", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", 
    "0"}]}]}]], "Input",
 CellLabel->
  "In[701]:=",ExpressionUUID->"5ce9dd49-68f9-44ac-bf65-c1bc1ea1d00c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlatSpaceMinimalEandK", "[", "px_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"px", "/.", " ", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}]}], "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"kk", "[", "1", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], ",", 
            RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "3", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], ",", 
           RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}], "}"}]}], "/.", " ", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"kk", "[", "i_", "]"}], ",", 
        RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", " ", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"kk", "[", "3", "]"}]}], "]"}], ":>", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "i", "]"}], ",", 
         RowBox[{"kk", "[", "2", "]"}]}], "]"}]}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "4", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "1", "]"}]}], "]"}], "-", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], ",", 
        RowBox[{"kk", "[", "5", "]"}]}], "]"}]}]}]}], "/.", " ", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"kk", "[", "i_", "]"}], ",", 
      RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.9130482583803577`*^9, 3.9130482679180984`*^9}},
 CellLabel->
  "In[702]:=",ExpressionUUID->"f44cab94-fbbd-4a54-80ab-9c6c7732ab34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"to3momentum", "[", "pw_", "]"}], ":=", 
  RowBox[{"pw", "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"x1_", ",", "x2_"}], "]"}], "->", 
     RowBox[{
      RowBox[{
       RowBox[{"ks", "[", 
        RowBox[{"x1", ",", "x2"}], "]"}], "^", "2"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "[", "x1", "]"}], "^", "2"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"k", "[", "x1", "]"}], " ", 
         RowBox[{"k", "[", "x2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"k", "[", "x2", "]"}], "^", "2"}]}], ")"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9130480811291227`*^9, 3.913048103676*^9}},
 CellLabel->
  "In[703]:=",ExpressionUUID->"9b149700-903d-490d-9faa-71204cd55f68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"to4momentum", "[", "pw_", "]"}], ":=", 
  RowBox[{"pw", "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ks", "[", 
       RowBox[{"x1_", ",", "x2_"}], "]"}], "^", "2"}], "->", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"x1", ",", "x2"}], "]"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "[", "x1", "]"}], "^", "2"}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"k", "[", "x1", "]"}], " ", 
         RowBox[{"k", "[", "x2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"k", "[", "x2", "]"}], "^", "2"}]}], ")"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9130481026735396`*^9, 3.913048120199679*^9}},
 CellLabel->
  "In[704]:=",ExpressionUUID->"86dc57ca-fe28-451f-9790-8295b1829a67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"flat5momcon", "[", "xP_", "]"}], ":=", 
  RowBox[{"xP", "//", 
   RowBox[{
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"#", ",", 
      RowBox[{
       RowBox[{"k", "[", "3", "]"}], "->", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"k", "[", "1", "]"}]}], "-", 
        RowBox[{"k", "[", "2", "]"}], "-", 
        RowBox[{"k", "[", "5", "]"}], "-", 
        RowBox[{"k", "[", "4", "]"}]}]}]}], "]"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.9130481688251333`*^9, 3.9130481773425493`*^9}},
 CellLabel->
  "In[705]:=",ExpressionUUID->"777afebc-b074-4dd4-9be1-8a1f4be3acfa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "i", "]"}], ",", 
          RowBox[{"k", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], "\[RuleDelayed]", "0"}]}], ")"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momconservation", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"%", "==", "0"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "[", "1", "]"}], "->", "k1"}], ",", 
      RowBox[{
       RowBox[{"k", "[", "2", "]"}], "->", "k2"}], ",", 
      RowBox[{
       RowBox[{"k", "[", "3", "]"}], "->", "k3"}], ",", 
      RowBox[{
       RowBox[{"k", "[", "4", "]"}], "->", "k4"}], ",", 
      RowBox[{
       RowBox[{"k", "[", "5", "]"}], "->", "k5"}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.897649075750183*^9, 3.897649100785101*^9}, {
  3.8976491629060144`*^9, 3.8976491868267603`*^9}, {3.899529089767548*^9, 
  3.8995290970877447`*^9}},
 CellLabel->
  "In[706]:=",ExpressionUUID->"99387fd1-a020-4c77-aa4b-8a55118fa5d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VYMijk", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "k3_", ",", "i_", ",", "j_", ",", "k_"}], 
   "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "i", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "k", "]"}]}], "]"}], "-", 
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "k", "]"}]}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "j", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "k", "]"}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], "-", 
       RowBox[{"sc", "[", 
        RowBox[{"k3", ",", 
         RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
       RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k3", ",", 
         RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "-", 
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}]}], ")"}]}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{3.8951271215313416`*^9},
 CellLabel->
  "In[708]:=",ExpressionUUID->"b325e4ec-ac1a-4917-858e-1240c66f8513"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{"k1", ",", "k2", ",", 
        RowBox[{"-", "k12"}], ",", "e1", ",", "e2", ",", "k"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"k12", ",", 
        RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{"k12", ",", "k3", ",", "k45", ",", "m", ",", "e3", ",", "n"}], 
       "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k12", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k1", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k2", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k45", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k4", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k5", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], "}"}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{
        RowBox[{"-", "k45"}], ",", "k4", ",", "k5", ",", "p", ",", "e4", ",", 
        "e5"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k12", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k1", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k2", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k45", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k4", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k5", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], "}"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contract", "[", 
    RowBox[{
     RowBox[{"%", " ", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "m", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "n", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "p", "]"}]}], "]"}]}], ",", "d"}], "]"}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YM5pt1", "=", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k5", ",", 
          RowBox[{"\[Mu]", "[", "e5", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k1", ",", 
          RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k2", ",", 
          RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k3", ",", 
          RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k4", ",", 
          RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], "->", "0"}]}], "}"}]}], 
    "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8942681950030203`*^9, 3.8942682035242105`*^9}, {
   3.8942682621632986`*^9, 3.894268263363967*^9}, {3.894268321452218*^9, 
   3.8942683290185423`*^9}, {3.894268367108331*^9, 3.8942683815841303`*^9}, {
   3.894268598034874*^9, 3.894268601467407*^9}, {3.894268643459319*^9, 
   3.8942686611708384`*^9}, {3.894268697603653*^9, 3.894268698799119*^9}, {
   3.894268791788171*^9, 3.894268836483612*^9}, {3.89426943032482*^9, 
   3.894269438195872*^9}, {3.894352715929925*^9, 3.894352723994129*^9}, {
   3.894352769994816*^9, 3.8943527763634305`*^9}, {3.8951274830585814`*^9, 
   3.8951274848980317`*^9}, {3.8965227464758186`*^9, 3.896522771864021*^9}, 
   3.897643950608121*^9, {3.8976447200058317`*^9, 3.897644720766872*^9}},
 CellLabel->
  "In[709]:=",ExpressionUUID->"5ce48526-3a1c-43d2-bc44-6701fa7197a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{"k1", ",", "k2", ",", 
        RowBox[{"-", "k12"}], ",", "e1", ",", "e2", ",", "k"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"k12", ",", 
        RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{"k1", ",", 
         RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
       RowBox[{"sc", "[", 
        RowBox[{"k2", ",", 
         RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e5", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e5", "]"}]}], "]"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"2", 
     RowBox[{"sc", "[", 
      RowBox[{"k4", ",", "k5"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contract", "[", 
   RowBox[{"%", ",", "d"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YM5pt2", "=", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k5", ",", 
          RowBox[{"\[Mu]", "[", "e5", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k1", ",", 
          RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k2", ",", 
          RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k3", ",", 
          RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k4", ",", 
          RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], "->", "0"}]}], "}"}]}], 
    "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8965228874533367`*^9, 3.8965230280003247`*^9}, 
   3.8965252463213215`*^9, 3.897643953555105*^9},
 CellLabel->
  "In[712]:=",ExpressionUUID->"31bdd68d-3a5e-41d4-b76e-43159dde469d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"VYMijk", "[", 
       RowBox[{
        RowBox[{"-", "k45"}], ",", "k4", ",", "k5", ",", "k", ",", "e4", ",", 
        "e5"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"-", "a_"}], ",", 
         RowBox[{"\[Mu]", "[", "b_", "]"}]}], "]"}], ":>", 
       RowBox[{"-", 
        RowBox[{"sc", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Mu]", "[", "b", "]"}]}], "]"}]}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k12", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k1", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k2", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k45", ",", 
          RowBox[{"\[Mu]", "[", "a_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k4", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}], "+", 
         RowBox[{"sc", "[", 
          RowBox[{"k5", ",", 
           RowBox[{"\[Mu]", "[", "a", "]"}]}], "]"}]}]}]}], "}"}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e2", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "k", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"\[Mu]", "[", "e3", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{"2", 
     RowBox[{"sc", "[", 
      RowBox[{"k1", ",", "k2"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contract", "[", 
   RowBox[{"%", ",", "d"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YM5pt3", "=", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k5", ",", 
          RowBox[{"\[Mu]", "[", "e5", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k1", ",", 
          RowBox[{"\[Mu]", "[", "e1", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k2", ",", 
          RowBox[{"\[Mu]", "[", "e2", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k3", ",", 
          RowBox[{"\[Mu]", "[", "e3", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"k4", ",", 
          RowBox[{"\[Mu]", "[", "e4", "]"}]}], "]"}], "->", "0"}]}], "}"}]}], 
    "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.896523076918626*^9, 3.8965230836875143`*^9}, {
   3.8965231450233345`*^9, 3.896523168194707*^9}, 3.896525248866237*^9, {
   3.8973851083314962`*^9, 3.897385110086599*^9}, 3.89764395611317*^9},
 CellLabel->
  "In[715]:=",ExpressionUUID->"e94eb2dc-4257-4c8b-890e-52669078fcd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n1", "=", 
   RowBox[{
    RowBox[{"YM5pt1", "-", " ", "YM5pt2", "-", " ", "YM5pt3"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.896523181723384*^9, 3.896523189521145*^9}, {
   3.8965259885096245`*^9, 3.896525989547948*^9}, {3.8973848084104424`*^9, 
   3.897384810326605*^9}, {3.897384975059145*^9, 3.8973849755225196`*^9}, 
   3.8973850137515106`*^9, 3.8976450207668424`*^9, {3.897645572656638*^9, 
   3.8976455739107265`*^9}},
 CellLabel->
  "In[718]:=",ExpressionUUID->"5e48b7d4-4589-4660-9f0d-c1655dccc846"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n1flat", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["n1", "8"], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k1", "\[Rule]", 
           RowBox[{"k", "[", "1", "]"}]}], ",", 
          RowBox[{"k2", "\[Rule]", 
           RowBox[{"k", "[", "2", "]"}]}], ",", 
          RowBox[{"k3", "\[Rule]", 
           RowBox[{"k", "[", "3", "]"}]}], ",", 
          RowBox[{"k4", "\[Rule]", 
           RowBox[{"k", "[", "4", "]"}]}], ",", 
          RowBox[{"k5", "\[Rule]", 
           RowBox[{"k", "[", "5", "]"}]}]}], "}"}]}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "i_", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"kk", "[", "i", "]"}], ",", "j"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"\[Mu]", "[", "i_", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"sc", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"e1", "\[Rule]", 
         RowBox[{"e", "[", "1", "]"}]}], ",", 
        RowBox[{"e2", "\[Rule]", 
         RowBox[{"e", "[", "2", "]"}]}], ",", 
        RowBox[{"e3", "\[Rule]", 
         RowBox[{"e", "[", "3", "]"}]}], ",", 
        RowBox[{"e4", "\[Rule]", 
         RowBox[{"e", "[", "4", "]"}]}], ",", 
        RowBox[{"e5", "\[Rule]", 
         RowBox[{"e", "[", "5", "]"}]}]}], "}"}]}], ")"}], "//", 
    "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9119255897296553`*^9, 3.911925598495942*^9}, {
   3.9119256640212317`*^9, 3.9119257144814157`*^9}, {3.911925907642861*^9, 
   3.911925908553707*^9}, 3.911927803375145*^9, 3.9119279046297874`*^9},
 CellLabel->
  "In[719]:=",ExpressionUUID->"5786be29-741f-4877-a1b3-f7b3ebe7b094"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "[", 
   RowBox[{
   "z_", ",", "k1_", ",", "k2_", ",", "k3_", ",", "e1_", ",", "e2_", ",", 
    "e3_"}], "]"}], ":=", 
  RowBox[{"z", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "e2"}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "k1"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"e2", ",", "e3"}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{"e1", ",", "k2"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"e3", ",", "e1"}], "]"}], 
      RowBox[{"sc", "[", 
       RowBox[{"e2", ",", "k3"}], "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.910437990362873*^9, 3.910438093332589*^9}, {
  3.9128370216946154`*^9, 3.9128370369771957`*^9}},
 CellLabel->
  "In[720]:=",ExpressionUUID->"67fa893f-85eb-41e4-b6c7-dcda94920057"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a3", "[", 
   RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
  RowBox[{"a", "[", 
   RowBox[{"z1", ",", 
    RowBox[{"k", "[", "x1", "]"}], ",", 
    RowBox[{"k", "[", "x2", "]"}], ",", 
    RowBox[{"k", "[", "x3", "]"}], ",", 
    RowBox[{"e", "[", "x1", "]"}], ",", 
    RowBox[{"e", "[", "x2", "]"}], ",", 
    RowBox[{"e", "[", "x3", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9128381300277576`*^9, 3.91283820790775*^9}, {
  3.912838239257586*^9, 3.9128382419112225`*^9}},
 CellLabel->
  "In[721]:=",ExpressionUUID->"8983568e-11e1-4412-b69d-912c6cb1ab1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M3", "[", 
   RowBox[{
   "k1_", ",", "k2_", ",", "k3_", ",", "z_", ",", "e1_", ",", "e2_", ",", 
    "e3_"}], "]"}], ":=", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"e1", ",", "e2"}], "]"}], 
        RowBox[{"sc", "[", 
         RowBox[{"e3", ",", "k1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"e2", ",", "e3"}], "]"}], 
        RowBox[{"sc", "[", 
         RowBox[{"e1", ",", "k2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{"e3", ",", "e1"}], "]"}], 
        RowBox[{"sc", "[", 
         RowBox[{"e2", ",", "k3"}], "]"}]}]}], ")"}]}], ")"}], 
   "2"]}]], "Input",
 CellLabel->
  "In[722]:=",ExpressionUUID->"0a21481f-d278-445f-b9dd-d91ead0af130"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DoubleIndex", "[", 
    RowBox[{"pxa_", ",", "i_", ",", "i1_", ",", "i2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"pxa", "/.", 
      RowBox[{
       RowBox[{"e", "[", "P", "]"}], "->", 
       RowBox[{"\[Mu]", "[", "i", "]"}]}]}], "//", "Expand"}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"a_", ",", 
           RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], 
         RowBox[{"sc", "[", 
          RowBox[{"b_", ",", 
           RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}]}], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"a", ",", 
           RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], 
         RowBox[{"sc", "[", 
          RowBox[{"b", ",", 
           RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}]}], ",", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"sc", "[", 
          RowBox[{"a_", ",", 
           RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], "2"], ":>", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"a", ",", 
           RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], 
         RowBox[{"sc", "[", 
          RowBox[{"a", ",", 
           RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}]}]}], "}"}], "]"}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.928045207958553*^9, 3.9280452116459866`*^9}},
 CellLabel->
  "In[723]:=",ExpressionUUID->"8505d36d-b74a-4260-9c98-7ccf4bb8973d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"projectionxc", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Pi]", "[", 
       RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"\[Mu]", "[", "i", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"k", ",", 
           RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], " ", 
         RowBox[{"sc", "[", 
          RowBox[{"k", ",", 
           RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}]}], 
        SuperscriptBox["k", "2"]]}]}], ",", 
     RowBox[{
      RowBox[{"\[Pi]2", "[", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "e_", ",", "k_"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"a", ",", "c", ",", "k"}], "]"}], " ", 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"b", ",", "e", ",", "k"}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"a", ",", "e", ",", "k"}], "]"}], " ", 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"b", ",", "c", ",", "k"}], "]"}]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"\[Pi]", "[", 
          RowBox[{"a", ",", "b", ",", "k"}], "]"}], " ", 
         RowBox[{"\[Pi]", "[", 
          RowBox[{"c", ",", "e", ",", "k"}], "]"}]}], 
        RowBox[{"d", "-", "1"}]]}]}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[724]:=",ExpressionUUID->"5c3335ad-9f3b-443a-99d5-b24689794993"],

Cell[BoxData[
 RowBox[{
  RowBox[{"scanK2sOnshelllist", "[", "p_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"scanK2sOnshell", "[", 
      RowBox[{"#1", ",", "h"}], "]"}], "&"}], ")"}], "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"scanK2sOnshell", "[", 
       RowBox[{"#1", ",", "5"}], "]"}], "&"}], ")"}], "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"scanK2sOnshell", "[", 
        RowBox[{"#1", ",", "4"}], "]"}], "&"}], ")"}], "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"scanK2sOnshell", "[", 
         RowBox[{"#1", ",", "1"}], "]"}], "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"scanK2sOnshell", "[", 
          RowBox[{"#1", ",", "3"}], "]"}], "&"}], ")"}], "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"scanK2sOnshell", "[", 
           RowBox[{"#1", ",", "2"}], "]"}], "&"}], ")"}], "[", "p", "]"}], 
       "]"}], "]"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9280474638415213`*^9, 3.9280474961155806`*^9}},
 CellLabel->
  "In[725]:=",ExpressionUUID->"bea723b1-b09b-4c48-9620-a4cccfb12674"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"projectionx", "=", 
  RowBox[{
   RowBox[{"\[Pi]", "[", 
    RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], "\[RuleDelayed]", 
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"\[Mu]", "[", "i", "]"}], ",", 
      RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{"k", ",", 
        RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], " ", 
      RowBox[{"sc", "[", 
       RowBox[{"k", ",", 
        RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}]}], 
     SuperscriptBox["k", "2"]]}]}]}]], "Input",
 CellLabel->
  "In[726]:=",ExpressionUUID->"815a62a0-c851-4a82-9526-2856940dd774"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Pi]", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], "\[RuleDelayed]", 
  RowBox[{
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"\[Mu]", "[", "i", "]"}], ",", 
     RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{"k", ",", 
       RowBox[{"\[Mu]", "[", "i", "]"}]}], "]"}], " ", 
     RowBox[{"sc", "[", 
      RowBox[{"k", ",", 
       RowBox[{"\[Mu]", "[", "j", "]"}]}], "]"}]}], 
    SuperscriptBox["k", "2"]]}]}]], "Output",
 CellChangeTimes->{{3.9302267220944023`*^9, 3.93022673230317*^9}},
 CellLabel->
  "Out[726]=",ExpressionUUID->"a2b3bd68-dae4-480d-9d4c-b1d34c4df267"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Bulk-to-bulk and Bulk-to-boundary propagator", "Chapter",
 CellChangeTimes->{{3.9278771540180035`*^9, 3.927877162866682*^9}, {
  3.930226267582823*^9, 
  3.9302262711676164`*^9}},ExpressionUUID->"129c6549-3059-4bef-b6f1-\
7f6bca7335d1"],

Cell["Bulk-to-boundary propagator", "Text",
 CellChangeTimes->{
  3.9302298177416973`*^9},ExpressionUUID->"7b5f8d26-7625-4a5c-b756-\
49bcba018a0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Btb", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["\[CapitalPhi]", "i_"], "[", "z_", "]"}], ":>", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Pi]", "/", "2"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]], 
       SuperscriptBox[
        RowBox[{"k", "[", "i", "]"}], 
        RowBox[{"del", "-", 
         RowBox[{"d", "/", "2"}]}]], 
       SuperscriptBox["z", 
        RowBox[{"d", "/", "2"}]], " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{
         RowBox[{"del", "-", 
          RowBox[{"d", "/", "2"}]}], ",", 
         RowBox[{
          RowBox[{"k", "[", "i", "]"}], " ", "z"}]}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["\[CapitalPhi]", "i_"], "\[Prime]",
        MultilineFunction->None], "[", "z_", "]"}], ":>", 
      RowBox[{
       FractionBox[
        RowBox[{"d", " ", 
         SuperscriptBox["z", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           FractionBox["d", "2"]}]], " ", 
         RowBox[{"BesselK", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["d", "2"]}], "+", "del"}], ",", 
           RowBox[{"z", " ", 
            RowBox[{"k", "[", "i", "]"}]}]}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"k", "[", "i", "]"}], 
          RowBox[{
           RowBox[{"-", 
            FractionBox["d", "2"]}], "+", "del"}]]}], 
        SqrtBox[
         RowBox[{"2", " ", "\[Pi]"}]]], "+", 
       RowBox[{
        FractionBox["1", 
         SqrtBox[
          RowBox[{"2", " ", "\[Pi]"}]]], 
        RowBox[{
         SuperscriptBox["z", 
          RowBox[{"d", "/", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"BesselK", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "-", 
               FractionBox["d", "2"], "+", "del"}], ",", 
              RowBox[{"z", " ", 
               RowBox[{"k", "[", "i", "]"}]}]}], "]"}]}], "-", 
           RowBox[{"BesselK", "[", 
            RowBox[{
             RowBox[{"1", "-", 
              FractionBox["d", "2"], "+", "del"}], ",", 
             RowBox[{"z", " ", 
              RowBox[{"k", "[", "i", "]"}]}]}], "]"}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"k", "[", "i", "]"}], 
          RowBox[{"1", "-", 
           FractionBox["d", "2"], "+", "del"}]]}]}]}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8876464224711685`*^9, 3.887646432780757*^9}, {
   3.8876464836273613`*^9, 3.887646489723686*^9}, {3.8876468156527634`*^9, 
   3.8876468786220655`*^9}, {3.887646999109448*^9, 3.887647091667658*^9}, {
   3.887647123531423*^9, 3.887647137501333*^9}, 3.887647347924878*^9, {
   3.89314667188579*^9, 3.893146690058014*^9}, {3.8931471886413064`*^9, 
   3.893147224720532*^9}, {3.9139215613100433`*^9, 3.9139215646598716`*^9}, {
   3.9139255810965*^9, 3.913925605888303*^9}, 3.927876578898176*^9},
 CellLabel->
  "In[727]:=",ExpressionUUID->"23335134-5fcd-42a4-b32a-d61cc1a0660d"],

Cell["\<\
Bulk-to-bulk propagator (A.3) in  https://arxiv.org/pdf/hep-th/9807097\
\>", "Text",
 CellChangeTimes->{{3.9302297270070763`*^9, 
  3.9302297466468844`*^9}},ExpressionUUID->"29a0e495-8a23-45af-ba6a-\
7779ded87552"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BtBcmyADS", "[", 
    RowBox[{"k_", ",", "z1_", ",", "z2_", ",", "p_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{" ", "p"}], 
     RowBox[{
      SuperscriptBox["k", "2"], "+", 
      SuperscriptBox["p", "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["z1", 
       RowBox[{"d", "/", "2"}]], " ", 
      RowBox[{"BesselJ", "[", 
       RowBox[{
        RowBox[{"del", "-", 
         RowBox[{"d", "/", "2"}]}], ",", 
        RowBox[{"p", " ", "z1"}]}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["z2", 
       RowBox[{"d", "/", "2"}]], " ", 
      RowBox[{"BesselJ", "[", 
       RowBox[{
        RowBox[{"del", "-", 
         RowBox[{"d", "/", "2"}]}], ",", 
        RowBox[{"p", " ", "z2"}]}], "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[728]:=",ExpressionUUID->"bfcf8bfc-3231-44dd-80ff-a854125e7a3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "YM: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         UnderscriptBox["lim", 
          RowBox[{
            SubscriptBox[
             StyleBox["k", "TI"], 
             StyleBox["s", "TI"]], "\[Rule]", "0"}], LimitsPositioning -> 
          True], 
         SubsuperscriptBox[
          StyleBox["A", "TI"], 
          RowBox[{
            StyleBox["n", "TI"], "+", "1"}], 
          StyleBox["YM", FontSlant -> "Plain"]], "\[LongEqual]", "-", 
         FractionBox[
          RowBox[{
            StyleBox["z", "TI"], 
            SubscriptBox["\[Epsilon]", 
             StyleBox["s", "TI"]], "\[CenterDot]", 
            SubscriptBox[
             StyleBox["k", "TI"], 
             StyleBox["h", "TI"]], 
            SubsuperscriptBox[
             StyleBox["A", "TI"], 
             StyleBox["n", "TI"], 
             StyleBox["YM", FontSlant -> "Plain"]]}], 
          SubsuperscriptBox[
           StyleBox["D", "TI"], 
           SubscriptBox[
            StyleBox["k", "TI"], 
            StyleBox["h", "TI"]], 
           RowBox[{
             StyleBox["d", "TI"], "-", "1"}]]], "-", 
         SubscriptBox["\[Epsilon]", 
          StyleBox["s", "TI"]], "\[CenterDot]", 
         SubscriptBox["\[Epsilon]", 
          StyleBox["h", "TI"]], 
         FractionBox[
          RowBox[{
            SubscriptBox[
             StyleBox["k", "TI"], 
             StyleBox["h", "TI"]], "\[CenterDot]", 
            SubscriptBox["\[PartialD]", 
             SubscriptBox["\[Epsilon]", 
              StyleBox["h", "TI"]]], 
            SubsuperscriptBox[
             StyleBox["A", "TI"], 
             StyleBox["n", "TI"], 
             StyleBox["YM", FontSlant -> "Plain"]]}], 
          RowBox[{"2", 
            StyleBox["z", "TI"], 
            SubsuperscriptBox[
             StyleBox["k", "TI"], 
             StyleBox["h", "TI"], "2"]}]], "+", "\[Ellipsis]"}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\lim _{k_s \\rightarrow 0} \\mathcal{A}_{n+1}^{\\mathrm{YM}}=-\\frac{z \
\\varepsilon_s \\cdot k_h \
\\mathcal{A}_n^{\\mathrm{YM}}}{\\mathcal{D}_{k_h}^{d-1}}-\\varepsilon_s \
\\cdot \\varepsilon_h \\frac{k_h \\cdot \\partial_{\\varepsilon_h} \
\\mathcal{A}_n^{\\mathrm{YM}}}{2 z k_h^2}+\\ldots", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fb2444f9-63ce-413e-8ac8-cbb5bfa73926"]
}], "Chapter",
 CellChangeTimes->{{3.9278765943620977`*^9, 3.927876594417042*^9}, {
  3.9280444035353947`*^9, 
  3.9280444076263046`*^9}},ExpressionUUID->"2df71d87-78f7-40c4-8d36-\
49e1b4278921"],

Cell[CellGroupData[{

Cell[TextData[{
 "Bootstrapping the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        SubsuperscriptBox[
         StyleBox["a", "TI"], 
         RowBox[{
           StyleBox["s", "TI"], "+", 
           StyleBox["h", "TI"]}], 
         StyleBox["YM", FontSlant -> "Plain"]], 
        SubsuperscriptBox[
         StyleBox["D", "TI"], 
         SubscriptBox[
          StyleBox["k", "TI"], 
          RowBox[{
            StyleBox["s", "TI"], "+", 
            StyleBox["h", "TI"]}]], 
         RowBox[{
           StyleBox["d", "TI"], "-", "1"}]]], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "\\frac{a_{s+h}^{\\mathrm{YM}}}{\\mathcal{D}_{k_{s+h}}^{d-1}}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c9e29059-8257-4c6b-bb59-9734c985323e"],
 " (Weinberg soft) term in AdS d+1 factorization"
}], "Section",
 CellChangeTimes->{{3.919010423689535*^9, 3.919010425889659*^9}, {
   3.919014026845199*^9, 3.9190140286300507`*^9}, 3.9278768847714663`*^9, 
   3.927877020138431*^9, {3.9280514617326546`*^9, 3.9280514710076303`*^9}, {
   3.928052688422746*^9, 3.928052691254626*^9}, {3.930229489038211*^9, 
   3.930229489038211*^9}, {3.9302304551874933`*^9, 3.930230462683335*^9}, {
   3.9302305159346647`*^9, 3.930230518661558*^9}, {3.9302305741716857`*^9, 
   3.9302305954417524`*^9}},ExpressionUUID->"6b4fb4f9-50f3-4f0e-a7eb-\
964058b9f529"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  SuperscriptBox[
   SubscriptBox["A", "\"\<n\>\""], "m"], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SubscriptBox["D", "ksh"]], "%", 
      RowBox[{"\[Pi]", "[", 
       RowBox[{"m", ",", "n", ",", "ksh"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a3", "[", 
          RowBox[{"P", ",", "h", ",", "s"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"e", "[", "P", "]"}], "->", 
          RowBox[{"\[Mu]", "[", "n", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"k", "[", "P", "]"}], "->", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"k", "[", "s", "]"}]}], "-", 
          RowBox[{"k", "[", "h", "]"}]}]}]}], ")"}]}], "/.", "projectionx"}], 
    "//", "getridofallplusminussc"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "From", " ", "factorization", " ", "and", " ", "sum", " ", "over", " ", 
    "intermediate", " ", "spin"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"contract", "[", 
              RowBox[{"%", ",", "d"}], "]"}], "/.", " ", 
             RowBox[{
              FractionBox["1", 
               SuperscriptBox["ksh", "2"]], "->", 
              SuperscriptBox[
               RowBox[{"ks", "[", 
                RowBox[{"s", ",", "h"}], "]"}], 
               RowBox[{"-", "2"}]]}]}], "//.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{"a_", ",", "ksh"}], "]"}], ":>", 
              RowBox[{
               RowBox[{"sc", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"k", "[", "s", "]"}]}], "]"}], "+", 
               RowBox[{"sc", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"k", "[", "h", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{
              RowBox[{"k", "[", "i_", "]"}], ",", 
              RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
          "Simplify"}], ")"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"ks", "[", 
             RowBox[{"s", ",", "x_"}], "]"}], "2"], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"k", "[", "x", "]"}], "2"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"ks", "[", 
             RowBox[{"s", ",", "x_"}], "]"}], 
            RowBox[{"-", "2"}]], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"k", "[", "x", "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"ks", "[", 
             RowBox[{"s", ",", "x_"}], "]"}], "4"], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"k", "[", "x", "]"}], "4"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"ks", "[", 
             RowBox[{"s", ",", "x_"}], "]"}], 
            RowBox[{"-", "4"}]], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"k", "[", "x", "]"}], 
            RowBox[{"-", "4"}]]}], ",", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "s", "]"}], ",", "x_"}], "]"}], "\[Rule]", 
           "0"}], ",", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "i_", "]"}], ",", 
             RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"k", "[", "i", "]"}], "2"]}]}], "}"}]}], "//", "scToks"}],
       "//", 
      RowBox[{"ReplaceAll", "[", "AdS4ptmy", "]"}]}], "//", 
     RowBox[{"ReplaceAll", "[", 
      RowBox[{
       RowBox[{"k", "[", "s", "]"}], "\[Rule]", "0"}], "]"}]}], "//", 
    "Simplify"}], "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"z1", "->", "z"}], ",", 
      RowBox[{"ksh", "->", 
       SubscriptBox["k", "h"]}]}], "}"}], "]"}]}], "//", 
  "ToDisplay"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Taking", " ", "soft", " ", "limit", " ", "for", " ", "the", " ", 
    "momentum", " ", "and", " ", "get", " ", "Weinberg", " ", "soft", " ", 
    "factor"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9190174879002347`*^9, 3.9190174893882775`*^9}, 
   3.9193669159030995`*^9, {3.919515214271206*^9, 3.9195152242119503`*^9}, {
   3.9278773181939416`*^9, 3.927877321274356*^9}, {3.9279512402096233`*^9, 
   3.9279512450320263`*^9}, {3.927951304272583*^9, 3.9279513275561914`*^9}, {
   3.927958623222395*^9, 3.927958658796525*^9}, {3.9279587049814873`*^9, 
   3.927958731504933*^9}, {3.9279587637333174`*^9, 3.9279587844265957`*^9}, {
   3.9280444653852077`*^9, 3.9280444698203793`*^9}, {3.9280445553629556`*^9, 
   3.928044586962829*^9}, {3.928044624373341*^9, 3.9280446284766016`*^9}, {
   3.928053191480693*^9, 3.9280531942311196`*^9}, 3.9302264006000566`*^9, {
   3.9302307017770443`*^9, 3.9302307391775904`*^9}, 3.930235045817855*^9, {
   3.9302351611792946`*^9, 3.930235168444379*^9}, {3.9302352082854705`*^9, 
   3.9302352092442636`*^9}, 3.930236728812466*^9, {3.9302372641799417`*^9, 
   3.9302372666771145`*^9}},ExpressionUUID->"5d8cbdb0-2c78-4eef-be55-\
5e6486179ecd"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"z", " ", 
    TemplateBox[{"\[Epsilon]", "h", "m"},
     "Subsuperscript"], " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["k", "h"], "\<\"\[CenterDot]\"\>", 
      SubscriptBox["\[Epsilon]", "s"]}], ")"}], " ", 
    SubsuperscriptBox["A", "\<\"n\"\>", "m"]}], 
   SubscriptBox["D", 
    SubscriptBox["k", "h"]]]}]], "Output",
 CellChangeTimes->{
  3.919366919858217*^9, {3.9195152206891823`*^9, 3.9195152244420605`*^9}, 
   3.9201201477368813`*^9, 3.9215887374015083`*^9, 3.9258265987946644`*^9, 
   3.927951297600358*^9, {3.927958659031912*^9, 3.927958731769562*^9}, {
   3.9279587649934826`*^9, 3.9279587846563563`*^9}, 3.92804441155545*^9, 
   3.9280444706705723`*^9, {3.92804453568483*^9, 3.9280445574555025`*^9}, {
   3.92804459239764*^9, 3.9280446296053295`*^9}, {3.9280531953881836`*^9, 
   3.9280531995018463`*^9}, 3.9280572852295012`*^9, 3.9280574067141647`*^9, 
   3.9302267349323225`*^9},
 CellLabel->
  "Out[731]=",ExpressionUUID->"44dc0e37-2387-4efd-8456-d52b0b608d45"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Bootstrapping the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        SubscriptBox[
         StyleBox["b", "TI"], 
         RowBox[{
           StyleBox["s", "TI"], "+", 
           StyleBox["h", "TI"]}]], 
        SubsuperscriptBox[
         StyleBox["k", "TI"], 
         RowBox[{
           StyleBox["s", "TI"], "+", 
           StyleBox["h", "TI"]}], "2"]], TraditionalForm], "errors" -> {}, 
     "input" -> "\\frac{b_{s+h}}{k_{s+h}^2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "db736d6f-027c-4e8f-8b68-f288609aadb8"],
 " term using vanishing of OPE limit before soft"
}], "Section",
 CellChangeTimes->{{3.919010431032588*^9, 3.9190104374544954`*^9}, {
   3.919014031303013*^9, 3.919014031770589*^9}, {3.9190173990437155`*^9, 
   3.9190174025841274`*^9}, {3.9280430785610247`*^9, 3.928043095790721*^9}, 
   3.928051524841919*^9, {3.9280526390021963`*^9, 
   3.928052681367172*^9}},ExpressionUUID->"4167a24b-5dfb-4805-a601-\
a0300a1c5e90"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  SuperscriptBox[
   SubscriptBox["A", "\"\<n\>\""], "m"], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SubscriptBox["D", "ksh"]], "%", " ", 
      RowBox[{"\[Pi]", "[", 
       RowBox[{"m", ",", "n", ",", "ksh"}], "]"}], "*", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a3", "[", 
          RowBox[{"P", ",", "h", ",", "s"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"e", "[", "P", "]"}], "->", 
          RowBox[{"\[Mu]", "[", "n", "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"k", "[", "P", "]"}], "->", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"k", "[", "s", "]"}]}], "-", 
          RowBox[{"k", "[", "h", "]"}]}]}]}], ")"}]}], "/.", "projectionx"}], 
    "//", "getridofallplusminussc"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"contract", "[", 
             RowBox[{"%", ",", "d"}], "]"}], "/.", " ", 
            RowBox[{
             FractionBox["1", 
              SuperscriptBox["ksh", "2"]], "->", 
             SuperscriptBox[
              RowBox[{"ks", "[", 
               RowBox[{"s", ",", "h"}], "]"}], 
              RowBox[{"-", "2"}]]}]}], "//.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"a_", ",", "ksh"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{"a", ",", 
                RowBox[{"k", "[", "s", "]"}]}], "]"}], "+", 
              RowBox[{"sc", "[", 
               RowBox[{"a", ",", 
                RowBox[{"k", "[", "h", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "i_", "]"}], ",", 
             RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//", 
         "Simplify"}], ")"}], "//", "nosckiki"}], "//", "scToks"}], "//", 
     RowBox[{"ReplaceAll", "[", "AdS4ptmy", "]"}]}], "//", "Simplify"}], 
   ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "First", " ", "construct", " ", "the", " ", "factorization", " ", "term", 
    " ", 
    StyleBox["before",
     FontWeight->"Bold"], " ", "soft", " ", "limit"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "//", 
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ks", "[", 
           RowBox[{"s", ",", "h"}], "]"}], ",", "0", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}], "&"}]}], "//", "Normal"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Taking", " ", "OPE", " ", "pole"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{
      SubscriptBox["D", "ksh"], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"d", "-", "1"}], ",", 
          RowBox[{"s", "[", 
           RowBox[{"soft", ",", "hard"}], "]"}]}], "]"}], "/.", "OPELimits"}],
        "}"}]}]}], "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Get", " ", "the", " ", "OPE", " ", "limit", " ", "for", " ", "the", " ", 
    "propagator"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"%", "/.", 
         RowBox[{"Onshellc", "[", 
          RowBox[{
           RowBox[{"d", "-", "1"}], ",", 
           RowBox[{"k", "[", "s", "]"}], ",", "z1"}], "]"}]}], "/.", 
        RowBox[{"Onshellc", "[", 
         RowBox[{
          RowBox[{"d", "-", "1"}], ",", 
          RowBox[{"k", "[", "h", "]"}], ",", "z1"}], "]"}]}], "/.", 
       RowBox[{
        RowBox[{"s", "[", 
         RowBox[{"soft", ",", "hard"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"soft", ",", "hard"}], "]"}], "+", "1"}]}]}], "/.", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"soft", ",", "hard"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"s", "[", "soft", "]"}], "+", 
        RowBox[{"s", "[", "hard", "]"}]}]}]}], "/.", 
     RowBox[{
      RowBox[{"s", "[", "hard", "]"}], "->", 
      RowBox[{"s", "[", "h", "]"}]}]}], "//", "Simplify"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Taking", " ", "the", " ", "onshell", " ", "limit", " ", "and", " ", 
    "shift", " ", "the", " ", "Mellin", " ", "variable"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "s", "]"}], ",", 
          RowBox[{"\[Mu]", "[", "m", "]"}]}], "]"}], "->", "0"}]}], "/.", 
      RowBox[{
       RowBox[{"s", "[", "s", "]"}], "->", 
       RowBox[{"s", "[", "soft", "]"}]}]}], "//", 
     RowBox[{
      RowBox[{"whatis", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "soft", "]"}], ",", 
        RowBox[{"d", "-", "1"}]}], "]"}], "&"}]}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"z1", "->", "z"}], ",", 
       RowBox[{"ksh", "->", 
        SubscriptBox["k", "h"]}], ",", 
       RowBox[{
        RowBox[{"ks", "[", 
         RowBox[{"h", ",", "s"}], "]"}], "->", 
        SubscriptBox["k", "h"]}]}], "}"}], "]"}]}], "//", "Simplify"}], "//", 
  "ToDisplay"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Taking", " ", "soft", " ", "limit", " ", "for", " ", "the", " ", 
     "momentum", " ", "and", " ", "also", " ", "Mellin", " ", "variable"}], 
    ",", " ", 
    RowBox[{
    "which", " ", "finally", " ", "gives", " ", "us", " ", "the", " ", 
     "subleading", " ", "AdS", " ", "correction", " ", "to", " ", "class", 
     " ", "I", " ", "soft", " ", "theorem"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.919010526325297*^9, 3.9190105556496716`*^9}, {
   3.9190106543227806`*^9, 3.9190106844064565`*^9}, {3.919010717629105*^9, 
   3.9190108740297813`*^9}, {3.9190109147583957`*^9, 
   3.9190109250111413`*^9}, {3.9190110938736677`*^9, 3.919011113983303*^9}, {
   3.919011150217963*^9, 3.9190111671339993`*^9}, {3.9190124155114636`*^9, 
   3.919012506339389*^9}, {3.919017414676053*^9, 3.9190174287525587`*^9}, {
   3.928043414662408*^9, 3.9280434169420257`*^9}, {3.9280434543170567`*^9, 
   3.9280435229532366`*^9}, {3.9280436015909433`*^9, 
   3.9280437169282107`*^9}, {3.928043751030281*^9, 3.928043851408018*^9}, {
   3.9280443692938433`*^9, 3.9280443750566463`*^9}, {3.9280444250620375`*^9, 
   3.928044454450413*^9}, {3.9280445522534175`*^9, 3.928044554040512*^9}, {
   3.9280445911226873`*^9, 3.928044612876083*^9}, {3.9280531419376287`*^9, 
   3.9280531454251423`*^9}, {3.9302307521183586`*^9, 
   3.9302307654724083`*^9}, {3.930230807426816*^9, 3.9302308221119776`*^9}, {
   3.930230942105054*^9, 3.9302309672555017`*^9}, {3.9302310563832717`*^9, 
   3.9302310740093236`*^9}, {3.9302311192401686`*^9, 
   3.9302312027746954`*^9}, {3.930231300684574*^9, 3.930231314002812*^9}, {
   3.9302354366202335`*^9, 3.930235445019733*^9}, {3.93023683621276*^9, 
   3.9302368855834656`*^9}, {3.9302372709571486`*^9, 3.930237277157143*^9}, 
   3.9302375423251266`*^9},ExpressionUUID->"fe4cce16-f108-4895-8716-\
526c86f0578f"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Epsilon]", "h"], "\<\"\[CenterDot]\"\>", 
      SubscriptBox["\[Epsilon]", "s"]}], ")"}], " ", 
    TemplateBox[{"k", "h", "m"},
     "Subsuperscript"], " ", 
    SubsuperscriptBox["A", "\<\"n\"\>", "m"]}], 
   RowBox[{"2", " ", "z", " ", 
    SubsuperscriptBox["k", "h", "2"]}]], "}"}]], "Output",
 CellChangeTimes->{{3.91901053329471*^9, 3.9190105559758368`*^9}, {
   3.91901068101109*^9, 3.9190106848155375`*^9}, {3.9190107180675125`*^9, 
   3.9190108399490557`*^9}, 3.9190108747136784`*^9, {3.919010916316618*^9, 
   3.919010925376105*^9}, {3.919011094735943*^9, 3.919011114793826*^9}, {
   3.9190111580907946`*^9, 3.919011167350706*^9}, {3.919012416235983*^9, 
   3.9190124673119173`*^9}, {3.9190125016038113`*^9, 3.91901250653613*^9}, {
   3.9190174108477097`*^9, 3.919017429018674*^9}, 3.9279586121888657`*^9, {
   3.92804368249789*^9, 3.928043708045679*^9}, {3.9280437524101076`*^9, 
   3.928043851727648*^9}, 3.928044412178383*^9, {3.928044444229476*^9, 
   3.928044454662554*^9}, {3.9280445340175395`*^9, 3.9280445588882875`*^9}, {
   3.9280445918468676`*^9, 3.9280446132597013`*^9}, 3.928053146165591*^9, 
   3.928053198000991*^9, 3.9280572878887925`*^9, 3.9280574091533957`*^9, 
   3.9302267373565836`*^9},
 CellLabel->
  "Out[738]=",ExpressionUUID->"805da088-e4e0-4ad8-9e49-7b305b20bb67"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "GR: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         UnderscriptBox["lim", 
          RowBox[{
            SubscriptBox[
             OverscriptBox[
              StyleBox["k", "TI"], "\[RightVector]"], 
             StyleBox["s", "TI"]], "\[Rule]", "0"}], LimitsPositioning -> 
          True], 
         SubsuperscriptBox[
          StyleBox["M", "TI"], 
          RowBox[{
            StyleBox["n", "TI"], "+", "1"}], 
          StyleBox["GR", FontSlant -> "Plain"]], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SuperscriptBox[
             StyleBox["z", "TI"], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
               RowBox[{
                 SubscriptBox["\[Epsilon]", 
                  StyleBox["s", "TI"]], "\[CenterDot]", 
                 SubscriptBox[
                  StyleBox["k", "TI"], 
                  StyleBox["h", "TI"]]}], ")"}], "2"], 
            SubsuperscriptBox[
             StyleBox["M", "TI"], 
             StyleBox["n", "TI"], 
             StyleBox["GR", FontSlant -> "Plain"]]}], 
          SubsuperscriptBox[
           StyleBox["D", "TI"], 
           SubscriptBox[
            StyleBox["k", "TI"], 
            StyleBox["h", "TI"]], 
           StyleBox["d", "TI"]]], "+", 
         FractionBox[
          RowBox[{
            SubscriptBox["\[Epsilon]", 
             StyleBox["s", "TI"]], "\[CenterDot]", 
            SubscriptBox["\[Epsilon]", 
             StyleBox["h", "TI"]], 
            SubscriptBox["\[Epsilon]", 
             StyleBox["s", "TI"]], "\[CenterDot]", 
            SubscriptBox[
             StyleBox["k", "TI"], 
             StyleBox["h", "TI"]], 
            SubsuperscriptBox["\[Epsilon]", 
             StyleBox["h", "TI"], 
             StyleBox["i", "TI"]], 
            SubsuperscriptBox[
             StyleBox["k", "TI"], 
             StyleBox["h", "TI"], 
             StyleBox["j", "TI"]], 
            SubsuperscriptBox[
             StyleBox["M", "TI"], 
             StyleBox["n", "TI"], 
             RowBox[{
               StyleBox["GR", FontSlant -> "Plain"], ",", 
               StyleBox["i", "TI"], 
               StyleBox["j", "TI"]}]]}], 
          SubsuperscriptBox[
           StyleBox["k", "TI"], 
           StyleBox["h", "TI"], "2"]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\lim _{\\vec{k}_s \\rightarrow 0} \
\\mathcal{M}_{n+1}^{\\mathrm{GR}}=\\frac{z^2\\left(\\varepsilon_s \\cdot \
k_h\\right)^2 \
\\mathcal{M}_{n}^{\\mathrm{GR}}}{\\mathcal{D}_{k_h}^d}+\\frac{\\varepsilon_s \
\\cdot \\varepsilon_h \\varepsilon_s \\cdot k_h \\varepsilon_h^i k_h^j \
\\mathcal{M}_n^{\\mathrm{GR}, i j}}{k_h^2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "e25911c6-ea1e-4aaa-a9cc-8d1baaf1f6a8"]
}], "Chapter",
 CellChangeTimes->{{3.928044645923086*^9, 3.9280446472661324`*^9}, 
   3.9280450280787396`*^9, {3.928045143552165*^9, 
   3.9280451449528885`*^9}},ExpressionUUID->"e0562894-37fc-4066-b6b8-\
17d24258a156"],

Cell[CellGroupData[{

Cell[TextData[{
 "Bootstrapping the  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        SubsuperscriptBox[
         StyleBox["a", "TI"], 
         RowBox[{
           StyleBox["s", "TI"], "+", 
           StyleBox["h", "TI"]}], 
         StyleBox["GR", FontSlant -> "Plain"]], 
        SubsuperscriptBox[
         StyleBox["D", "TI"], 
         SubscriptBox[
          StyleBox["k", "TI"], 
          RowBox[{
            StyleBox["s", "TI"], "+", 
            StyleBox["h", "TI"]}]], 
         StyleBox["d", "TI"]]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{a_{s+h}^{\\mathrm{GR}}}{\\mathcal{D}_{k_{s+h}}^d}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "561e7a1e-39ef-44a0-8e08-d2c45deaec64"],
 " term from factorization"
}], "Section",
 CellChangeTimes->{{3.919366934201336*^9, 3.919366944057777*^9}, 
   3.928044817182954*^9, {3.9280463537943354`*^9, 3.9280463589529953`*^9}, {
   3.928052696750372*^9, 
   3.9280527216549883`*^9}},ExpressionUUID->"babcfa38-6e34-45a8-b509-\
193e58d25582"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pt3GRnu45t1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"M3", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", "[", "h", "]"}], "+", 
            RowBox[{"k", "[", "s", "]"}]}], ")"}]}], ",", 
         RowBox[{"k", "[", "h", "]"}], ",", 
         RowBox[{"k", "[", "s", "]"}], ",", "z1", ",", 
         RowBox[{"e", "[", "P", "]"}], ",", 
         RowBox[{"e", "[", "h", "]"}], ",", 
         RowBox[{"e", "[", "s", "]"}]}], "]"}], "//", 
       "getridofallplusminussc"}], "//", "scToks"}], "//", "Expand"}], "//", 
    RowBox[{
     RowBox[{"DoubleIndex", "[", 
      RowBox[{"#", ",", "j", ",", "j1", ",", "j2"}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sawe1t", "=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SubscriptBox["D", "ksh"]], 
       SuperscriptBox[
        SubscriptBox["M", "n"], "\"\<i1,i2\>\""], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Pi]2", "[", 
            RowBox[{"i1", ",", "i2", ",", "j1", ",", "j2", ",", "ksh"}], 
            "]"}], " ", "//.", "projectionxc"}], "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{"a_", ",", 
              RowBox[{"ksh", "[", "b_", "]"}]}], "]"}], ":>", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"a", ",", 
               RowBox[{"k", "[", "s", "]"}]}], "]"}], "+", 
             RowBox[{"sc", "[", 
              RowBox[{"a", ",", 
               RowBox[{"k", "[", "h", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "i_", "]"}], ",", 
            RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], ")"}], 
       "  ", "*", "\[IndentingNewLine]", "pt3GRnu45t1"}], "//", "Expand"}], "//", 
     RowBox[{
      RowBox[{"contract", "[", 
       RowBox[{"#", ",", "d"}], "]"}], "&"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "From", " ", "factorization", " ", "and", " ", "sum", " ", "over", " ", 
    "intermediate", " ", "spin"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"sawe1t", "/.", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
              FractionBox["1", 
               SuperscriptBox["ksh", "2"]], "->", 
              SuperscriptBox[
               RowBox[{"ks", "[", 
                RowBox[{"s", ",", "h"}], "]"}], 
               RowBox[{"-", "2"}]]}], ",", 
             RowBox[{
              FractionBox["1", 
               SuperscriptBox["ksh", "4"]], "->", 
              SuperscriptBox[
               RowBox[{"ks", "[", 
                RowBox[{"s", ",", "h"}], "]"}], 
               RowBox[{"-", "4"}]]}]}], "}"}]}], "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"a_", ",", "ksh"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{"a", ",", 
                RowBox[{"k", "[", "s", "]"}]}], "]"}], "+", 
              RowBox[{"sc", "[", 
               RowBox[{"a", ",", 
                RowBox[{"k", "[", "h", "]"}]}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"a_", ",", "ksh"}], "]"}], ":>", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{"a", ",", 
                RowBox[{"k", "[", "s", "]"}]}], "]"}], "+", 
              RowBox[{"sc", "[", 
               RowBox[{"a", ",", 
                RowBox[{"k", "[", "h", "]"}]}], "]"}]}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "i_", "]"}], ",", 
            RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"ks", "[", 
             RowBox[{"s", ",", "x_"}], "]"}], "2"], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"k", "[", "x", "]"}], "2"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"ks", "[", 
             RowBox[{"s", ",", "x_"}], "]"}], 
            RowBox[{"-", "2"}]], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"k", "[", "x", "]"}], 
            RowBox[{"-", "2"}]]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"ks", "[", 
             RowBox[{"s", ",", "x_"}], "]"}], "4"], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"k", "[", "x", "]"}], "4"]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"ks", "[", 
             RowBox[{"s", ",", "x_"}], "]"}], 
            RowBox[{"-", "4"}]], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"k", "[", "x", "]"}], 
            RowBox[{"-", "4"}]]}], ",", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "s", "]"}], ",", "x_"}], "]"}], "\[Rule]", 
           "0"}], ",", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "i_", "]"}], ",", 
             RowBox[{"k", "[", "i_", "]"}]}], "]"}], "\[Rule]", 
           SuperscriptBox[
            RowBox[{"k", "[", "i", "]"}], "2"]}]}], "}"}]}], "//", "scToks"}],
       "//", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{
        RowBox[{"k", "[", "s", "]"}], "\[Rule]", "0"}], "]"}]}], "//", 
     "Simplify"}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}], ",", 
       RowBox[{"z1", "->", "z"}]}], "}"}], "]"}]}], "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     SubscriptBox["D", "ksh"], "->", 
     SubscriptBox["D", "kh"]}], "]"}]}], "//", 
  "ToDisplay"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Taking", " ", "soft", " ", "limit", " ", "for", " ", "the", " ", 
    "momentum", " ", "and", " ", "get", " ", "Weinberg", " ", "soft", " ", 
    "factor"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9193670058783636`*^9, 3.9193670107606907`*^9}, {
   3.919367191743389*^9, 3.91936719258192*^9}, {3.928045483199898*^9, 
   3.9280455004892526`*^9}, {3.9280455427696466`*^9, 
   3.9280456018584967`*^9}, {3.9280456814367914`*^9, 3.928045682022704*^9}, {
   3.928046013575223*^9, 3.928046075269088*^9}, {3.9280461318921647`*^9, 
   3.9280461491971445`*^9}, {3.9302349681821756`*^9, 
   3.9302349814372234`*^9}, {3.9302350185672455`*^9, 3.9302350347600374`*^9}, 
   3.9302353149803333`*^9, {3.930235943332799*^9, 3.930235944427908*^9}, {
   3.9302366743880796`*^9, 3.9302366809482546`*^9}, {3.9302399136483173`*^9, 
   3.9302399182092648`*^9}},ExpressionUUID->"ca605dae-39e1-4977-90a8-\
cc80dd488e7f"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["z", "2"], " ", 
   TemplateBox[{"\[Epsilon]", "h", "i1"},
    "Subsuperscript"], " ", 
   TemplateBox[{"\[Epsilon]", "h", "i2"},
    "Subsuperscript"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["k", "h"], "\<\"\[CenterDot]\"\>", 
      SubscriptBox["\[Epsilon]", "s"]}], ")"}], "2"], " ", 
   SubsuperscriptBox["M", "n", "\<\"i1,i2\"\>"]}], 
  SubscriptBox["D", "kh"]]], "Output",
 CellChangeTimes->{
  3.9280456847008085`*^9, {3.9280460558776608`*^9, 3.928046075548665*^9}, 
   3.9280461499181128`*^9, 3.9280532089054613`*^9, 3.9280572882472696`*^9, 
   3.9280574094064054`*^9, 3.930226744475236*^9},
 CellLabel->
  "Out[741]=",ExpressionUUID->"1ea1a307-c005-4f13-aca4-ff4e05332e55"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Bootstrapping ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          SubsuperscriptBox[
           StyleBox["b", "TI"], 
           RowBox[{
             StyleBox["s", "TI"], "+", 
             StyleBox["h", "TI"]}], 
           RowBox[{"(", "1", ")"}]], 
          SubsuperscriptBox[
           StyleBox["k", "TI"], 
           RowBox[{
             StyleBox["s", "TI"], "+", 
             StyleBox["h", "TI"]}], "2"]], "+", 
         FractionBox[
          SubsuperscriptBox[
           StyleBox["b", "TI"], 
           RowBox[{
             StyleBox["s", "TI"], "+", 
             StyleBox["h", "TI"]}], 
           RowBox[{"(", "2", ")"}]], 
          SubsuperscriptBox[
           StyleBox["k", "TI"], 
           RowBox[{
             StyleBox["s", "TI"], "+", 
             StyleBox["h", "TI"]}], "4"]]}], TraditionalForm], "errors" -> {},
      "input" -> 
     "\\frac{b_{s+h}^{(1)}}{k_{s+h}^2}+\\frac{b_{s+h}^{(2)}}{k_{s+h}^4}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6d295031-8c50-4633-9d82-b3e8948e2a0a"],
 "   using vanishing of OPE limit before soft and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["c", "TI"], 
        RowBox[{
          StyleBox["A", "TI"], 
          StyleBox["Z", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "c^{A Z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "771e858b-6e37-4821-83b7-69863dc1b788"],
 " from Adler zero"
}], "Section",
 CellChangeTimes->{{3.9280463368908253`*^9, 3.9280463718748283`*^9}, {
  3.9280527596121917`*^9, 3.9280527906186066`*^9}, {3.9280528270593395`*^9, 
  3.9280528270652575`*^9}, {3.9280534877354136`*^9, 
  3.9280534877354136`*^9}},ExpressionUUID->"3fcd3f5f-f17d-4399-8fce-\
b21390fc02bd"],

Cell[CellGroupData[{

Cell["repeating the factorization ", "Subsection",
 CellChangeTimes->{{3.9280528903928833`*^9, 
  3.9280528942797003`*^9}},ExpressionUUID->"7256629e-5c28-4ba1-b573-\
d05d4186ca92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pt4GR123mut1", "=", 
   SuperscriptBox[
    SubscriptBox["M", "n"], "\"\<i1,i2\>\""]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt3GRnu45t1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"M3", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", "[", "h", "]"}], "+", 
            RowBox[{"k", "[", "s", "]"}]}], ")"}]}], ",", 
         RowBox[{"k", "[", "h", "]"}], ",", 
         RowBox[{"k", "[", "s", "]"}], ",", "z1", ",", 
         RowBox[{"e", "[", "P", "]"}], ",", 
         RowBox[{"e", "[", "h", "]"}], ",", 
         RowBox[{"e", "[", "s", "]"}]}], "]"}], "//", 
       "getridofallplusminussc"}], "//", "scToks"}], "//", "Expand"}], "//", 
    RowBox[{
     RowBox[{"DoubleIndex", "[", 
      RowBox[{"#", ",", "j", ",", "j1", ",", "j2"}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FactorizationContribution", "=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pt4GR123mut1", "*", "\[IndentingNewLine]", 
      FractionBox["1", 
       SubscriptBox["D", "ksh"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Pi]2", "[", 
           RowBox[{"i1", ",", "i2", ",", "j1", ",", "j2", ",", "ksh"}], "]"}],
           " ", "//.", "projectionxc"}], "//.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{"a_", ",", 
             RowBox[{"ksh", "[", "b_", "]"}]}], "]"}], ":>", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{"a", ",", 
              RowBox[{"k", "[", "s", "]"}]}], "]"}], "+", 
            RowBox[{"sc", "[", 
             RowBox[{"a", ",", 
              RowBox[{"k", "[", "h", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "i_", "]"}], ",", 
           RowBox[{"e", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], ")"}], "  ",
       "*", "\[IndentingNewLine]", "pt3GRnu45t1"}], "//", 
     RowBox[{
      RowBox[{"contract", "[", 
       RowBox[{"#", ",", "d"}], "]"}], "&"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "First", " ", "construct", " ", "the", " ", "factorization", " ", "term", 
    " ", "before", " ", "soft", " ", "limit"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9280465085165915`*^9, 3.9280465422831964`*^9}, {
   3.9280466036058736`*^9, 3.928046612840175*^9}, {3.928053237433131*^9, 
   3.928053241260872*^9}, 3.930235328852507*^9},
 CellLabel->"",ExpressionUUID->"3da210fd-66e9-4139-ad10-46fe78a38c0d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["imposing the vanishing of OPE limit", "Subsection",
 CellChangeTimes->{{3.9280528983680735`*^9, 3.9280529023287563`*^9}, {
  3.928052991612401*^9, 
  3.928053000708662*^9}},ExpressionUUID->"bc594824-9bda-45b3-9457-\
4bc64b52bea2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FactorizationContribution", "/.", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["ksh", "2"]], "->", 
         SuperscriptBox[
          RowBox[{"ks", "[", 
           RowBox[{"s", ",", "h"}], "]"}], 
          RowBox[{"-", "2"}]]}], ",", 
        RowBox[{
         FractionBox["1", 
          SuperscriptBox["ksh", "4"]], "->", 
         SuperscriptBox[
          RowBox[{"ks", "[", 
           RowBox[{"s", ",", "h"}], "]"}], 
          RowBox[{"-", "4"}]]}]}], "}"}]}], "//", "nosckiki"}], "//", 
    "nok4e4"}], "//", "scToks"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Mkm4beforesoft2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"%", "/.", 
             RowBox[{
              SubscriptBox["D", "ksh"], "->", 
              SubscriptBox["D", 
               RowBox[{"ks", "[", 
                RowBox[{"s", ",", "h"}], "]"}]]}]}], "/.", 
            RowBox[{
             FractionBox["1", 
              SubscriptBox["D", 
               RowBox[{"ks", "[", 
                RowBox[{"i_", ",", "j_"}], "]"}]]], ":>", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"f", "[", 
                RowBox[{"d", ",", 
                 RowBox[{"s", "[", 
                  RowBox[{"i", ",", "j"}], "]"}]}], "]"}]], "-", 
              FractionBox[
               RowBox[{
                SuperscriptBox["z1", "2"], 
                SuperscriptBox[
                 RowBox[{"ks", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "2"]}], 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{"s", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "]"}], 
                RowBox[{"f", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{
                   RowBox[{"s", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", "1"}]}], "]"}]}]], 
              "+", 
              FractionBox[
               RowBox[{
                SuperscriptBox["z1", "4"], 
                SuperscriptBox[
                 RowBox[{"ks", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "4"]}], 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{"s", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}], "]"}], 
                RowBox[{"f", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{
                   RowBox[{"s", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", "1"}]}], "]"}], 
                RowBox[{"f", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{
                   RowBox[{"s", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", "2"}]}], "]"}]}]], 
              "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["z1", "6"], 
                 SuperscriptBox[
                  RowBox[{"ks", "[", 
                   RowBox[{"i", ",", "j"}], "]"}], "6"]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"f", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{"s", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], "]"}], 
                 RowBox[{"f", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", "1"}]}], "]"}], 
                 RowBox[{"f", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", "2"}]}], "]"}], 
                 RowBox[{"f", "[", 
                  RowBox[{"d", ",", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"i", ",", "j"}], "]"}], "-", "3"}]}], "]"}]}], 
                ")"}]}]}]}]}], 
           RowBox[{"(*", 
            RowBox[{
            "Get", " ", "the", " ", "OPE", " ", "limit", " ", "for", " ", 
             "the", " ", "propagator", " ", "and", " ", "expand", " ", "in", 
             " ", "power", " ", "of", " ", "ks"}], "*)"}], "/.", 
           "OPELimits"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sc", "[", 
             RowBox[{"a_", ",", "ksh"}], "]"}], ":>", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{"a", ",", 
               RowBox[{"k", "[", "s", "]"}]}], "]"}], "+", 
             RowBox[{"sc", "[", 
              RowBox[{"a", ",", 
               RowBox[{"k", "[", "h", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"i_", ",", "j_"}], "]"}], "->", 
          RowBox[{
           RowBox[{"s", "[", "i", "]"}], "+", 
           RowBox[{"s", "[", "j", "]"}]}]}]}], "//", 
        "getridofallplusminussc"}], "//", "scToks"}], "//", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ks", "[", 
            RowBox[{"s", ",", "h"}], "]"}], ",", "0", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}], "&"}]}], "//", "Simplify"}], 
    "//", "noeiei"}], "//", "Normal", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Taking", " ", "OPE", " ", "pole", " ", "with", " ", "order"}], 
     " ", "-", 
     RowBox[{"4", " ", "and"}], " ", "-", 
     RowBox[{"2", " ", "before", " ", "soft", " ", "limit"}]}], 
    "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.9280467430810575`*^9, 3.9280467641896114`*^9}, {
   3.9280468323661427`*^9, 3.9280468333093834`*^9}, {3.928048242375821*^9, 
   3.9280482426553016`*^9}, {3.928048287573096*^9, 3.928048288901741*^9}, {
   3.9280483490634193`*^9, 3.928048350318527*^9}, 3.9280532449800706`*^9, 
   3.9302353921330037`*^9, 3.93023542409368*^9, 3.9302354610776143`*^9, {
   3.930236032326833*^9, 3.9302360507596684`*^9}, {3.930236126293535*^9, 
   3.930236145030053*^9}, {3.930237932646261*^9, 3.9302379375026407`*^9}, {
   3.9302380200162354`*^9, 3.930238050439273*^9}},
 CellLabel->"",ExpressionUUID->"5f5a4b72-b8ac-4d52-884d-b0bf6f73c0ad"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
    SuperscriptBox["z1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"k", "[", "h", "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"k", "[", "s", "]"}], "2"]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "h", "]"}], ",", 
       RowBox[{"e", "[", "s", "]"}]}], "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"k", "[", "h", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], "+", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"k", "[", "s", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"k", "[", "h", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], "+", 
      RowBox[{"sc", "[", 
       RowBox[{
        RowBox[{"k", "[", "s", "]"}], ",", 
        RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}], ")"}], " ", 
    SubsuperscriptBox["M", "n", "\<\"i1,i2\"\>"]}], 
   RowBox[{"8", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"ks", "[", 
      RowBox[{"h", ",", "s"}], "]"}], "4"], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "d", "-", 
      RowBox[{"2", " ", 
       RowBox[{"s", "[", "h", "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"s", "[", "s", "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"s", "[", "h", "]"}], "+", 
      RowBox[{"s", "[", "s", "]"}]}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["z1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "h", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "s", "]"}], "2"]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "h", "]"}], ",", 
          RowBox[{"e", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "h", "]"}], ",", 
          RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "s", "]"}], ",", 
          RowBox[{"k", "[", "h", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "h", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], "+", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "s", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "h", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "s", "]"}], "2"]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "h", "]"}], ",", 
          RowBox[{"e", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "h", "]"}], ",", 
          RowBox[{"k", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "s", "]"}], ",", 
          RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "h", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], "+", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "s", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "h", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "s", "]"}], "2"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "h", "]"}], ",", 
           RowBox[{"e", "[", "s", "]"}]}], "]"}], "2"], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "h", "]"}], ",", 
          RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "h", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], "+", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "s", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "h", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "s", "]"}], "2"]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "h", "]"}], ",", 
          RowBox[{"e", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "h", "]"}], ",", 
          RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "s", "]"}], ",", 
          RowBox[{"k", "[", "h", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "h", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], "+", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "s", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "h", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "s", "]"}], "2"]}], ")"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "h", "]"}], ",", 
          RowBox[{"e", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "h", "]"}], ",", 
          RowBox[{"k", "[", "s", "]"}]}], "]"}], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "s", "]"}], ",", 
          RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "h", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], "+", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "s", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"k", "[", "h", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"k", "[", "s", "]"}], "2"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"e", "[", "h", "]"}], ",", 
           RowBox[{"e", "[", "s", "]"}]}], "]"}], "2"], " ", 
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "h", "]"}], ",", 
          RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "h", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], "+", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "s", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}], ")"}]}], "+", 
       FractionBox[
        RowBox[{"8", " ", 
         SuperscriptBox[
          RowBox[{"k", "[", "h", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "h", "]"}], ",", 
            RowBox[{"e", "[", "s", "]"}]}], "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "h", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "s", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "h", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "s", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "h", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "s", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["z1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"k", "[", "h", "]"}], "2"]}], "-", 
           RowBox[{
            SuperscriptBox["z1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"k", "[", "s", "]"}], "2"]}], "-", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", "d", "-", 
              RowBox[{"2", " ", 
               RowBox[{"s", "[", "h", "]"}]}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"s", "[", "s", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              RowBox[{"s", "[", "h", "]"}], "+", 
              RowBox[{"s", "[", "s", "]"}]}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "h", "]"}], ",", 
            RowBox[{"e", "[", "s", "]"}]}], "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "h", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "s", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "h", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "s", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "+", "d", "-", 
           RowBox[{"2", " ", 
            RowBox[{"s", "[", "h", "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"s", "[", "s", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"s", "[", "h", "]"}], "+", 
           RowBox[{"s", "[", "s", "]"}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"k", "[", "h", "]"}], "2"], "-", 
           SuperscriptBox[
            RowBox[{"k", "[", "s", "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["z1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"k", "[", "h", "]"}], "2"]}], "-", 
           RowBox[{
            SuperscriptBox["z1", "2"], " ", 
            SuperscriptBox[
             RowBox[{"k", "[", "s", "]"}], "2"]}], "-", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", "d", "-", 
              RowBox[{"2", " ", 
               RowBox[{"s", "[", "h", "]"}]}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"s", "[", "s", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              RowBox[{"s", "[", "h", "]"}], "+", 
              RowBox[{"s", "[", "s", "]"}]}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "h", "]"}], ",", 
            RowBox[{"e", "[", "s", "]"}]}], "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "h", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "s", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "h", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], "+", 
           RowBox[{"sc", "[", 
            RowBox[{
             RowBox[{"k", "[", "s", "]"}], ",", 
             RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"4", "+", "d", "-", 
           RowBox[{"2", " ", 
            RowBox[{"s", "[", "h", "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"s", "[", "s", "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"s", "[", "h", "]"}], "+", 
           RowBox[{"s", "[", "s", "]"}]}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"k", "[", "h", "]"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{"k", "[", "s", "]"}], "2"]}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "h", "]"}], ",", 
            RowBox[{"e", "[", "s", "]"}]}], "]"}], "2"], " ", 
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"\[Mu]", "[", "i1", "]"}], ",", 
           RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}]]}], ")"}], " ", 
     SubsuperscriptBox["M", "n", "\<\"i1,i2\"\>"]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"ks", "[", 
       RowBox[{"h", ",", "s"}], "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "d", "-", 
       RowBox[{"2", " ", 
        RowBox[{"s", "[", "h", "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"s", "[", "s", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"s", "[", "h", "]"}], "+", 
       RowBox[{"s", "[", "s", "]"}]}], ")"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.928046817821312*^9, 3.928046839903811*^9}, 
   3.928048289861467*^9, 3.928048351933011*^9, {3.928053218477194*^9, 
   3.9280532468642683`*^9}, 3.9280572901593328`*^9, 3.9280574104696274`*^9, 
   3.9302267483707047`*^9},
 CellLabel->
  "Out[746]=",ExpressionUUID->"2821628b-62d2-416c-be12-f79deef18727"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Adler zero ", "Subsection",
 CellChangeTimes->{{3.92805331743785*^9, 
  3.9280533227817335`*^9}},ExpressionUUID->"68cbf67a-2a01-4c12-92d0-\
ea1c941bf6ba"],

Cell[CellGroupData[{

Cell["factorization term vanish", "Subsubsection",
 CellChangeTimes->{{3.928053326438135*^9, 
  3.928053330173109*^9}},ExpressionUUID->"c6dcd8c4-3353-4e2b-8572-\
b68315cedca3"],

Cell["\<\
make sure the the factorization (Weinberg soft) term doesn\[CloseCurlyQuote]t \
contribution to the Adler zero \
\>", "Text",
 CellChangeTimes->{{3.930236227325982*^9, 3.9302362287249784`*^9}, {
  3.930236269643053*^9, 
  3.9302362991083207`*^9}},ExpressionUUID->"ab9253f4-40c7-45f7-a7ef-\
02a4afb3fe2f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FactorizationContribution", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{"a_", ",", "ksh"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"sc", "[", 
           RowBox[{"a", ",", 
            RowBox[{"k", "[", "s", "]"}]}], "]"}], "+", 
          RowBox[{"sc", "[", 
           RowBox[{"a", ",", 
            RowBox[{"k", "[", "h", "]"}]}], "]"}]}]}], "}"}]}], "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "s", "]"}], ",", 
         RowBox[{"e", "[", "h", "]"}]}], "]"}], "->", "1"}]}], "//", 
     "noeiei"}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "s", "]"}], ",", "x_"}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "h", "]"}], ",", "y_"}], "]"}], "->", "0"}]}], 
      "}"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Taking", " ", "dimension", " ", "reductison", " ", "before", " ", "soft", 
    " ", "limit"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"%", "/.", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"k", "[", "s", "]"}], ",", "x_"}], "]"}], "->", 
                "0"}]}], "//", "Expand"}], "//", 
             RowBox[{
              RowBox[{"ReplaceAll", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"k", "[", "x_", "]"}], "4"], "->", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"k", "[", "x", "]"}], "2"], 
                    SuperscriptBox[
                    RowBox[{"kk", "[", "x", "]"}], "2"]}]}], ",", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"k", "[", "x_", "]"}], "6"], "->", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"k", "[", "x", "]"}], "2"], 
                    SuperscriptBox[
                    RowBox[{"kk", "[", "x", "]"}], "2"], 
                    SuperscriptBox[
                    RowBox[{"kkk", "[", "x", "]"}], "2"]}]}]}], "}"}]}], 
               "]"}], "&"}]}], "//", "scanK2sOnshelllistmap"}], "//", 
           RowBox[{
            RowBox[{"ReplaceAll", "[", 
             RowBox[{"#", ",", 
              RowBox[{"kk", "->", "k"}]}], "]"}], "&"}]}], "//", "Expand"}], "//",
          "scanK2sOnshelllistmap"}], "//", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{"kkk", "->", "k"}]}], "]"}], "&"}]}], "//", "Expand"}], "//",
       "scanK2sOnshelllistmap"}], "//", "getridofallplusminussc"}], "//", 
    "Simplify"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Then", " ", "we", " ", "take", " ", "the", " ", "soft", " ", "limit", 
     " ", "for", " ", 
     RowBox[{"k", "[", "s", "]"}]}], ",", " ", 
    RowBox[{
    "and", " ", "also", " ", "using", " ", "onshell", " ", "condition", " ", 
     "for", " ", "graviton", " ", "and", " ", "shift", " ", "the", " ", 
     "Mellin", " ", 
     RowBox[{"variables", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"k", "[", "s", "]"}], ",", "x_"}], "]"}], "->", "0"}]}], "/.", 
      RowBox[{
       RowBox[{"k", "[", "s", "]"}], "->", "0"}]}], "/.", 
     RowBox[{
      RowBox[{"ks", "[", 
       RowBox[{"x_", ",", "s"}], "]"}], "->", 
      RowBox[{"k", "[", "x", "]"}]}]}], "/.", 
    RowBox[{"ksh", "->", 
     RowBox[{"k", "[", "h", "]"}]}]}], "//", 
   RowBox[{
    RowBox[{"whatis", "[", 
     RowBox[{"#", ",", 
      RowBox[{"s", "[", "s", "]"}], ",", "d"}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"k", "[", "h", "]"}], ",", "Simplify"}], "]"}], "&"}], 
  RowBox[{"(*", 
   RowBox[{
   "There", " ", "is", " ", "no", " ", "contribution", " ", "for", " ", 
    "Weinberg", " ", "soft", " ", "term", " ", "in", " ", "soft", " ", 
    "limit", " ", "after", " ", "dimension", " ", "reductison"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9280532598174677`*^9, 3.9280533066865187`*^9}, {
  3.930238714535153*^9, 3.930238758054428*^9}, {3.9302388026227884`*^9, 
  3.930238882919406*^9}, {3.9302399837769566`*^9, 
  3.930239988377163*^9}},ExpressionUUID->"6fc78e36-871b-441d-a276-\
0aeaff6d5db8"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9280532622972126`*^9, 3.928053307190365*^9}, 
   3.9280572904379396`*^9, 3.9280574107380085`*^9, 3.9302267500998735`*^9, {
   3.930238799484909*^9, 3.9302388242740254`*^9}, 3.93023888487639*^9},
 CellLabel->
  "Out[788]=",ExpressionUUID->"12183d9a-f25e-457f-b3ca-1bd92ecb413b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["OPE term gives the trace of lower point amplitude", "Subsubsection",
 CellChangeTimes->{{3.9280533359952974`*^9, 
  3.9280533458211985`*^9}},ExpressionUUID->"7477c2a1-af8d-43e2-ae1f-\
280df8cf661d"],

Cell["\<\
One last thing before we take the soft limit: we have to ensure that our \
class I diagram satisfies Adler zero condition.\
\>", "Text",
 CellChangeTimes->{{3.930236227325982*^9, 3.9302362287249784`*^9}, {
   3.930236269643053*^9, 3.9302362991083207`*^9}, {3.9302365046674376`*^9, 
   3.9302365466116266`*^9}, {3.9302382390769725`*^9, 3.9302382763886833`*^9}, 
   3.930238923278227*^9},ExpressionUUID->"e3eb7354-59a5-4338-9ef1-\
a47df3942eca"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Mkm4beforesoft2", "/.", 
      RowBox[{
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "s", "]"}], ",", 
         RowBox[{"e", "[", "h", "]"}]}], "]"}], "->", "1"}]}], "//", 
     "noeiei"}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "s", "]"}], ",", "x_"}], "]"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "h", "]"}], ",", "y_"}], "]"}], "->", "0"}]}], 
      "}"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Taking", " ", "dimension", " ", "reductison", " ", "before", " ", "soft", 
    " ", "limit"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"%", "/.", 
               RowBox[{
                RowBox[{"sc", "[", 
                 RowBox[{
                  RowBox[{"k", "[", "s", "]"}], ",", "x_"}], "]"}], "->", 
                "0"}]}], "//", "Expand"}], "//", 
             RowBox[{
              RowBox[{"ReplaceAll", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"k", "[", "x_", "]"}], "4"], "->", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"k", "[", "x", "]"}], "2"], 
                    SuperscriptBox[
                    RowBox[{"kk", "[", "x", "]"}], "2"]}]}], ",", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"k", "[", "x_", "]"}], "6"], "->", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"k", "[", "x", "]"}], "2"], 
                    SuperscriptBox[
                    RowBox[{"kk", "[", "x", "]"}], "2"], 
                    SuperscriptBox[
                    RowBox[{"kkk", "[", "x", "]"}], "2"]}]}]}], "}"}]}], 
               "]"}], "&"}]}], "//", "scanK2sOnshelllistmap"}], "//", 
           RowBox[{
            RowBox[{"ReplaceAll", "[", 
             RowBox[{"#", ",", 
              RowBox[{"kk", "->", "k"}]}], "]"}], "&"}]}], "//", "Expand"}], "//",
          "scanK2sOnshelllistmap"}], "//", 
        RowBox[{
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"#", ",", 
           RowBox[{"kkk", "->", "k"}]}], "]"}], "&"}]}], "//", "Expand"}], "//",
       "scanK2sOnshelllistmap"}], "//", "getridofallplusminussc"}], "//", 
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Then", " ", "we", " ", "take", " ", "the", " ", "soft", " ", "limit", 
     " ", "for", " ", 
     RowBox[{"k", "[", "s", "]"}]}], ",", " ", 
    RowBox[{
    "and", " ", "also", " ", "use", " ", "onshell", " ", "condition", " ", 
     "for", " ", "graviton", " ", "and", " ", "shift", " ", "the", " ", 
     "Mellin", " ", 
     RowBox[{"variables", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"%", "/.", 
        RowBox[{
         RowBox[{"sc", "[", 
          RowBox[{
           RowBox[{"k", "[", "s", "]"}], ",", "x_"}], "]"}], "->", "0"}]}], "/.", 
       RowBox[{
        RowBox[{"k", "[", "s", "]"}], "->", "0"}]}], "/.", 
      RowBox[{
       RowBox[{"ks", "[", 
        RowBox[{"x_", ",", "s"}], "]"}], "->", 
       RowBox[{"k", "[", "x", "]"}]}]}], "//", 
     RowBox[{
      RowBox[{"whatis", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "s", "]"}], ",", "d"}], "]"}], "&"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"k", "[", "h", "]"}], ",", "Simplify"}], "]"}], "&"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Then", " ", "also", " ", "taking", " ", "soft", " ", "limit", " ", "for", 
    " ", "Mellin", " ", "variables"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"dimred", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"%", "//", 
      RowBox[{"Map", "[", "Simplify", "]"}]}], "//", "Expand"}], "//", 
    RowBox[{
     RowBox[{"sToK", "[", 
      RowBox[{"#", ",", "d"}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "the", " ", "term", " ", "we", " ", "have", " ", 
    "to", " ", "substract", " ", "to", " ", "get", " ", "the", " ", "class", 
    " ", "I", " ", "diagram", " ", "has", " ", "correct", " ", "Adler", " ", 
    "zero", " ", "condition"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.928046926516118*^9, 3.9280469448631554`*^9}, {
   3.928046980468586*^9, 3.9280470107429256`*^9}, {3.9280472450608497`*^9, 
   3.928047247405436*^9}, {3.9280477504590034`*^9, 3.928047831607812*^9}, {
   3.9280478687917795`*^9, 3.928047964478142*^9}, 3.928048021390526*^9, {
   3.9280480719739304`*^9, 3.928048106812521*^9}, {3.9280481559661818`*^9, 
   3.928048165673173*^9}, {3.92804831639462*^9, 3.9280483370299997`*^9}, 
   3.9280483857574573`*^9, {3.9302383383429785`*^9, 3.9302384060217485`*^9}, {
   3.9302385517029195`*^9, 3.9302385913016405`*^9}, {3.9302386649655724`*^9, 
   3.9302386679750767`*^9}, {3.930238703136118*^9, 3.9302387056875973`*^9}, {
   3.9302390244242325`*^9, 3.9302391271590796`*^9}, 
   3.930240005505143*^9},ExpressionUUID->"20ea7c92-9e59-45ac-a955-\
a469b6805ec0"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"sc", "[", 
    RowBox[{
     RowBox[{"\[Mu]", "[", "i1", "]"}], ",", 
     RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], " ", 
   SubsuperscriptBox["M", "n", "\<\"i1,i2\"\>"]}], 
  RowBox[{"4", "-", 
   RowBox[{"4", " ", "d"}]}]]], "Output",
 CellChangeTimes->{{3.9280468789013257`*^9, 3.928046894692014*^9}, 
   3.928046948642886*^9, {3.928047009205777*^9, 3.928047015337049*^9}, 
   3.928047584920743*^9, {3.928047765637203*^9, 3.928047777902603*^9}, {
   3.928047820809121*^9, 3.9280479272076664`*^9}, 3.928047960855979*^9, 
   3.9280479923025255`*^9, 3.928048043028015*^9, 3.9280481460463743`*^9, {
   3.9280483142285757`*^9, 3.928048317028325*^9}, {3.9280483677129726`*^9, 
   3.92804840846845*^9}, 3.928053222981166*^9, 3.928057364748134*^9, 
   3.928057413042751*^9, 3.930226753443803*^9, {3.930239054143792*^9, 
   3.9302390599686503`*^9}},
 CellLabel->
  "Out[796]=",ExpressionUUID->"bd5a9392-92be-4864-ba13-02ddbb9944da"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Total contributions  ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         FractionBox[
          SubsuperscriptBox[
           StyleBox["b", "TI"], 
           RowBox[{
             StyleBox["s", "TI"], "+", 
             StyleBox["h", "TI"]}], 
           RowBox[{"(", "1", ")"}]], 
          SubsuperscriptBox[
           StyleBox["k", "TI"], 
           RowBox[{
             StyleBox["s", "TI"], "+", 
             StyleBox["h", "TI"]}], "2"]], "+", 
         FractionBox[
          SubsuperscriptBox[
           StyleBox["b", "TI"], 
           RowBox[{
             StyleBox["s", "TI"], "+", 
             StyleBox["h", "TI"]}], 
           RowBox[{"(", "2", ")"}]], 
          SubsuperscriptBox[
           StyleBox["k", "TI"], 
           RowBox[{
             StyleBox["s", "TI"], "+", 
             StyleBox["h", "TI"]}], "4"]], "+", 
         SuperscriptBox[
          StyleBox["c", "TI"], 
          RowBox[{
            StyleBox["A", "TI"], 
            StyleBox["Z", "TI"]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "\\frac{b_{s+h}^{(1)}}{k_{s+h}^2}+\\frac{b_{s+h}^{(2)}}{k_{s+h}^4}+c^{A \
Z}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d89e5d22-7087-4e81-8870-99a5cd13d31e"],
 " (Now we start to take soft limits!)"
}], "Subsection",
 CellChangeTimes->{{3.9280534575920715`*^9, 3.9280534719402766`*^9}, {
  3.930239136303113*^9, 
  3.930239147982582*^9}},ExpressionUUID->"d492682c-42bd-484e-a571-\
d5b5741562ca"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mkm4beforesoft2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "//", 
             RowBox[{
              RowBox[{"Series", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ks", "[", 
                   RowBox[{"4", ",", "5"}], "]"}], ",", "0", ",", 
                  RowBox[{"-", "4"}]}], "}"}]}], "]"}], "&"}]}], "//", 
            "Normal"}], "//", "Expand"}], "//", 
          RowBox[{
           RowBox[{"ReplaceAll", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SuperscriptBox[
                 RowBox[{"k", "[", "x_", "]"}], "8"], "->", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"k", "[", "x", "]"}], "2"], 
                 SuperscriptBox[
                  RowBox[{"kk", "[", "x", "]"}], "2"], 
                 SuperscriptBox[
                  RowBox[{"kkk", "[", "x", "]"}], "2"], 
                 SuperscriptBox[
                  RowBox[{"kkkk", "[", "x", "]"}], "2"]}]}], ",", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"k", "[", "x_", "]"}], "6"], "->", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"k", "[", "x", "]"}], "2"], 
                 SuperscriptBox[
                  RowBox[{"kk", "[", "x", "]"}], "2"], 
                 SuperscriptBox[
                  RowBox[{"kkk", "[", "x", "]"}], "2"]}]}], ",", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"k", "[", "x_", "]"}], "4"], "->", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"k", "[", "x", "]"}], "2"], 
                 SuperscriptBox[
                  RowBox[{"kk", "[", "x", "]"}], "2"]}]}]}], "}"}]}], "]"}], 
           "&"}]}], "//", "Expand"}], "//", "scanK2sOnshelllistmap"}], "//", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{"kk", "->", "k"}], "]"}]}], "//", "Expand"}], "//", 
     "scanK2sOnshelllistmap"}], "//", 
    RowBox[{
     RowBox[{"whatis", "[", 
      RowBox[{"#", ",", 
       RowBox[{"s", "[", "s", "]"}], ",", "d"}], "]"}], "&"}]}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"opeFIRST", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"%", "/.", 
             RowBox[{
              RowBox[{"sc", "[", 
               RowBox[{
                RowBox[{"k", "[", "s", "]"}], ",", "x_"}], "]"}], "->", 
              "0"}]}], "/.", 
            RowBox[{
             RowBox[{"k", "[", "s", "]"}], "->", "0"}]}], "/.", 
           RowBox[{
            RowBox[{"ks", "[", 
             RowBox[{"x_", ",", "s"}], "]"}], "->", 
            RowBox[{"k", "[", "x", "]"}]}]}], "//", 
          RowBox[{
           RowBox[{"whatis", "[", 
            RowBox[{"#", ",", 
             RowBox[{"s", "[", "s", "]"}], ",", "d"}], "]"}], "&"}]}], "//", 
         "scToks"}], "//", 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{
          RowBox[{"k", "[", "s", "]"}], "\[Rule]", "0"}], "]"}]}], "//", 
       "Simplify"}], "//", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}], "]"}]}], ")"}],
     "/.", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"s", "[", "x_", "]"}], "2"], "\[Rule]", 
      RowBox[{
       FractionBox["1", "16"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["d", "2"], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["z1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"k", "[", "x", "]"}], "2"]}]}], ")"}]}]}], "}"}]}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"k", "[", "4", "]"}], ",", "Simplify"}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Soft", " ", "limit", " ", "of", " ", "contribution", " ", "of", " ", 
     "OPE", " ", "pole", " ", "order"}], " ", "-", "4"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.928048452898328*^9, 3.9280484605183363`*^9}, {
  3.928048490720182*^9, 3.9280484964867325`*^9}, {3.9280535290743837`*^9, 
  3.928053534361951*^9}, {3.930239160648039*^9, 
  3.9302391859836717`*^9}},ExpressionUUID->"d75430fa-0c71-4373-8e89-\
882d78943d83"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "h", "]"}], ",", 
       RowBox[{"e", "[", "s", "]"}]}], "]"}], "2"], " ", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "h", "]"}], ",", 
      RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], " ", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"k", "[", "h", "]"}], ",", 
      RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], " ", 
    SubsuperscriptBox["M", "n", "\<\"i1,i2\"\>"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"k", "[", "h", "]"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.9280484291756716`*^9, 3.9280484648365045`*^9, 
  3.92804849762891*^9, 3.928053551818782*^9, 3.928057413343955*^9, 
  3.930226755041241*^9},
 CellLabel->
  "Out[755]=",ExpressionUUID->"8e86bf19-0145-466e-b450-ac38ef05105b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mkm4beforesoft2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "//", "Normal"}], "//", 
            "Expand"}], "//", 
           RowBox[{
            RowBox[{"ReplaceAll", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"k", "[", "x_", "]"}], "8"], "->", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"k", "[", "x", "]"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"kk", "[", "x", "]"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"kkk", "[", "x", "]"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"kkkk", "[", "x", "]"}], "2"]}]}], ",", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"k", "[", "x_", "]"}], "6"], "->", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"k", "[", "x", "]"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"kk", "[", "x", "]"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"kkk", "[", "x", "]"}], "2"]}]}], ",", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"k", "[", "x_", "]"}], "4"], "->", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"k", "[", "x", "]"}], "2"], 
                  SuperscriptBox[
                   RowBox[{"kk", "[", "x", "]"}], "2"]}]}]}], "}"}]}], "]"}], 
            "&"}]}], "//", "Expand"}], "//", "scanK2sOnshelllistmap"}], "//", 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"kk", "->", "k"}], "]"}]}], "//", "Expand"}], "//", 
      "scanK2sOnshelllistmap"}], "//", 
     RowBox[{
      RowBox[{"whatis", "[", 
       RowBox[{"#", ",", 
        RowBox[{"s", "[", "s", "]"}], ",", "d"}], "]"}], "&"}]}], "//", 
    "FullSimplify"}], "//", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "i_", "]"}], ",", 
       RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"opeSECOND", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"%", "/.", 
                  RowBox[{
                   RowBox[{"sc", "[", 
                    RowBox[{
                    RowBox[{"k", "[", "s", "]"}], ",", "x_"}], "]"}], "->", 
                   "0"}]}], "/.", 
                 RowBox[{
                  RowBox[{"k", "[", "s", "]"}], "->", "0"}]}], "/.", 
                RowBox[{
                 RowBox[{"ks", "[", 
                  RowBox[{"x_", ",", "s"}], "]"}], "->", 
                 RowBox[{"k", "[", "x", "]"}]}]}], "//", 
               RowBox[{
                RowBox[{"whatis", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"s", "[", "s", "]"}], ",", "d"}], "]"}], "&"}]}], "//",
               "scToks"}], "//", 
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"k", "[", "s", "]"}], "\[Rule]", "0"}], "]"}]}], "//", 
            "Simplify"}], "//", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{
             RowBox[{"sc", "[", 
              RowBox[{
               RowBox[{"e", "[", "i_", "]"}], ",", 
               RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}], "]"}]}], 
          ")"}], "//", "scToks"}], "//", 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{
          RowBox[{"k", "[", "s", "]"}], "\[Rule]", "0"}], "]"}]}], "//", 
       "Simplify"}], "//", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "i_", "]"}], ",", 
          RowBox[{"e", "[", "i_", "]"}]}], "]"}], "->", "0"}], "]"}]}], "//", 
     "Simplify"}], "//", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"s", "[", "x_", "]"}], "2"], "\[Rule]", 
       RowBox[{
        FractionBox["1", "16"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["d", "2"], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["z1", "2"], " ", 
           SuperscriptBox[
            RowBox[{"k", "[", "x", "]"}], "2"]}]}], ")"}]}]}], "}"}], "]"}]}],
    "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"k", "[", "h", "]"}], ",", "Simplify"}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Soft", " ", "limit", " ", "of", " ", "contribution", " ", "of", " ", 
     "OPE", " ", "pole", " ", "order"}], " ", "-", "2"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9280487466320853`*^9, 3.9280487789665866`*^9}, {
  3.9280535445596557`*^9, 3.9280535499136505`*^9}, {3.930239191464363*^9, 
  3.9302391956957335`*^9}},ExpressionUUID->"a158b716-5ab9-4dd5-ba45-\
c7d773ab3f0d"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"e", "[", "h", "]"}], ",", 
      RowBox[{"e", "[", "s", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "h", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"e", "[", "s", "]"}], ",", 
         RowBox[{"k", "[", "h", "]"}]}], "]"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "h", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "h", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "s", "]"}], ",", 
            RowBox[{"k", "[", "h", "]"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"e", "[", "h", "]"}], ",", 
            RowBox[{"e", "[", "s", "]"}]}], "]"}], " ", 
          RowBox[{"sc", "[", 
           RowBox[{
            RowBox[{"k", "[", "h", "]"}], ",", 
            RowBox[{"\[Mu]", "[", "i1", "]"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"sc", "[", 
        RowBox[{
         RowBox[{"k", "[", "h", "]"}], ",", 
         RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}]}]}], ")"}], " ", 
    SubsuperscriptBox["M", "n", "\<\"i1,i2\"\>"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"k", "[", "h", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"sc", "[", 
      RowBox[{
       RowBox[{"e", "[", "h", "]"}], ",", 
       RowBox[{"e", "[", "s", "]"}]}], "]"}], "2"], " ", 
    RowBox[{"sc", "[", 
     RowBox[{
      RowBox[{"\[Mu]", "[", "i1", "]"}], ",", 
      RowBox[{"\[Mu]", "[", "i2", "]"}]}], "]"}], " ", 
    SubsuperscriptBox["M", "n", "\<\"i1,i2\"\>"]}], 
   RowBox[{"4", "-", 
    RowBox[{"4", " ", "d"}]}]]}]], "Output",
 CellChangeTimes->{3.928048780303461*^9, 3.9280535573816843`*^9, 
  3.928057419461617*^9, 3.9302267636510487`*^9},
 CellLabel->
  "Out[757]=",ExpressionUUID->"7234edcf-fc09-4e4f-8575-8005ee2dd4db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"opeFIRST", "+", "opeSECOND"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"s", "[", "x_", "]"}], "2"], "\[Rule]", 
      RowBox[{
       FractionBox["1", "16"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["d", "2"], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["z1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"k", "[", "x", "]"}], "2"]}]}], ")"}]}]}], "}"}]}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"k", "[", "h", "]"}], ",", "Simplify"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"bONEplusbTWOplusCAZ", "=", 
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"%", "-", 
      RowBox[{"dimred", " ", 
       SuperscriptBox[
        RowBox[{"sc", "[", 
         RowBox[{
          RowBox[{"e", "[", "s", "]"}], ",", 
          RowBox[{"e", "[", "h", "]"}]}], "]"}], "2"]}]}], "//", 
     "ToDisplay"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Substracting", " ", "out", " ", "the", " ", "term", " ", 
     "\"\<dimred\>\"", " ", "as", " ", "bootstrapped", " ", "originally", " ",
      "to", " ", "have", " ", "to", " ", "correct", " ", 
     RowBox[{"Adler", "'"}], "s", " ", "zero", " ", "condition"}], ",", " ", 
    RowBox[{
    "we", " ", "in", " ", "the", " ", "end", " ", "have", " ", "the", " ", 
     "AdS", " ", "correction", " ", "for", " ", "class", " ", "1", " ", 
     "graviton", " ", "soft", " ", "theorem"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.928048836830963*^9, 3.9280488591376033`*^9}, {
   3.92805141023464*^9, 3.9280514143963823`*^9}, {3.9280535555824785`*^9, 
   3.9280535570736823`*^9}, 3.9280571392231884`*^9, {3.930239210014835*^9, 
   3.9302392220714874`*^9}, {3.9302392818395915`*^9, 
   3.9302393427527795`*^9}, {3.930239384567919*^9, 
   3.930239413289242*^9}},ExpressionUUID->"4f2032de-683b-4a60-8037-\
0cab03363dd0"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Epsilon]", "h"], "\<\"\[CenterDot]\"\>", 
     SubscriptBox["\[Epsilon]", "s"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["k", "h"], "\<\"\[CenterDot]\"\>", 
     SubscriptBox["\[Epsilon]", "s"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{"\[Epsilon]", "h", "i2"},
       "Subsuperscript"], " ", 
      TemplateBox[{"k", "h", "i1"},
       "Subsuperscript"]}], "+", 
     RowBox[{
      TemplateBox[{"\[Epsilon]", "h", "i1"},
       "Subsuperscript"], " ", 
      TemplateBox[{"k", "h", "i2"},
       "Subsuperscript"]}]}], ")"}], " ", 
   SubsuperscriptBox["M", "n", "\<\"i1,i2\"\>"]}], 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"k", "[", "h", "]"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.9280488528286896`*^9, 3.9280488597673492`*^9}, 
   3.9280514146554813`*^9, 3.9280535612991533`*^9, 3.928057419818408*^9, 
   3.93022676384839*^9},
 CellLabel->
  "Out[759]=",ExpressionUUID->"95aaf270-690a-440d-a429-734666a28b5a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1428., 747.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7d4fa276-2c2d-46c9-85f6-000da4604e3b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 826, 16, 155, "Text",ExpressionUUID->"1bce962c-1a6d-4704-9c89-9b87b07f819e"],
Cell[CellGroupData[{
Cell[1409, 40, 212, 4, 62, "Chapter",ExpressionUUID->"850048d3-ce84-4e35-91fa-b4b9021efad7"],
Cell[CellGroupData[{
Cell[1646, 48, 160, 3, 59, "Section",ExpressionUUID->"6b0e9a96-1fb0-4668-9e15-a3d7d7ec8d64"],
Cell[CellGroupData[{
Cell[1831, 55, 226, 4, 48, "Subsection",ExpressionUUID->"3f2c54dd-aa65-46a6-9c60-4b65231d0484"],
Cell[2060, 61, 213, 4, 25, "Input",ExpressionUUID->"5864dca5-d9f9-4862-96a6-1fe33efa16bb"],
Cell[2276, 67, 793, 22, 27, "Input",ExpressionUUID->"ffa412a7-5344-4670-984b-43d6f5683f34"],
Cell[3072, 91, 19954, 553, 534, "Input",ExpressionUUID->"1d4120f4-cde8-4694-a1e6-4d94cf71753f"],
Cell[23029, 646, 389, 12, 26, "Input",ExpressionUUID->"efaea690-c9de-4fed-8768-fef19337c7b2"],
Cell[23421, 660, 785, 23, 41, "Input",ExpressionUUID->"09461c7d-5649-4504-9d0a-e84b3adaf203"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24243, 688, 168, 3, 48, "Subsection",ExpressionUUID->"81641fa0-280d-40ea-bbf8-421e905d9502"],
Cell[24414, 693, 9089, 272, 224, "Input",ExpressionUUID->"2062d7df-c65a-450b-af45-290cc4a7303c"],
Cell[CellGroupData[{
Cell[33528, 969, 5019, 147, 81, "Input",ExpressionUUID->"405273af-662c-4e26-b258-1098b466321e"],
Cell[38550, 1118, 1353, 28, 70, "Output",ExpressionUUID->"085498a4-22a2-4d35-9c4b-48b6677c651b"]
}, Open  ]],
Cell[39918, 1149, 1065, 29, 43, "Input",ExpressionUUID->"1165b411-161b-420b-981c-4cce743b43cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41020, 1183, 154, 3, 48, "Subsection",ExpressionUUID->"6232f008-78e0-4917-abf2-39d697740080"],
Cell[41177, 1188, 1212, 36, 27, "Input",ExpressionUUID->"6d388d04-8271-418b-9ecb-a00eca430acc"],
Cell[42392, 1226, 604, 19, 52, "Input",ExpressionUUID->"6bb63036-a6aa-4117-be47-1f5263d6b3a7"],
Cell[42999, 1247, 2741, 84, 65, "Input",ExpressionUUID->"06713275-1dc0-4e8d-a2a7-74ece3116a4a"],
Cell[45743, 1333, 366, 9, 26, "Input",ExpressionUUID->"4e0078b5-da5d-4cb4-b33f-ed9ad88ddcb8"],
Cell[46112, 1344, 436, 12, 26, "Input",ExpressionUUID->"2429ca2b-a2de-4163-b35c-5c8c22fcf87f"],
Cell[46551, 1358, 608, 12, 25, "Input",ExpressionUUID->"f4577528-9497-45a9-aed6-98eb8950a2fe"],
Cell[47162, 1372, 1478, 41, 56, "Input",ExpressionUUID->"2c0734d4-a21c-4689-a469-d8fc1628df0b"],
Cell[48643, 1415, 496, 14, 26, "Input",ExpressionUUID->"ac1da244-cf33-419e-a811-a97ec150abcb"],
Cell[49142, 1431, 1884, 59, 29, "Input",ExpressionUUID->"63e3c8b2-da4c-401b-9e62-d7ee40429c26"],
Cell[51029, 1492, 2157, 66, 29, "Input",ExpressionUUID->"8498928d-dd6d-4242-9997-cbaca93c09c6"],
Cell[53189, 1560, 2155, 66, 29, "Input",ExpressionUUID->"4142b55a-5089-4fa9-9ef8-a63912ee2561"],
Cell[55347, 1628, 2105, 65, 29, "Input",ExpressionUUID->"e6c222c4-1476-463d-b67d-11ca7ece3652"],
Cell[57455, 1695, 403, 11, 41, "Input",ExpressionUUID->"c42cdcfe-3c2d-4825-9a25-6243526af206"],
Cell[57861, 1708, 1277, 37, 25, "Input",ExpressionUUID->"c65cb7d6-5081-47d0-8d8b-f0ca6eacc153"],
Cell[59141, 1747, 1700, 50, 43, "Input",ExpressionUUID->"fcebd0a1-7a0f-4f53-9385-c9036ce09386"],
Cell[60844, 1799, 312, 7, 26, "Input",ExpressionUUID->"61a90691-aa70-436c-93f7-f413bd2fb937"],
Cell[61159, 1808, 2506, 72, 78, "Input",ExpressionUUID->"a00896fd-b3e8-4c00-a7da-473acf89523f"],
Cell[63668, 1882, 8752, 228, 181, "Input",ExpressionUUID->"560cbbac-cf8b-4cb9-9e03-f2f91f1ce0de"],
Cell[72423, 2112, 427, 11, 26, "Input",ExpressionUUID->"f1ddeda1-0745-4b96-90e5-e62b55c5b5bf"],
Cell[72853, 2125, 478, 12, 26, "Input",ExpressionUUID->"a85d1317-de05-419e-8ce9-03a606683da1"],
Cell[73334, 2139, 914, 26, 26, "Input",ExpressionUUID->"2839e788-e246-4a94-af95-5e6d876b914f"],
Cell[74251, 2167, 948, 27, 26, "Input",ExpressionUUID->"80ed2482-062a-4720-81e3-f2e2bafc2e4a"],
Cell[75202, 2196, 366, 9, 26, "Input",ExpressionUUID->"f092f1e1-c000-42b8-8f55-e37e9ec8a614"],
Cell[75571, 2207, 1408, 39, 25, "Input",ExpressionUUID->"062219e3-7924-4698-bc8a-d810266db85c"],
Cell[76982, 2248, 874, 24, 43, "Input",ExpressionUUID->"1d95a980-5a9b-4916-b895-5658ef3b427e"],
Cell[77859, 2274, 1566, 37, 43, "Input",ExpressionUUID->"6a9a7db8-f03f-405b-8c5b-c6c3d9470989"],
Cell[79428, 2313, 894, 28, 41, "Input",ExpressionUUID->"e99ab9fc-e454-4878-b9e7-8b42f58a3790"],
Cell[80325, 2343, 653, 20, 52, "Input",ExpressionUUID->"718c81a0-1ab5-43e7-94ed-bd80556b0321"],
Cell[80981, 2365, 775, 20, 26, "Input",ExpressionUUID->"212c3ba0-eb26-4f44-a89c-d400cf87ebfe"],
Cell[81759, 2387, 1188, 38, 75, "Input",ExpressionUUID->"06b838eb-2a0c-4ed0-b3c5-fe94f76a6550"],
Cell[82950, 2427, 790, 25, 41, "Input",ExpressionUUID->"0d1cb39e-2a32-433d-940f-5ef483a91207"],
Cell[83743, 2454, 843, 26, 41, "Input",ExpressionUUID->"43de5ca0-42ae-41ca-80d8-29e36fcc5ab7"],
Cell[84589, 2482, 708, 22, 25, "Input",ExpressionUUID->"376b4117-3bec-4dc4-8846-77b5a42841a1"],
Cell[85300, 2506, 1842, 51, 26, "Input",ExpressionUUID->"f2d967fa-40a3-47d6-a874-925e45eb2832"],
Cell[87145, 2559, 507, 13, 26, "Input",ExpressionUUID->"acdb6301-9d7a-4e31-aa79-e6f7b23826dc"],
Cell[87655, 2574, 1332, 41, 77, "Input",ExpressionUUID->"717100b0-8bbc-4e93-ba2e-a7650e165515"],
Cell[88990, 2617, 8401, 221, 309, "Input",ExpressionUUID->"098171d5-a4c4-40c6-a50a-752f2d515274"],
Cell[97394, 2840, 2364, 63, 97, "Input",ExpressionUUID->"12381d4a-89e1-47f6-8d51-412f7f51a597"],
Cell[99761, 2905, 2002, 52, 80, "Input",ExpressionUUID->"daed8503-d6a5-4590-b249-078cf42134c3"],
Cell[101766, 2959, 3509, 93, 134, "Input",ExpressionUUID->"72b34efb-91d3-441f-b747-044ed98afc57"],
Cell[105278, 3054, 1059, 29, 44, "Input",ExpressionUUID->"945498aa-696b-42cf-848d-1117f0c3f718"],
Cell[106340, 3085, 1061, 29, 44, "Input",ExpressionUUID->"82f225ed-7d63-4173-be33-25d1057e5111"],
Cell[107404, 3116, 1906, 50, 80, "Input",ExpressionUUID->"dd63add0-5d27-4b32-a59e-292ad44f422b"],
Cell[109313, 3168, 1929, 51, 80, "Input",ExpressionUUID->"9892d2d4-75bb-4a9d-97e7-57cc797b5f32"],
Cell[111245, 3221, 1665, 45, 63, "Input",ExpressionUUID->"0de652b1-c6d9-429e-98a6-76ebd46e5daa"],
Cell[112913, 3268, 399, 10, 26, "Input",ExpressionUUID->"9719d923-8f8a-4bd4-a2bd-7fe18df965cc"],
Cell[113315, 3280, 302, 6, 26, "Input",ExpressionUUID->"2c0c2b66-4082-45ef-a34d-f26f358f8b83"],
Cell[113620, 3288, 1478, 41, 56, "Input",ExpressionUUID->"b2b5b8ae-9c51-41cf-b396-061ec54d1f86"],
Cell[115101, 3331, 8059, 210, 180, "Input",ExpressionUUID->"7da78e5a-d6c2-40c8-b47c-747136ba7ac9"],
Cell[123163, 3543, 2582, 77, 60, "Input",ExpressionUUID->"aa58fa2e-423a-4ddb-add2-6cd1d2857a9e"],
Cell[125748, 3622, 478, 13, 27, "Input",ExpressionUUID->"6e424ead-97ec-4e14-8880-4a60a132226d"],
Cell[126229, 3637, 390, 9, 26, "Input",ExpressionUUID->"0a2ff80f-ceb9-4eec-924f-e4ab5231f5a2"],
Cell[126622, 3648, 390, 9, 26, "Input",ExpressionUUID->"9a03fa6f-bead-4a27-9372-4c4d13372a4f"],
Cell[127015, 3659, 1288, 38, 26, "Input",ExpressionUUID->"7d08506d-f53b-45ea-a5bc-12741718cb71"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128340, 3702, 227, 4, 48, "Subsection",ExpressionUUID->"ca38edb1-5b68-4cca-a67e-015eca7c93ff"],
Cell[128570, 3708, 1473, 43, 29, "Input",ExpressionUUID->"491a3bb8-623e-4d85-8588-c02c8a706799"],
Cell[130046, 3753, 1233, 36, 25, "Input",ExpressionUUID->"8d64735a-9ef3-4278-9866-234ad9afd77f"],
Cell[131282, 3791, 1236, 36, 25, "Input",ExpressionUUID->"f00ce5fa-144c-449d-8f6a-d502559bf152"],
Cell[132521, 3829, 1818, 55, 112, "Input",ExpressionUUID->"b90b06e3-094b-45a9-a4dd-c440f3e2b2c6"],
Cell[134342, 3886, 1894, 56, 112, "Input",ExpressionUUID->"e6397fad-e084-4f77-80c4-66d374a55b1f"],
Cell[136239, 3944, 950, 27, 26, "Input",ExpressionUUID->"72553a81-3bd1-4dd5-b668-88e69bfd4055"],
Cell[137192, 3973, 877, 25, 26, "Input",ExpressionUUID->"2098c7a4-1249-4f7d-ba69-3df59b883477"],
Cell[138072, 4000, 376, 9, 26, "Input",ExpressionUUID->"a8b0874a-daef-4aca-b4ca-87885cd3e3bb"],
Cell[138451, 4011, 2315, 69, 47, "Input",ExpressionUUID->"b84dc5fd-2111-4487-9a1a-300053ad5b66"],
Cell[140769, 4082, 377, 9, 26, "Input",ExpressionUUID->"300a240c-23ea-407e-92e9-44fc46639d72"],
Cell[141149, 4093, 763, 23, 41, "Input",ExpressionUUID->"3787e209-c88c-44c4-bd32-743a86b9d001"],
Cell[141915, 4118, 283, 7, 25, "Input",ExpressionUUID->"21fc8534-c453-4f65-94aa-cedd9db9be6f"],
Cell[142201, 4127, 2818, 80, 60, "Input",ExpressionUUID->"524cafff-06bc-4429-b1da-614b69ce855b"],
Cell[145022, 4209, 8059, 210, 180, "Input",ExpressionUUID->"1bbf3096-cb05-4596-b8f8-b41101fef78e"],
Cell[153084, 4421, 8010, 209, 180, "Input",ExpressionUUID->"92f5140a-9784-447f-95a3-6a3324981632"],
Cell[161097, 4632, 215, 6, 25, "Input",ExpressionUUID->"f163b7e4-bca9-4adf-8479-619222ee897f"],
Cell[161315, 4640, 2582, 77, 60, "Input",ExpressionUUID->"5ce9dd49-68f9-44ac-bf65-c1bc1ea1d00c"],
Cell[163900, 4719, 2471, 72, 60, "Input",ExpressionUUID->"f44cab94-fbbd-4a54-80ab-9c6c7732ab34"],
Cell[166374, 4793, 818, 24, 26, "Input",ExpressionUUID->"9b149700-903d-490d-9faa-71204cd55f68"],
Cell[167195, 4819, 820, 24, 26, "Input",ExpressionUUID->"86dc57ca-fe28-451f-9790-8295b1829a67"],
Cell[168018, 4845, 622, 17, 26, "Input",ExpressionUUID->"777afebc-b074-4dd4-9be1-8a1f4be3acfa"],
Cell[168643, 4864, 1411, 43, 43, "Input",ExpressionUUID->"99387fd1-a020-4c77-aa4b-8a55118fa5d6"],
Cell[170057, 4909, 1584, 49, 26, "Input",ExpressionUUID->"b325e4ec-ac1a-4917-858e-1240c66f8513"],
Cell[171644, 4960, 5731, 161, 95, "Input",ExpressionUUID->"5ce48526-3a1c-43d2-bc44-6701fa7197a7"],
Cell[177378, 5123, 2887, 87, 60, "Input",ExpressionUUID->"31bdd68d-3a5e-41d4-b76e-43159dde469d"],
Cell[180268, 5212, 3450, 102, 77, "Input",ExpressionUUID->"e94eb2dc-4257-4c8b-890e-52669078fcd2"],
Cell[183721, 5316, 570, 12, 26, "Input",ExpressionUUID->"5e48b7d4-4589-4660-9f0d-c1655dccc846"],
Cell[184294, 5330, 2078, 55, 41, "Input",ExpressionUUID->"5786be29-741f-4877-a1b3-f7b3ebe7b094"],
Cell[186375, 5387, 899, 27, 26, "Input",ExpressionUUID->"67fa893f-85eb-41e4-b6c7-dcda94920057"],
Cell[187277, 5416, 609, 15, 26, "Input",ExpressionUUID->"8983568e-11e1-4412-b69d-912c6cb1ab1c"],
Cell[187889, 5433, 869, 28, 27, "Input",ExpressionUUID->"0a21481f-d278-445f-b9dd-d91ead0af130"],
Cell[188761, 5463, 1512, 44, 29, "Input",ExpressionUUID->"8505d36d-b74a-4260-9c98-7ccf4bb8973d"],
Cell[190276, 5509, 1664, 47, 43, "Input",ExpressionUUID->"5c3335ad-9f3b-443a-99d5-b24689794993"],
Cell[191943, 5558, 1196, 36, 26, "Input",ExpressionUUID->"bea723b1-b09b-4c48-9620-a4cccfb12674"],
Cell[CellGroupData[{
Cell[193164, 5598, 676, 20, 43, "Input",ExpressionUUID->"815a62a0-c851-4a82-9526-2856940dd774"],
Cell[193843, 5620, 695, 20, 70, "Output",ExpressionUUID->"a2b3bd68-dae4-480d-9d4c-b1d34c4df267"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[194611, 5648, 242, 4, 53, "Chapter",ExpressionUUID->"129c6549-3059-4bef-b6f1-7f6bca7335d1"],
Cell[194856, 5654, 147, 3, 31, "Text",ExpressionUUID->"7b5f8d26-7625-4a5c-b756-49bcba018a0e"],
Cell[195006, 5659, 3145, 88, 60, "Input",ExpressionUUID->"23335134-5fcd-42a4-b32a-d61cc1a0660d"],
Cell[198154, 5749, 224, 5, 31, "Text",ExpressionUUID->"29a0e495-8a23-45af-ba6a-7779ded87552"],
Cell[198381, 5756, 919, 30, 43, "Input",ExpressionUUID->"bfcf8bfc-3231-44dd-80ff-a854125e7a3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199337, 5791, 2610, 69, 117, "Chapter",ExpressionUUID->"2df71d87-78f7-40c4-8d36-49e1b4278921"],
Cell[CellGroupData[{
Cell[201972, 5864, 1441, 35, 106, "Section",ExpressionUUID->"6b4fb4f9-50f3-4f0e-a7eb-964058b9f529"],
Cell[CellGroupData[{
Cell[203438, 5903, 5503, 145, 188, "Input",ExpressionUUID->"5d8cbdb0-2c78-4eef-be55-5e6486179ecd"],
Cell[208944, 6050, 1049, 23, 50, "Output",ExpressionUUID->"44dc0e37-2387-4efd-8456-d52b0b608d45"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[210042, 6079, 1051, 26, 96, "Section",ExpressionUUID->"4167a24b-5dfb-4805-a601-a0300a1c5e90"],
Cell[CellGroupData[{
Cell[211118, 6109, 7563, 206, 305, "Input",ExpressionUUID->"fe4cce16-f108-4895-8716-526c86f0578f"],
Cell[218684, 6317, 1411, 27, 49, "Output",ExpressionUUID->"805da088-e4e0-4ad8-9e49-7b305b20bb67"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[220156, 6351, 3063, 81, 120, "Chapter",ExpressionUUID->"e0562894-37fc-4066-b6b8-17d24258a156"],
Cell[CellGroupData[{
Cell[223244, 6436, 1104, 30, 106, "Section",ExpressionUUID->"babcfa38-6e34-45a8-b509-193e58d25582"],
Cell[CellGroupData[{
Cell[224373, 6470, 7209, 197, 205, "Input",ExpressionUUID->"ca605dae-39e1-4977-90a8-cc80dd488e7f"],
Cell[231585, 6669, 776, 20, 49, "Output",ExpressionUUID->"1ea1a307-c005-4f13-aca4-ff4e05332e55"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[232410, 6695, 1914, 53, 105, "Section",ExpressionUUID->"3fcd3f5f-f17d-4399-8fce-b21390fc02bd"],
Cell[CellGroupData[{
Cell[234349, 6752, 180, 3, 48, "Subsection",ExpressionUUID->"7256629e-5c28-4ba1-b573-d05d4186ca92"],
Cell[234532, 6757, 2639, 70, 150, "Input",ExpressionUUID->"3da210fd-66e9-4139-ad10-46fe78a38c0d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237208, 6832, 236, 4, 48, "Subsection",ExpressionUUID->"bc594824-9bda-45b3-9457-4bc64b52bea2"],
Cell[CellGroupData[{
Cell[237469, 6840, 6426, 167, 158, "Input",ExpressionUUID->"5f5a4b72-b8ac-4d52-884d-b0bf6f73c0ad"],
Cell[243898, 7009, 15771, 443, 307, "Output",ExpressionUUID->"2821628b-62d2-416c-be12-f79deef18727"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[259718, 7458, 160, 3, 48, "Subsection",ExpressionUUID->"68cbf67a-2a01-4c12-92d0-ea1c941bf6ba"],
Cell[CellGroupData[{
Cell[259903, 7465, 176, 3, 40, "Subsubsection",ExpressionUUID->"c6dcd8c4-3353-4e2b-8572-b68315cedca3"],
Cell[260082, 7470, 314, 7, 31, "Text",ExpressionUUID->"ab9253f4-40c7-45f7-a7ef-02a4afb3fe2f"],
Cell[CellGroupData[{
Cell[260421, 7481, 4981, 141, 115, "Input",ExpressionUUID->"6fc78e36-871b-441d-a276-0aeaff6d5db8"],
Cell[265405, 7624, 328, 5, 28, "Output",ExpressionUUID->"12183d9a-f25e-457f-b3ca-1bd92ecb413b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265782, 7635, 204, 3, 40, "Subsubsection",ExpressionUUID->"7477c2a1-af8d-43e2-ae1f-280df8cf661d"],
Cell[265989, 7640, 453, 8, 31, "Text",ExpressionUUID->"e3eb7354-59a5-4338-9ef1-a47df3942eca"],
Cell[CellGroupData[{
Cell[266467, 7652, 5689, 151, 167, "Input",ExpressionUUID->"20ea7c92-9e59-45ac-a955-a469b6805ec0"],
Cell[272159, 7805, 980, 20, 47, "Output",ExpressionUUID->"bd5a9392-92be-4864-ba13-02ddbb9944da"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[273200, 7832, 1550, 45, 83, "Subsection",ExpressionUUID->"d492682c-42bd-484e-a571-d5b5741562ca"],
Cell[CellGroupData[{
Cell[274775, 7881, 4793, 136, 116, "Input",ExpressionUUID->"d75430fa-0c71-4373-8e89-882d78943d83"],
Cell[279571, 8019, 1050, 31, 50, "Output",ExpressionUUID->"8e86bf19-0145-466e-b450-ac38ef05105b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280658, 8055, 5408, 152, 133, "Input",ExpressionUUID->"a158b716-5ab9-4dd5-ba45-c7d773ab3f0d"],
Cell[286069, 8209, 2798, 83, 88, "Output",ExpressionUUID->"7234edcf-fc09-4e4f-8575-8005ee2dd4db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[288904, 8297, 2031, 53, 97, "Input",ExpressionUUID->"4f2032de-683b-4a60-8037-0cab03363dd0"],
Cell[290938, 8352, 1080, 31, 52, "Output",ExpressionUUID->"95aaf270-690a-440d-a429-734666a28b5a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

